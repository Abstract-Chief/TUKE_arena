#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f lock_arena/data/pretest.sh 
#endif

static  char data [] = 
#define      chk2_z	19
#define      chk2	((&data[2]))
	"\250\227\133\325\232\216\254\332\366\265\104\141\271\325\210\317"
	"\034\070\345\126\234\200\061\052\365"
#define      xecc_z	15
#define      xecc	((&data[26]))
	"\267\132\226\267\143\321\307\047\303\200\332\331\057\021\167\370"
#define      lsto_z	1
#define      lsto	((&data[41]))
	"\200"
#define      date_z	1
#define      date	((&data[42]))
	"\256"
#define      rlax_z	1
#define      rlax	((&data[43]))
	"\211"
#define      inlo_z	3
#define      inlo	((&data[44]))
	"\272\230\314"
#define      msg1_z	65
#define      msg1	((&data[53]))
	"\341\115\117\332\301\051\225\307\100\363\100\124\240\143\235\364"
	"\236\106\117\362\003\010\307\204\313\351\154\163\245\140\355\243"
	"\214\347\271\201\202\231\037\332\145\277\204\153\222\037\323\004"
	"\223\162\210\020\142\061\034\041\136\104\351\154\017\252\030\160"
	"\143\320\306\146\126\214\055\203\131\252\265\204\237"
#define      pswd_z	256
#define      pswd	((&data[177]))
	"\306\074\304\066\150\001\252\031\327\005\143\040\311\202\177\045"
	"\143\314\165\076\216\237\302\350\111\167\154\351\206\076\233\114"
	"\173\137\203\343\141\055\374\070\063\140\130\374\343\330\041\106"
	"\245\227\205\063\066\353\335\100\157\206\214\243\113\110\350\275"
	"\036\120\026\173\371\065\017\316\073\350\366\321\172\257\320\046"
	"\351\272\345\360\246\302\061\025\111\275\270\224\006\241\122\044"
	"\362\150\237\354\236\256\273\331\227\261\253\021\141\173\067\112"
	"\066\035\073\334\337\154\361\051\052\252\275\060\114\017\125\077"
	"\170\364\053\026\243\346\360\072\227\233\113\371\027\203\103\116"
	"\240\177\052\200\354\034\251\026\306\146\107\023\166\234\122\356"
	"\220\175\005\064\144\365\156\374\221\272\365\251\075\071\367\336"
	"\270\041\136\244\076\007\273\005\156\002\030\344\236\153\323\057"
	"\351\330\143\115\316\322\111\140\215\076\011\312\167\001\250\060"
	"\043\007\324\141\016\217\146\174\222\177\141\061\352\064\141\323"
	"\014\305\040\333\227\152\073\044\250\105\357\040\106\230\120\151"
	"\237\045\313\255\265\061\052\107\261\213\170\233\300\331\157\315"
	"\236\220\250\066\372\343\133\243\051\112\303\157\342\024\331\202"
	"\072\244\060\357\326\132\066\207\346\257\043\246\210\222\164\047"
	"\042\034\135\035\000\271\300\051\003\204\231\346\231\162\150\323"
	"\027\230\303\355\363\107\034\200\277\211\151\106\307\004\223\102"
	"\144\026\046\305\104\043\376\170\204\126\164\147\057\226\255\324"
	"\055\063\007\143\172\044\343\072\255\115\200\164\122\024\267\267"
	"\053\335"
#define      tst1_z	22
#define      tst1	((&data[480]))
	"\173\347\336\200\217\075\114\273\216\362\203\051\176\220\033\257"
	"\361\173\060\135\036\172\013\246"
#define      chk1_z	22
#define      chk1	((&data[506]))
	"\354\001\362\231\223\335\152\110\160\332\175\322\146\221\304\207"
	"\224\207\335\270\041\041\160\021\054\340\325\040"
#define      text_z	4857
#define      text	((&data[1581]))
	"\107\001\150\202\257\265\003\044\010\027\333\277\102\271\075\262"
	"\272\271\232\077\213\366\053\215\351\305\142\012\222\100\216\332"
	"\102\366\134\361\254\140\025\264\167\361\164\272\252\262\154\144"
	"\153\007\244\366\376\320\204\350\225\347\362\050\047\200\002\151"
	"\167\137\133\043\277\160\330\067\141\115\361\014\377\136\161\153"
	"\145\025\142\144\345\346\114\173\315\076\243\364\277\246\136\066"
	"\005\271\132\304\052\063\374\214\200\355\230\200\114\011\353\262"
	"\037\116\026\004\064\142\200\002\241\043\366\141\311\125\227\317"
	"\017\362\224\072\045\220\306\245\176\137\046\312\150\022\174\210"
	"\140\222\214\225\365\015\227\227\061\215\370\373\343\220\312\363"
	"\202\137\055\247\357\364\115\156\123\164\070\274\206\265\104\347"
	"\110\321\174\075\336\023\325\017\241\315\012\205\136\325\170\340"
	"\064\246\210\044\232\326\222\355\113\313\251\322\200\355\271\310"
	"\277\065\006\235\110\333\254\352\251\267\157\007\214\347\350\301"
	"\215\161\345\050\110\167\026\223\102\277\145\302\255\037\213\154"
	"\124\221\012\235\155\267\210\026\156\367\036\373\336\007\274\154"
	"\171\241\224\302\031\252\126\134\152\274\037\030\333\252\205\060"
	"\074\217\316\251\106\126\300\265\115\337\260\054\347\155\231\141"
	"\016\055\043\050\330\171\204\103\065\243\134\021\116\341\101\212"
	"\161\020\064\270\146\364\155\263\324\036\340\273\213\171\034\232"
	"\247\077\302\200\271\107\303\357\352\040\000\071\002\102\303\163"
	"\122\367\053\271\354\231\155\300\270\115\174\103\307\230\336\156"
	"\330\240\356\221\350\262\201\323\322\202\014\324\305\320\110\027"
	"\310\164\321\264\016\076\165\306\214\361\012\123\212\350\301\142"
	"\211\260\364\161\142\165\104\065\370\121\012\275\041\122\325\351"
	"\306\246\236\325\345\024\233\161\005\245\305\220\216\207\362\027"
	"\067\347\211\232\135\315\317\125\036\331\022\100\054\347\051\363"
	"\216\310\310\163\334\143\345\342\011\252\162\227\062\144\257\151"
	"\114\070\004\251\006\324\376\044\256\020\144\332\370\216\316\206"
	"\126\226\371\063\372\337\025\004\211\207\233\274\354\113\046\070"
	"\203\052\341\211\376\340\256\254\360\022\207\350\241\125\157\370"
	"\353\150\053\346\107\101\352\321\310\206\215\265\321\263\356\125"
	"\336\320\336\334\260\214\211\241\237\020\212\101\145\371\071\121"
	"\142\145\067\251\246\042\173\157\251\011\044\172\275\023\317\233"
	"\344\256\167\225\073\000\066\332\020\301\034\166\272\125\307\034"
	"\272\377\306\140\042\102\317\313\113\364\106\010\010\025\243\354"
	"\304\033\201\377\034\270\332\054\171\366\243\064\113\153\120\006"
	"\152\027\147\215\131\066\130\245\053\236\256\064\264\121\040\171"
	"\155\242\170\211\132\122\266\323\110\131\007\223\304\130\232\057"
	"\160\001\275\312\070\026\157\144\264\035\230\151\157\270\342\335"
	"\133\133\146\265\255\035\211\365\166\221\211\073\352\043\153\132"
	"\045\051\044\135\077\224\301\364\262\131\135\042\022\100\377\155"
	"\233\145\043\111\202\255\077\371\076\310\065\051\354\241\203\021"
	"\312\250\157\011\075\060\375\357\212\133\021\234\234\020\012\070"
	"\166\056\201\371\333\301\363\032\212\051\103\166\312\307\210\225"
	"\157\370\237\254\050\235\234\262\370\256\117\225\277\132\315\065"
	"\210\117\057\144\021\043\176\233\114\302\022\027\211\233\254\371"
	"\223\114\245\273\351\102\156\341\360\276\167\257\031\105\345\241"
	"\225\024\006\246\067\205\101\204\107\123\233\320\356\110\311\201"
	"\224\157\075\175\261\254\137\242\152\326\121\204\033\066\046\260"
	"\113\054\126\203\261\227\007\371\353\243\311\331\353\223\133\200"
	"\003\230\375\265\104\134\127\257\063\251\063\116\340\132\377\054"
	"\206\126\257\070\356\267\061\331\132\373\263\106\216\016\306\222"
	"\246\303\107\353\040\237\233\123\110\317\242\051\051\242\125\257"
	"\370\004\350\346\273\031\277\026\024\163\134\243\201\042\066\050"
	"\346\175\023\006\034\256\132\145\176\375\216\247\237\343\127\227"
	"\350\077\175\244\131\075\272\156\261\027\022\062\071\110\132\040"
	"\305\156\047\342\034\202\110\233\177\327\102\036\272\232\265\243"
	"\332\063\107\063\161\001\242\042\030\264\125\122\374\257\163\302"
	"\035\232\245\072\034\355\325\234\304\030\272\177\263\160\042\215"
	"\244\151\301\025\153\143\070\204\030\215\327\024\075\112\327\132"
	"\345\174\224\001\152\152\235\057\203\130\257\066\310\321\303\154"
	"\073\205\202\247\351\273\054\001\110\003\026\205\115\355\340\063"
	"\152\164\064\325\337\322\004\142\053\263\230\363\205\134\140\301"
	"\341\342\151\313\236\225\314\346\230\342\154\346\320\114\031\073"
	"\301\116\020\240\041\025\003\115\311\233\100\314\166\372\056\161"
	"\145\272\130\113\357\344\316\147\270\246\244\101\030\167\372\371"
	"\045\105\014\314\034\372\232\061\042\250\307\143\145\301\021\303"
	"\225\207\340\131\123\070\264\051\164\116\034\254\365\002\341\365"
	"\210\276\373\377\023\142\077\230\355\256\263\243\273\246\101\351"
	"\034\346\224\217\241\076\202\306\202\044\312\331\051\001\332\301"
	"\234\342\265\107\364\312\336\311\066\311\343\141\043\067\016\320"
	"\321\041\106\212\124\221\120\364\311\273\172\214\336\244\273\176"
	"\275\253\342\307\204\106\347\121\012\333\035\216\356\212\334\006"
	"\232\073\036\222\203\371\311\233\303\022\211\177\263\213\017\047"
	"\062\002\205\220\270\336\362\351\315\064\061\001\040\040\206\155"
	"\150\005\165\331\315\332\317\362\263\241\221\177\112\000\001\272"
	"\042\320\061\075\247\242\132\357\037\157\325\326\015\176\170\073"
	"\021\302\365\211\273\174\117\135\026\172\033\304\035\156\361\234"
	"\124\065\016\167\032\277\130\214\362\274\260\245\002\376\314\353"
	"\023\111\064\371\214\136\366\211\065\007\132\363\335\232\337\205"
	"\326\021\373\116\367\143\143\353\045\124\071\225\116\240\033\213"
	"\126\172\071\214\064\057\344\362\323\162\206\303\316\067\277\232"
	"\276\227\371\267\113\165\272\330\256\063\105\227\305\325\056\016"
	"\065\370\014\030\050\073\200\237\112\054\241\240\251\072\122\151"
	"\313\170\114\152\071\054\325\165\261\167\232\226\032\242\176\173"
	"\255\016\065\054\237\342\351\242\035\172\215\326\111\362\044\342"
	"\172\360\260\301\322\222\366\300\070\101\134\377\121\375\064\257"
	"\216\252\333\361\330\142\240\321\045\265\306\026\224\145\022\015"
	"\375\133\334\043\071\243\212\274\234\005\126\264\322\240\324\350"
	"\327\243\150\005\313\131\040\113\125\001\124\112\355\214\311\117"
	"\257\237\331\100\006\350\122\044\202\322\212\252\025\342\233\227"
	"\162\224\175\377\065\272\340\165\122\050\371\220\366\332\143\205"
	"\331\045\177\210\357\011\167\004\122\045\362\211\234\331\215\221"
	"\167\073\215\000\147\060\235\207\101\013\360\052\357\105\223\342"
	"\344\342\352\002\316\326\070\312\107\265\373\123\352\377\223\257"
	"\052\001\162\135\036\151\174\254\020\004\274\375\250\272\362\144"
	"\017\342\041\226\043\122\203\302\340\332\333\247\375\030\141\126"
	"\243\375\354\361\376\136\015\022\357\063\315\346\074\152\274\243"
	"\225\253\274\241\256\340\046\245\273\235\175\314\210\345\065\335"
	"\340\136\134\123\310\056\203\231\223\144\214\226\011\001\260\247"
	"\331\215\344\266\013\212\013\137\326\031\152\207\302\322\370\033"
	"\165\050\116\066\205\043\074\074\351\225\244\375\256\132\307\241"
	"\156\153\034\371\331\366\132\112\103\344\045\144\135\363\130\010"
	"\112\026\316\112\174\100\153\065\006\112\073\236\356\334\061\001"
	"\251\304\321\306\366\155\156\367\254\307\330\024\166\132\323\033"
	"\072\145\240\324\051\140\234\045\004\000\306\033\217\000\046\153"
	"\051\060\301\150\302\000\100\233\370\125\326\240\026\366\126\015"
	"\366\210\026\150\337\020\314\253\346\016\214\347\103\140\041\105"
	"\156\040\010\156\343\277\173\314\321\102\012\337\151\243\066\315"
	"\033\251\037\013\172\337\067\315\247\120\217\023\237\102\356\335"
	"\303\144\135\075\315\102\250\264\131\351\213\156\322\154\147\340"
	"\323\145\050\366\150\056\304\310\273\377\202\107\277\257\223\102"
	"\057\221\175\157\101\337\136\123\054\313\117\317\136\012\127\137"
	"\025\241\150\201\055\323\151\224\024\232\233\302\036\370\164\342"
	"\143\303\004\157\027\315\075\001\005\075\241\272\165\045\256\151"
	"\114\014\063\126\210\140\013\063\321\213\225\257\322\216\065\270"
	"\355\054\221\327\250\077\217\260\234\023\065\234\037\025\007\140"
	"\343\167\220\256\267\100\147\147\111\147\064\017\365\217\223\271"
	"\100\345\136\254\300\370\023\301\107\237\305\073\305\167\244\010"
	"\023\343\354\072\205\225\374\110\053\176\012\022\061\060\177\126"
	"\302\203\372\170\274\365\331\001\231\314\163\107\245\226\163\300"
	"\327\174\000\202\263\056\211\302\066\153\154\352\150\171\267\254"
	"\077\376\124\332\066\066\336\106\356\330\247\221\217\173\345\307"
	"\375\250\331\164\331\102\212\254\154\373\011\264\351\057\316\367"
	"\041\011\115\322\153\377\162\333\302\044\022\267\217\020\212\006"
	"\010\141\244\343\040\302\267\376\356\203\015\331\226\056\226\362"
	"\017\060\236\006\346\325\360\377\304\132\304\000\355\174\067\262"
	"\054\051\067\342\157\105\305\377\073\132\256\155\267\147\204\064"
	"\245\104\322\125\377\024\067\352\365\047\050\206\136\152\061\017"
	"\260\145\057\070\213\037\005\114\115\227\061\153\324\046\046\156"
	"\270\251\055\323\344\071\014\303\057\037\117\136\267\213\005\133"
	"\345\074\035\013\040\340\212\117\044\273\136\103\065\237\130\175"
	"\267\366\343\176\362\072\231\204\237\227\265\050\160\021\131\306"
	"\110\051\245\247\141\245\155\147\245\343\155\320\236\305\145\126"
	"\353\116\305\137\135\336\371\145\034\035\370\064\270\012\271\241"
	"\373\321\021\217\100\325\312\035\363\063\070\303\254\025\320\277"
	"\377\007\150\110\063\161\222\311\373\134\312\144\046\021\223\311"
	"\153\132\313\076\110\304\213\041\267\210\363\167\233\243\322\066"
	"\176\252\141\317\264\275\245\303\274\332\224\064\317\017\376\051"
	"\041\257\137\066\216\121\056\370\363\177\005\224\013\222\072\213"
	"\365\201\236\253\060\316\246\251\063\376\157\144\062\072\135\225"
	"\231\000\360\155\304\222\056\025\256\316\222\361\150\316\302\123"
	"\051\075\173\121\334\025\104\355\172\042\005\326\244\227\222\361"
	"\251\040\351\233\225\132\100\374\060\203\023\261\117\160\212\245"
	"\320\101\000\107\274\175\074\234\347\016\057\362\225\375\111\005"
	"\150\040\230\151\204\374\366\033\113\003\353\322\003\353\230\327"
	"\125\163\173\226\034\212\147\335\346\364\064\354\126\071\240\037"
	"\103\322\225\075\146\032\354\004\073\373\330\357\370\314\344\073"
	"\233\034\160\152\254\062\170\250\041\072\340\371\171\156\243\302"
	"\033\170\300\002\021\132\370\114\333\255\264\027\022\352\064\211"
	"\055\300\266\320\204\102\272\325\134\011\374\153\163\050\316\033"
	"\315\011\027\250\306\324\313\012\330\021\122\201\101\014\305\371"
	"\073\154\302\171\244\226\156\371\357\174\166\050\051\001\030\047"
	"\065\337\247\363\127\035\321\234\274\212\275\121\152\124\341\020"
	"\057\066\300\367\107\110\265\346\211\223\123\143\011\261\065\331"
	"\060\017\375\371\223\364\347\346\024\137\226\023\236\177\276\126"
	"\072\021\373\210\062\247\244\173\310\370\044\050\160\127\102\023"
	"\124\142\313\260\316\341\026\050\123\271\204\302\017\272\104\132"
	"\060\241\121\312\133\140\374\060\313\362\071\052\057\102\116\363"
	"\357\151\357\346\051\204\055\374\145\075\275\062\173\324\340\123"
	"\326\217\160\253\314\132\126\256\372\111\301\267\273\315\327\015"
	"\272\211\177\250\212\101\370\202\267\147\307\350\313\346\021\336"
	"\133\176\312\037\154\052\071\251\161\073\250\357\320\022\325\270"
	"\153\367\064\301\147\014\072\004\031\132\265\327\306\232\044\012"
	"\257\037\167\076\224\062\324\302\031\266\160\131\063\167\147\154"
	"\216\213\354\321\114\067\207\005\134\143\011\135\144\203\040\226"
	"\250\336\171\162\153\107\145\034\244\134\017\135\056\011\042\002"
	"\022\053\021\353\365\301\065\250\020\312\013\202\016\015\340\217"
	"\160\212\045\115\153\167\223\347\331\351\137\105\301\104\252\354"
	"\220\115\064\212\134\207\121\046\042\030\232\124\067\155\020\130"
	"\204\350\217\223\161\311\245\161\304\252\200\271\173\275\247\337"
	"\017\077\041\166\331\151\356\255\077\003\052\272\324\137\103\165"
	"\024\352\201\265\270\156\020\353\330\075\072\202\116\321\267\011"
	"\057\356\272\377\114\115\025\253\214\224\345\007\313\013\122\321"
	"\110\130\120\125\300\142\036\165\111\112\304\331\133\174\012\362"
	"\321\035\203\011\352\271\322\126\272\353\040\320\354\271\246\174"
	"\105\034\246\205\160\225\223\026\264\010\205\353\136\176\130\234"
	"\370\171\264\155\073\320\113\122\060\042\320\363\320\133\276\361"
	"\145\032\217\333\053\145\177\301\147\136\200\035\164\247\067\056"
	"\231\312\352\340\114\105\224\312\350\264\176\176\355\157\213\014"
	"\021\333\240\202\331\175\121\231\140\237\262\213\025\304\207\067"
	"\045\145\011\007\254\347\107\375\114\272\104\374\060\347\154\076"
	"\065\140\247\024\170\375\105\315\021\104\037\215\171\366\235\170"
	"\143\167\137\375\373\101\004\310\056\126\247\154\203\163\022\335"
	"\315\336\253\360\302\135\300\214\074\262\162\255\215\347\333\062"
	"\023\146\053\203\273\304\271\230\274\213\223\177\177\332\105\321"
	"\066\154\375\062\370\010\162\245\147\350\143\105\024\000\113\131"
	"\060\236\000\042\003\040\207\147\127\050\052\271\200\310\315\326"
	"\363\076\137\253\234\247\056\357\077\172\140\122\307\355\125\346"
	"\146\246\125\003\327\162\313\022\254\027\166\267\104\303\254\120"
	"\151\202\255\317\051\030\022\243\156\130\062\050\067\227\110\202"
	"\026\177\241\145\040\232\275\336\062\233\256\053\137\260\031\257"
	"\047\116\201\341\325\317\347\035\237\102\103\053\127\126\370\075"
	"\366\033\213\107\327\172\234\032\224\372\163\336\377\014\150\254"
	"\064\075\124\020\324\240\113\157\342\120\360\242\206\324\106\333"
	"\127\040\005\116\353\041\172\051\100\267\237\302\273\212\050\357"
	"\012\036\243\107\064\245\016\337\230\255\333\210\311\067\115\067"
	"\147\052\272\227\224\245\021\372\126\135\052\340\207\213\353\146"
	"\301\271\355\360\121\277\131\220\307\236\000\221\254\362\356\234"
	"\246\073\203\251\224\070\215\066\270\321\172\154\214\206\036\340"
	"\241\323\202\077\046\053\113\113\120\245\075\174\344\003\244\202"
	"\342\154\354\260\041\325\101\327\016\325\233\365\123\321\357\061"
	"\007\127\176\022\267\174\001\031\103\250\351\365\347\167\176\002"
	"\136\171\231\210\241\170\030\254\167\236\235\120\324\027\264\315"
	"\107\315\201\073\301\210\072\363\326\361\134\074\137\250\260\273"
	"\307\261\031\265\243\131\026\030\070\273\066\360\056\062\317\072"
	"\367\252\170\173\124\164\060\021\102\173\210\014\125\263\041\050"
	"\377\273\327\104\253\312\201\263\242\067\343\316\236\243\206\350"
	"\267\215\241\313\311\310\103\315\005\021\342\213\213\377\146\363"
	"\312\006\176\326\202\124\013\217\236\376\371\354\277\254\360\124"
	"\322\272\037\205\374\300\162\146\341\334\313\133\363\031\303\114"
	"\127\261\042\234\172\055\040\153\331\375\267\041\375\245\115\307"
	"\340\245\003\111\234\313\002\164\265\332\247\060\134\164\265\107"
	"\055\115\237\340\217\302\230\047\013\232\206\255\333\310\044\111"
	"\161\040\063\120\331\225\163\155\125\355\150\031\243\175\122\332"
	"\254\034\344\135\044\112\162\136\224\063\163\025\232\331\071\322"
	"\112\153\260\175\243\362\164\106\122\057\101\073\143\175\163\020"
	"\212\255\163\163\014\275\002\255\013\070\351\146\173\146\070\202"
	"\230\045\171\313\171\035\327\313\065\371\203\160\021\176\314\007"
	"\074\174\015\152\213\017\076\257\050\005\210\115\156\336\056\371"
	"\003\346\215\347\355\273\001\274\032\310\355\110\272\227\061\144"
	"\173\045\304\121\230\370\324\125\352\300\003\042\320\361\150\253"
	"\042\302\205\356\107\041\315\224\124\176\246\260\250\122\365\060"
	"\257\170\056\327\024\072\311\377\227\144\334\352\277\113\275\261"
	"\375\366\232\074\223\243\213\041\007\104\263\353\222\353\035\321"
	"\257\023\352\073\047\247\357\232\325\003\151\234\201\222\076\100"
	"\055\306\107\121\062\175\364\162\273\016\276\112\163\200\060\215"
	"\276\264\302\366\134\166\253\227\070\334\166\343\020\300\267\221"
	"\073\070\315\273\141\367\367\205\252\222\036\365\067\156\312\244"
	"\142\055\205\206\266\262\250\052\074\223\276\135\033\220\275\323"
	"\302\247\320\065\224\211\230\076\255\070\301\342\205\001\050\145"
	"\365\273\077\111\077\025\300\050\232\007\336\000\123\030\100\176"
	"\055\131\151\100\312\270\001\307\351\235\364\356\000\176\373\325"
	"\341\173\320\252\253\122\140\360\211\312\154\013\375\026\166\026"
	"\316\300\255\246\226\305\231\123\367\354\343\045\226\250\301\015"
	"\222\232\013\366\171\131\030\153\203\114\126\007\001\007\205\351"
	"\140\360\314\325\104\375\053\323\123\173\230\340\322\174\272\216"
	"\016\017\315\325\366\015\341\172\043\264\054\170\332\314\272\066"
	"\326\354\261\036\017\306\134\127\037\017\251\101\300\333\016\023"
	"\314\273\204\033\070\113\166\114\223\365\113\046\332\326\102\270"
	"\350\311\220\201\275\040\261\035\152\001\061\114\364\155\125\215"
	"\101\277\061\353\053\325\136\370\314\136\064\364\303\135\370\031"
	"\034\366\341\106\304\356\232\124\016\213\005\175\026\216\276\034"
	"\300\121\367\031\351\373\150\227\001\254\226\024\106\003\365\375"
	"\002\174\315\214\111\066\300\042\102\134\246\000\127\147\270\351"
	"\026\106\134\003\062\254\363\014\200\162\303\367\314\057\214\255"
	"\351\257\002\207\131\216\133\143\067\070\173\257\320\006\222\344"
	"\111\257\067\276\375\104\272\024\304\007\241\101\157\077\277\033"
	"\170\176\203\123\163\064\227\135\177\116\231\246\247\134\324\004"
	"\376\352\201\016\061\177\175\260\127\056\003\325\244\243\062\211"
	"\321\326\114\345\150\000\271\015\006\220\205\322\214\366\043\232"
	"\035\074\126\120\331\122\120\013\215\320\112\106\154\340\060\160"
	"\304\065\027\347\317\063\244\047\052\373\230\241\030\077\346\326"
	"\111\341\200\266\100\114\314\265\026\272\132\121\116\340\166\366"
	"\075\026\353\307\051\367\337\333\163\262\061\273\153\021\035\112"
	"\003\110\352\253\144\062\231\321\026\256\277\000\377\116\324\234"
	"\067\064\264\046\241\215\157\260\023\165\020\317\036\114\004\307"
	"\342\150\353\274\267\140\022\051\274\101\027\012\132\076\137\171"
	"\340\340\270\220\172\203\375\221\304\125\066\210\364\164\172\233"
	"\240\053\162\050\261\246\270\051\201\037\151\114\357\167\143\165"
	"\303\366\200\102\071\231\001\117\206\310\320\261\160\263\365\364"
	"\032\255\277\302\225\351\317\057\351\304\025\045\347\111\345\225"
	"\055\275\073\031\004\225\326\140\070\345\260\265\030\343\254\335"
	"\245\152\153\373\154\011\256\321\367\045\160\145\227\214\021\143"
	"\061\270\143\036\304\171\076\307\103\201\061\202\224\056\047\311"
	"\262\017\300\171\047\126\333\341\363\201\101\005\244\042\305\040"
	"\203\151\217\042\242\072\120\307\210\133\171\130\210\123\356\055"
	"\030\167\313\150\271\347\271\067\165\134\350\041\136\024\130\030"
	"\147\334\002\043\137\137\154\374\322\106\036\203\355\345\157\253"
	"\014\362\146\067\205\066\255\146\124\364\320\061\350\330\274\372"
	"\357\164\271\103\242\303\333\334\014\146\016\200\162\363\323\117"
	"\061\352\161\057\002\165\077\326\064\047\245\213\064\264\055\151"
	"\155\056\245\051\025\237\032\356\071\315\130\316\135\162\123\122"
	"\027\337\335\160\173\155\027\324\075\057\027\015\101\021\114\362"
	"\037\206\275\341\237\345\127\142\021\310\353\276\335\152\156\330"
	"\010\053\120\126\353\306\053\354\127\173\157\260\306\067\314\151"
	"\273\042\236\326\352\203\171\014\227\212\236\160\110\335\227\142"
	"\315\116\264\163\372\304\006\326\150\154\034\164\142\311\132\135"
	"\213\067\266\247\046\075\233\064\244\345\236\357\147\020\056\114"
	"\313\247\025\176\243\114\257\262\227\157\316\227\027\010\027\175"
	"\222\323\151\351\017\145\366\253\063\015\201\072\365\161\345\343"
	"\145\061\172\234\370\337\144\174\263\222\027\222\030\372\140\334"
	"\172\166\312\246\273\026\007\136\141\274\236\251\020\067\014\125"
	"\236\151\067\104\253\221\047\027\321\244\234\116\103\247\205\210"
	"\107\370\064\150\341\256\227\147\347\170\233\315\125\146\247\254"
	"\130\144\353\360\356\306\344\276\023\165\011\154\157\155\144\005"
	"\267\353\166\275\055\362\224\047\254\256\211\331\041\145\343\334"
	"\104\030\076\171\116\241\077\135\360\256\173\224\165\304\002\072"
	"\010\251\273\213\142\255\277\110\135\146\074\045\356\177\115\052"
	"\140\216\110\376\245\321\125\372\354\327\174\233\322\143\233\032"
	"\133\271\214\220\270\254\326\371\375\246\114\226\235\116\122\012"
	"\344\000\335\203\343\350\314\325\264\232\107\034\277\051\264\111"
	"\321\135\016\367\340\132\162\377\330\221\171\372\275\053\156\131"
	"\277\101\326\014\060\242\257\361\165\336\203\240\126\134\246\200"
	"\041\207\273\310\034\204\125\134\324\027\375\134\277\152\121\215"
	"\112\161\063\315\300\242\235\146\004\001\200\374\256\277\261\237"
	"\167\305\343\372\173\362\015\060\274\236\240\017\343\102\010\307"
	"\122\142\176\353\200\057\210\323\103\100\263\155\224\344\367\373"
	"\004\103\040\202\041\311\335\244\232\040\241\354\253\022\144\370"
	"\136\032\101\327\266\363\242\064\075\016\274\204\367\360\330\033"
	"\120\062\336\163\307\262\325\155\371\002\071\173\170\225\001\017"
	"\270\201\277\350\117\061\323\265\314\165\005\213\004\256\265\003"
	"\135\367\021\070\237\015\014\176\160\106\043\243\260\005\317\236"
	"\232\372\245\311\117\203\171\245\235\035\134\314\277\220\062\055"
	"\256\174\261\142\130\371\135\000\153\175\241\273\323\323\326\041"
	"\003\210\312\056\216\311\012\347\365\276\061\310\232\366\257\241"
	"\334\351\314\204\007\237\366\063\362\247\057\053\052\127\343\275"
	"\350\346\207\144\250\101\071\237\323\154\144\016\260\116\156\274"
	"\373\343\255\366\142\272\357\271\114\033\223\013\200\321\214\136"
	"\170\246\325\145\104\330\333\164\327\152\046\276\002\113\027\255"
	"\156\134\262\345\325\300\172\011\233\004\011\361\232\317\200\345"
	"\216\311\140\373\013\172\030\350\302\355\147\235\040\105\057\317"
	"\332\235\105\310\364\234\312\326\326\210\375\267\103\254\345\033"
	"\233\346\012\261\247\224\125\043\051\333\040\345\225\012\071\220"
	"\004\354\152\127\224\135\025\204\327\122\166\141\311\014\332\321"
	"\026\171\047\315\071\177\364\265\261\256\047\141\224\044\304\062"
	"\014\232\231\011\314\240\261\342\111\107\052\316\307\347\003\035"
	"\147\353\024\321\217\117\310\073\033\277\117\246\117\311\020\017"
	"\260\105\327\260\205\371\301\266\343\346\036\133\022\375\265\036"
	"\370\264\141\041\053\133\220\157\336\076\347\224\260\362\341\357"
	"\222\270\361\277\374\010\033\325\213\374\253\124\066\171\155\014"
	"\035\071\116\051\303\037\377\165\066\035\053\166\232\063\072\155"
	"\155\173\125\023\301\063\111\003\116\322\051\214\113\022\051\133"
	"\021\376\300\064\315\076\114\011\374\144\170\045\211\001\171\342"
	"\063\160\035\265\016\142\241\352\360\036\222\316\322\145\222\344"
	"\032\241\164\330\272\225\147\111\156\374\273\247\322\113\127\026"
	"\024\130\057\035\374\327\073\130\110\172\125\310\106\060\135\345"
	"\120\262\035\250\110\135\263\245\357\244\320\373\067\340\134\261"
	"\357\277\104\007\276\313\250\346\177\154\277\156\033\032\147\034"
	"\307\127\273\321\344\300\207\202\261\131\220\012\020\355\015\365"
	"\007\175\216\253\041\174\156\120\271\000\300\266\225\300\011\142"
	"\044\040\206\047\313\266\167\017\203\366\047\006\026\241\114\255"
	"\333\153\060\135\327\265\245\307\255\203\261\254\045\246\365\032"
	"\321\277\131\253\115\036\176\005\275\250\111\024\135\113\221\373"
	"\306\366\111\136\053\021\341\314\162\034\173\215\067\012\041\031"
	"\016\272\154\264\353\203\201\245\147\042\262\150\345\057\145\115"
	"\046\062\365\302\036\371\247\025\347\211\147\276\156\331\034\016"
	"\207\211\256\140\133\343\104\104\042\305\261\220\043\137\274\111"
	"\133\014\073\017\136\322\266\170\152\131\131\142\242\004\201\003"
	"\103\311\023\035\177\374\176\257\075\145\004\015\033\041\203\312"
	"\344\316\242\240\132\160\001\051\173\377\025\365\062\251\152\317"
	"\060\061\372\233\145\032\020\111\262\107\022\112\116\075\166\124"
	"\167\112\345\073\240\037\053\072\167\103\304\040\161\310\260\357"
	"\154\230\314\163\032\366\345\342\165\165\224\341\115\037\017\120"
	"\252\075\362\372\042\246\010\307\371\207\016\166\077\106\121\104"
	"\015\234\236\240\317\343\054\044\201\247\072\136\126\174\321\371"
	"\270\334\242\116\254\001\240\002\046\300\231\365\272\210\071\015"
	"\116\002\253\200\141\151\040\053\212\240\346\242\201\002\172\340"
	"\126\271\030\130\150\076\044\240\040\050\220\146\101\243\064\330"
	"\215\202\355\122\134\122\077\306\370\043\156\373\353\177\256\061"
	"\127\055\135\106\361\050\333\241\163\010\342\161\142\307\367\066"
	"\055\306\142\005\072\271\303\060\312\367\041\273\313\041\204\021"
	"\154\314\030\172\053\316\105\055\254\057\361\003\043\354\076\304"
	"\155\056\363\211\224\265\117\060\164\314\076\342\000\333\240\025"
	"\066\352\202\253\341\152\061\366\077\177\146\012\022\321\144\007"
	"\347\002\102\162\231\133\063\010\200\033\231\071\123\220\156\023"
	"\123\177\336\231\140\221\361\045\157\025\173\104\032\307\373\274"
	"\307\342\006\214\160\024\273\037\106\074\033\314\071\321\312\131"
	"\202\260\033\320\075\246\317\031\067\061\132\222\035\370\006\226"
	"\221\331\275\156\160\342\132\015\273\017\004\320\041\216\010\316"
	"\160\326\355\130\075\227\301\315\362\217\021\066\253\366\235\047"
	"\243\032\127\335\157\100\325\145\173\254\146\063\002\315\143\263"
	"\323\122\042\021\263\343\241\235\351\277\274\244\325\206\045\302"
	"\350\132\136\103\077\306\111\344\167\310\113\065\267\154\311\241"
	"\010\201\215\314\155\347\022\100\263\054\272\106\044\254\256\367"
	"\216\260\147\064\350\115\016\077\103\036\335\123\066\067\332\256"
	"\042\147\366\272\311\365\025\106\223\361\375\211\152\151\124\020"
	"\236\176\250\020\025\147\236\363\017\025\303\224\120\304\222\124"
	"\043\325\040\256\117\370\241\020\332\204\172\245\042\017\162\011"
	"\250\124\165\217\045\301\251\140\202\370\160\043\032\205\046\147"
	"\117\302\250\236\273\111\257\225\315\051\073\360\070\255\371\341"
	"\002\156\161\047\060\032\207\262\023\370\326\055\176\374\224\315"
	"\277\074\153\172\206\032\020\123\103\113\104\174\371\075\136\373"
	"\253\317\042\333\352\252\216\375\242\144\052\040\141\277\355\041"
	"\373\131\234\202\163\254\325\267\370\032\064\361\127\222\355\002"
	"\142\020\336\114\272\154\111\135\321\164\175\063\063\153\125\057"
	"\305\361\261\071\235\207\360\226\241\045\210\370\270\165\373\032"
	"\206\331\146\100\106\260\235\030\044\033\114\127\207\241\206\114"
	"\222\067\205\060\276\166\306\140\234\117\130\124\305\123\156\113"
	"\055\325\213\163\205\051\214\252\105\330\001\315\171\210\031\013"
	"\300\237\073\177\026\002\337\262\122\067\006\027\213\165\142\270"
	"\113\356\054\321\030\270\173\135\220\175\052\011\005\104\025\306"
	"\344\121\105\372\123\045\254\245\135\263\274\350\051\037\241\164"
	"\015\315\105\045\205\301\203\026\076\256\037\104\362\065\012\326"
	"\206\120\321\331\165\175\177\322\061\074\273\133\133\134\317\151"
	"\052\025\217\260\326\022\306\025\300\346\131\263\033\144\212\241"
	"\264\133\173\051\331\373\374\013\070\267\146\224\024\065\375\076"
	"\113\215\356\042\237\265\067\140\233\221\024\267\365\236\131\251"
	"\371\325\323\323\320\317\336\010\207\104\234\233\172\232\332\306"
	"\047\310\350\307\176\037\050\032\261\074\321\246\332\053\120\324"
	"\000\043\250\320\363\206\331\173\313\166\027\105\021\361\013\070"
	"\272\363\000\070\023\050\122\304\144\044\153\077\117\273\023\117"
	"\337\274\040\323\102\371\116\015\160\145\123\201\127\136\271\021"
	"\122\272\111\146\342\234\053\106\300\226\206\020\122\231\137\061"
	"\125\200\005\230\171\124\246\351\271\371\153\021\127\044\042\252"
	"\336\153\020\301\010\074\007\310\322\215\331\045\047\071\127\175"
	"\271\134\026\063\260\274\035\152\265\210\173\015\255\235\267\213"
	"\011\310\115\021\004\124\332\327\342\263\374\012\354\123\210\246"
	"\260\236\331\140\132\366\313\020\177\107\035\054\345\325\270\356"
	"\235\005\000\242\132\333\172\074\217\166\107\174\312\317\042\172"
	"\156\374\333\311\363\247\331\162\356\366\236\323\314\127\302\152"
	"\134\303\014\266\236\206\363\055\375\072\251\310\012\314\103\170"
	"\310\036\101\274\306\032\056\264\021\315\210\336\044\113\110\200"
	"\016\124\067\254\333\053\332\331\145\204\241\160\120\344\350\031"
	"\003\052\325\311\105\004\176\127\321\007\065\366\122\175\167\140"
	"\322\256\014\256\331\347\207\077\153\051\257\274\015\230\326\020"
	"\303\253\332\011\260\131\140\201\140\226\167\262\023\357\022\346"
	"\235\037\224\167\006\034\266"
#define      msg2_z	19
#define      msg2	((&data[7066]))
	"\056\053\043\025\326\374\056\215\331\012\266\265\304\327\054\026"
	"\327\232\230\302\122\377"
#define      shll_z	10
#define      shll	((&data[7088]))
	"\260\311\122\102\246\167\103\313\333\347\024\076\314"
#define      opts_z	1
#define      opts	((&data[7100]))
	"\357"
#define      tst2_z	19
#define      tst2	((&data[7105]))
	"\132\252\326\111\146\053\061\163\347\330\036\314\117\151\116\030"
	"\326\122\327\372\275\172\064\275\274\347"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
