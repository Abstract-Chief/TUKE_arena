#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f lock_arena/data/pretest.sh 
#endif

static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\122"
#define      msg1_z	65
#define      msg1	((&data[2]))
	"\343\171\327\133\216\312\213\131\202\306\175\317\320\045\110\044"
	"\366\050\310\121\165\034\321\100\141\152\111\120\225\177\046\253"
	"\076\021\237\316\165\155\277\105\365\137\256\030\207\216\047\135"
	"\107\204\253\144\124\105\312\137\225\146\061\042\211\154\277\204"
	"\216\247\007\356\206"
#define      pswd_z	256
#define      pswd	((&data[120]))
	"\177\054\322\050\206\147\213\035\131\114\127\053\203\226\240\215"
	"\361\174\102\110\251\133\134\330\076\143\306\304\143\214\354\343"
	"\270\277\014\077\046\227\134\177\344\263\252\150\112\113\365\074"
	"\307\067\126\071\352\043\047\246\245\313\115\143\111\021\367\374"
	"\255\172\027\345\110\003\362\043\034\024\205\003\005\216\275\247"
	"\333\023\340\305\067\007\154\335\322\271\100\034\313\067\030\170"
	"\262\060\135\373\064\120\036\120\145\243\124\153\061\021\022\014"
	"\045\362\322\135\372\076\072\315\367\172\351\302\262\002\072\145"
	"\063\230\140\150\351\177\271\116\042\015\271\124\037\314\141\105"
	"\277\063\242\271\161\335\206\151\127\160\053\012\162\145\160\246"
	"\376\321\016\347\120\307\066\163\325\357\310\364\274\052\072\173"
	"\135\335\064\317\272\273\071\022\053\144\034\235\312\215\103\310"
	"\136\122\260\257\031\346\043\356\326\353\343\222\025\036\016\163"
	"\373\102\103\265\375\174\307\050\341\344\306\253\161\012\164\320"
	"\134\044\200\166\012\243\144\341\217\110\163\244\146\201\030\141"
	"\304\133\027\302\330\336\353\271\303\261\145\064\274\331\005\030"
	"\376\206\216\010\052\363\352\271\074\135\136\243\337\166\005\243"
	"\322\034\146\252\372\121\144\275\002\311\362\276\243\370\327\241"
	"\177\146\252\251\132\224\142\226\362\300\072\321\067\077\165\011"
	"\133\333\204\160\223\340\110\321\104\017\225\250"
#define      msg2_z	19
#define      msg2	((&data[388]))
	"\124\101\004\201\057\330\355\167\331\133\307\017\347\334\272\276"
	"\166\216\042\241\121\227\224"
#define      lsto_z	1
#define      lsto	((&data[409]))
	"\365"
#define      tst2_z	19
#define      tst2	((&data[410]))
	"\302\335\142\004\034\043\154\334\245\220\170\354\360\022\072\105"
	"\101\223\040\221\174\356"
#define      text_z	4857
#define      text	((&data[973]))
	"\244\251\257\024\075\220\135\016\324\155\244\175\011\046\010\136"
	"\150\240\362\320\317\343\267\343\207\111\140\166\046\322\241\312"
	"\174\121\337\271\341\075\307\266\253\154\063\265\223\074\023\373"
	"\334\006\313\254\351\203\220\161\314\360\350\363\303\211\276\077"
	"\332\236\370\274\334\300\162\207\054\245\074\277\341\120\273\276"
	"\126\207\152\100\012\372\262\327\353\232\313\256\044\211\355\376"
	"\047\346\273\003\247\055\213\324\323\307\223\264\030\117\162\157"
	"\326\335\260\341\327\142\271\303\374\204\161\040\015\137\037\065"
	"\106\332\071\355\010\304\301\333\214\125\217\244\244\002\023\173"
	"\337\303\134\267\046\025\173\042\232\355\103\247\114\143\335\223"
	"\076\026\201\106\332\102\041\146\230\261\013\075\264\037\271\223"
	"\342\025\113\011\053\306\053\305\263\157\155\000\322\112\224\021"
	"\141\025\127\074\130\171\242\360\052\256\056\336\315\347\162\260"
	"\375\276\271\051\205\345\357\071\124\135\072\047\250\316\071\011"
	"\343\220\105\074\011\350\055\064\226\133\023\144\103\206\024\100"
	"\104\316\152\312\263\131\003\010\266\076\060\137\014\151\150\360"
	"\372\255\054\004\226\131\070\055\265\114\221\370\322\246\071\027"
	"\164\244\341\050\375\345\061\264\043\141\023\060\313\174\040\305"
	"\052\115\312\300\247\002\355\135\117\176\125\041\044\217\071\231"
	"\063\033\301\061\000\362\346\044\124\372\124\037\166\164\345\240"
	"\302\257\140\151\262\116\306\001\314\034\043\361\254\135\213\340"
	"\170\115\022\170\077\370\234\224\362\360\264\151\145\231\012\050"
	"\111\153\221\374\271\130\376\206\164\042\170\041\177\003\001\367"
	"\120\023\160\220\014\014\044\377\375\330\150\143\162\162\213\274"
	"\335\035\270\226\165\266\035\352\330\225\014\130\230\015\117\350"
	"\041\277\171\055\314\235\054\312\166\225\056\351\007\271\245\345"
	"\327\135\174\115\024\231\067\355\056\103\105\307\121\225\260\162"
	"\124\051\240\041\306\315\353\075\142\031\046\152\323\313\117\252"
	"\051\314\367\076\145\057\054\224\163\161\134\305\007\014\070\134"
	"\065\330\175\374\246\150\072\010\202\140\163\126\054\303\001\125"
	"\217\371\224\365\050\300\212\234\062\346\141\071\363\231\225\051"
	"\162\022\046\031\173\140\042\376\300\225\124\355\130\125\102\350"
	"\116\326\336\167\227\150\023\311\117\165\002\103\017\227\154\202"
	"\252\222\233\045\362\275\044\263\122\170\240\253\316\202\072\145"
	"\207\126\254\354\102\271\052\127\366\130\374\371\173\023\271\057"
	"\162\113\266\250\246\330\047\134\073\203\257\253\057\326\026\362"
	"\224\126\036\246\271\130\126\130\306\107\077\341\224\211\074\300"
	"\004\261\222\020\343\335\107\311\132\327\253\135\272\266\270\100"
	"\320\066\142\143\131\147\225\072\216\003\023\360\374\354\056\133"
	"\242\222\147\070\254\165\000\276\104\062\076\316\010\026\326\330"
	"\362\015\175\047\000\230\220\014\353\060\353\377\213\102\142\007"
	"\375\357\266\071\170\203\353\212\332\357\155\263\376\047\210\156"
	"\346\201\355\100\250\306\124\147\115\341\216\124\100\022\062\224"
	"\136\065\104\374\330\120\373\027\164\172\317\306\326\141\042\271"
	"\013\165\225\067\037\067\112\306\005\206\347\053\372\117\104\207"
	"\057\342\176\121\162\006\257\210\330\350\173\114\073\056\207\036"
	"\123\373\052\241\367\242\255\216\225\372\327\207\002\224\203\325"
	"\347\141\010\240\023\202\223\343\036\102\370\175\331\224\225\120"
	"\017\230\161\344\062\023\301\126\272\245\312\306\340\164\330\244"
	"\215\335\231\047\163\207\302\255\333\107\165\175\104\046\355\220"
	"\064\113\115\247\250\020\206\227\100\024\311\372\050\056\351\335"
	"\127\353\042\124\314\167\274\170\054\115\313\103\202\160\370\213"
	"\220\256\317\006\147\050\124\077\176\360\375\131\346\325\267\245"
	"\226\173\265\165\355\206\276\351\273\073\231\372\200\113\146\243"
	"\203\225\017\224\243\072\316\126\351\221\103\135\176\126\277\244"
	"\154\144\374\277\353\011\151\041\022\220\223\156\230\003\336\277"
	"\035\262\323\364\072\137\114\353\210\203\066\305\330\246\254\377"
	"\041\227\332\076\052\036\175\164\171\337\074\255\011\074\255\306"
	"\044\103\300\352\316\125\007\122\245\330\055\273\303\262\245\122"
	"\164\270\101\370\024\366\224\217\123\071\035\207\254\327\373\342"
	"\372\045\005\305\160\010\321\036\024\253\215\256\203\022\106\305"
	"\365\245\363\225\176\124\316\260\257\337\250\072\010\061\374\323"
	"\163\223\155\154\260\253\346\337\032\147\032\325\077\173\354\211"
	"\321\376\135\110\103\251\320\204\015\311\066\317\110\176\113\050"
	"\275\207\042\063\247\071\070\163\113\132\155\251\211\303\237\153"
	"\061\153\057\005\157\300\076\230\031\267\122\277\222\173\110\240"
	"\204\050\125\234\365\253\354\330\270\020\063\151\257\153\065\260"
	"\352\212\371\123\304\054\147\263\054\200\302\264\143\274\166\026"
	"\064\033\205\372\050\275\013\012\351\243\101\155\153\265\164\100"
	"\145\147\270\036\314\357\313\211\244\102\313\315\044\250\366\127"
	"\122\100\133\227\300\010\331\101\265\043\344\123\177\063\163\264"
	"\116\234\354\102\210\332\064\303\250\271\322\336\373\256\140\236"
	"\250\245\265\177\345\213\071\073\177\136\373\031\136\113\115\353"
	"\057\332\372\210\211\206\332\225\360\350\155\027\235\356\254\240"
	"\233\156\140\345\147\171\204\147\153\206\066\146\110\164\012\236"
	"\305\243\072\126\040\262\136\236\262\366\055\164\231\005\053\122"
	"\111\350\361\335\247\110\022\250\305\224\367\000\273\072\227\302"
	"\210\302\163\311\011\367\173\210\110\140\330\260\372\070\130\242"
	"\224\131\207\355\311\350\115\367\377\070\307\065\035\305\167\006"
	"\201\200\052\005\361\064\110\353\221\350\032\057\321\115\007\377"
	"\124\265\033\201\261\122\124\363\057\116\131\137\072\133\274\372"
	"\070\200\323\131\043\234\137\344\374\120\261\023\131\051\374\307"
	"\026\373\136\175\167\344\344\045\047\050\270\325\207\137\147\054"
	"\232\274\246\177\157\141\020\253\147\307\117\261\225\156\025\362"
	"\205\252\231\276\007\365\203\341\154\317\137\047\360\063\173\170"
	"\170\363\115\045\047\372\306\060\147\050\300\044\200\004\352\352"
	"\356\005\040\210\271\144\261\215\065\367\024\234\061\127\157\371"
	"\040\113\337\273\012\205\366\366\122\213\231\322\236\213\341\042"
	"\276\341\252\071\001\336\157\346\241\052\025\347\323\116\366\316"
	"\032\222\002\331\031\276\126\211\054\247\211\337\141\374\377\315"
	"\044\320\212\341\011\360\244\061\122\354\001\051\132\331\316\335"
	"\177\332\241\063\202\246\074\230\304\131\307\363\037\027\325\303"
	"\240\156\203\005\255\326\374\052\377\163\277\042\303\034\041\253"
	"\146\241\160\373\320\214\263\156\220\173\355\132\336\205\025\257"
	"\131\352\072\246\360\056\045\235\366\203\150\230\003\376\214\135"
	"\377\130\363\012\133\026\252\066\206\252\375\016\017\242\230\067"
	"\202\217\313\271\026\326\334\202\303\127\052\216\150\261\062\342"
	"\307\143\172\166\047\265\024\061\116\343\316\156\241\307\343\053"
	"\213\134\342\104\202\071\304\016\117\313\050\067\066\120\276\104"
	"\132\141\147\174\341\275\044\050\047\077\031\310\123\114\302\035"
	"\204\110\073\043\303\167\012\362\216\044\365\230\325\160\046\251"
	"\016\165\370\363\050\320\106\350\310\315\050\253\036\153\162\203"
	"\205\220\173\114\270\253\021\173\157\104\100\130\200\204\236\377"
	"\202\305\304\135\334\312\005\064\132\337\137\310\151\335\040\022"
	"\025\160\363\133\227\154\211\342\210\053\142\371\046\224\135\044"
	"\150\105\114\217\204\052\333\204\235\102\025\027\347\053\374\100"
	"\347\073\376\036\001\003\170\164\022\106\063\326\056\211\214\320"
	"\223\224\066\217\236\344\172\360\020\035\325\143\305\304\022\060"
	"\124\032\377\025\214\175\270\161\102\026\117\202\255\317\342\222"
	"\113\102\334\231\013\340\012\047\352\220\100\203\065\142\267\346"
	"\301\140\344\074\015\230\265\110\271\127\326\115\226\376\057\061"
	"\355\173\064\223\157\275\077\330\263\355\061\152\017\054\331\362"
	"\167\324\003\254\226\134\361\001\273\237\112\173\032\241\014\046"
	"\317\156\376\174\316\032\251\315\343\007\010\104\205\203\016\273"
	"\375\342\043\247\230\205\243\012\250\210\123\364\146\304\172\144"
	"\000\304\022\244\050\275\032\040\006\336\052\033\171\065\116\071"
	"\261\237\067\201\116\030\010\043\104\272\246\176\222\360\314\115"
	"\327\031\233\274\253\313\342\364\053\054\302\341\006\170\313\335"
	"\144\242\300\113\021\237\050\235\225\351\224\273\136\260\365\315"
	"\003\061\214\053\215\133\304\005\323\102\042\011\153\306\074\367"
	"\125\000\163\300\355\233\350\121\226\072\152\023\233\045\074\146"
	"\344\176\215\047\237\206\017\143\361\053\274\144\050\202\130\212"
	"\135\222\344\126\323\160\171\342\036\052\016\142\333\253\171\045"
	"\212\171\131\327\324\170\227\173\001\312\033\220\366\227\137\003"
	"\024\213\117\364\165\204\042\345\117\314\041\230\153\031\352\213"
	"\273\232\344\221\267\051\062\266\141\114\356\006\205\005\015\237"
	"\165\164\342\204\001\043\171\156\230\177\015\063\122\112\353\106"
	"\000\124\365\207\057\151\203\021\112\165\075\207\227\362\251\326"
	"\357\157\323\074\146\234\323\225\142\341\262\362\156\316\311\306"
	"\322\103\127\157\023\102\320\071\027\246\122\114\272\217\204\150"
	"\362\373\033\310\320\232\032\247\362\157\144\321\104\215\254\305"
	"\204\277\352\254\266\364\203\261\340\335\155\262\221\320\076\313"
	"\337\127\240\264\131\203\064\340\362\152\263\306\043\356\357\232"
	"\216\002\054\257\230\336\004\166\023\354\232\055\265\360\053\175"
	"\072\074\277\005\233\100\341\364\261\276\043\362\164\324\167\244"
	"\361\030\141\171\327\017\077\105\337\326\120\254\252\073\211\066"
	"\161\363\021\022\244\344\150\121\006\367\045\261\177\316\337\237"
	"\120\171\212\234\102\125\132\254\107\215\241\213\115\314\110\366"
	"\257\247\342\024\356\265\100\072\305\165\124\112\162\054\221\033"
	"\241\063\305\125\124\376\162\315\122\366\023\234\150\060\041\036"
	"\253\253\026\377\117\276\150\101\057\075\267\112\146\321\275\052"
	"\155\272\111\245\022\214\173\000\140\323\153\157\337\343\342\041"
	"\036\305\333\253\245\033\305\011\212\007\262\246\157\201\137\264"
	"\302\355\245\324\057\150\133\320\362\231\362\102\316\003\226\332"
	"\350\351\024\010\051\370\022\207\011\201\164\210\101\127\176\240"
	"\350\103\021\012\375\144\105\015\377\022\101\355\034\057\020\136"
	"\172\001\334\214\275\200\210\065\254\315\017\162\107\135\127\227"
	"\364\050\126\255\007\272\313\024\202\122\275\277\330\237\170\237"
	"\210\112\040\206\260\341\117\320\046\133\115\062\107\075\014\125"
	"\175\372\126\030\244\160\341\151\147\213\171\247\316\161\212\354"
	"\034\001\140\243\377\331\157\334\277\315\132\035\032\306\226\344"
	"\266\246\377\046\316\162\052\367\264\004\232\163\347\376\205\236"
	"\007\001\017\131\164\355\012\020\204\111\140\201\356\002\211\115"
	"\147\156\324\204\020\044\130\062\217\020\061\355\126\007\231\120"
	"\224\011\042\206\170\241\306\043\322\160\342\227\160\333\057\200"
	"\350\256\364\124\103\036\177\164\003\203\264\325\017\311\224\233"
	"\204\202\026\210\277\060\201\007\317\204\073\250\176\254\160\210"
	"\140\346\357\151\160\324\021\305\206\150\173\065\022\354\017\001"
	"\227\026\116\142\363\344\303\044\104\131\345\140\321\321\004\026"
	"\227\260\021\275\270\244\353\120\220\231\007\064\365\214\124\071"
	"\311\362\267\215\055\112\147\120\241\271\046\261\223\335\333\376"
	"\306\127\273\150\226\014\025\226\170\227\327\224\323\322\232\117"
	"\066\116\131\277\320\042\122\264\224\122\052\212\172\111\042\165"
	"\075\152\011\310\362\016\145\116\126\271\131\233\107\170\322\053"
	"\315\074\116\313\342\122\242\334\136\216\043\222\366\220\117\127"
	"\074\022\374\124\022\104\024\126\207\215\150\121\302\340\127\024"
	"\063\106\324\274\345\274\125\203\212\356\165\001\270\317\026\245"
	"\170\350\246\265\210\050\012\115\264\130\147\012\341\252\275\211"
	"\173\262\157\132\246\106\227\314\142\123\176\232\232\010\257\033"
	"\135\047\217\027\012\135\132\171\226\275\345\317\310\053\206\204"
	"\102\123\303\060\300\123\001\333\223\245\036\151\336\306\064\204"
	"\330\306\035\330\043\127\123\314\125\115\374\153\173\210\024\011"
	"\026\117\250\333\206\242\032\055\137\044\017\312\152\052\121\340"
	"\227\031\161\154\011\352\376\346\124\270\141\203\246\176\003\106"
	"\357\334\113\236\067\077\201\222\343\062\175\310\051\366\260\310"
	"\340\310\236\042\354\230\226\302\272\361\212\262\115\307\132\170"
	"\320\251\312\342\233\324\345\144\322\215\107\200\236\363\250\034"
	"\072\047\110\020\032\354\063\070\356\046\345\020\054\347\120\206"
	"\360\205\036\243\361\207\041\137\311\355\127\204\157\321\215\071"
	"\260\147\250\042\375\143\275\373\262\070\255\022\063\345\354\075"
	"\146\111\303\244\302\033\003\131\211\223\174\326\260\361\065\021"
	"\011\227\356\036\313\335\304\147\114\337\317\066\072\015\340\336"
	"\016\070\340\066\247\112\061\254\015\055\375\140\325\216\264\142"
	"\062\300\170\136\010\343\215\213\025\210\225\164\126\277\232\073"
	"\036\134\211\165\053\203\326\123\155\367\351\203\016\300\164\311"
	"\130\221\037\233\314\273\071\031\107\127\162\227\323\062\374\327"
	"\067\111\061\163\370\017\246\111\321\267\223\336\101\251\214\233"
	"\211\034\007\025\373\040\231\162\276\201\013\012\052\306\063\373"
	"\357\215\066\076\306\014\143\024\303\342\105\240\216\073\230\074"
	"\134\043\235\254\022\306\141\046\210\110\137\135\064\027\071\326"
	"\157\013\036\056\146\151\351\205\223\135\317\137\357\247\204\224"
	"\277\321\033\271\143\052\264\337\150\373\071\360\276\350\342\074"
	"\056\365\153\177\041\240\321\100\203\103\022\121\274\174\036\176"
	"\200\240\326\302\065\114\010\353\316\146\067\247\007\014\050\360"
	"\210\252\356\263\043\224\024\332\117\337\204\035\210\077\074\267"
	"\215\354\362\147\205\242\157\366\326\173\054\014\016\175\066\160"
	"\113\062\070\236\167\325\334\032\101\214\217\370\250\173\230\045"
	"\210\044\175\326\124\120\215\307\373\222\315\254\002\241\201\347"
	"\030\341\070\315\303\230\124\012\177\247\215\216\225\210\201\375"
	"\362\105\147\262\245\052\243\367\307\122\134\123\156\373\326\230"
	"\116\047\170\024\126\225\227\002\163\036\234\077\146\342\341\107"
	"\215\113\070\322\371\303\051\357\245\061\224\236\305\101\304\324"
	"\010\211\061\117\160\227\265\133\206\232\124\125\176\105\064\206"
	"\210\240\222\062\044\245\065\274\370\206\234\231\151\242\154\136"
	"\355\117\075\173\200\035\126\375\376\353\005\367\230\346\265\164"
	"\022\024\323\236\145\255\131\127\233\234\037\024\014\125\160\352"
	"\377\313\370\017\325\167\331\313\375\256\133\271\227\213\010\154"
	"\167\212\057\312\143\110\265\370\242\007\264\031\026\171\133\353"
	"\104\360\065\247\121\313\307\045\042\315\142\112\365\153\267\023"
	"\004\375\277\136\062\300\273\145\104\372\272\256\031\250\131\357"
	"\200\132\321\321\201\001\355\377\000\113\016\365\144\115\170\377"
	"\211\155\017\145\015\026\152\012\347\333\044\127\045\033\170\016"
	"\154\201\110\027\136\120\111\020\357\232\372\040\201\340\142\365"
	"\054\220\101\055\362\152\161\175\121\246\343\173\274\051\026\141"
	"\236\135\140\107\021\254\377\231\302\364\261\054\255\370\240\065"
	"\257\243\324\123\061\204\067\202\246\354\254\076\230\126\121\140"
	"\354\065\145\062\026\205\377\215\240\241\335\332\012\364\115\126"
	"\025\330\223\026\251\042\216\215\026\104\017\352\061\271\004\113"
	"\336\322\172\270\163\321\153\077\102\117\366\107\057\152\017\262"
	"\275\372\053\124\143\053\167\060\071\346\170\351\316\061\243\165"
	"\116\301\350\374\172\311\216\322\375\054\371\364\167\377\200\360"
	"\244\172\250\226\201\153\323\350\214\302\145\112\133\321\246\070"
	"\355\015\317\152\246\252\215\236\236\303\333\025\026\043\005\126"
	"\265\343\204\322\206\356\240\215\216\361\117\033\144\112\361\314"
	"\061\263\045\053\311\121\236\260\207\262\227\242\305\050\340\276"
	"\351\041\231\066\175\107\221\127\030\050\260\023\263\204\241\251"
	"\146\227\037\243\305\146\315\361\177\261\225\070\320\323\271\275"
	"\006\254\323\116\261\024\266\327\022\302\011\241\112\225\242\165"
	"\301\122\062\274\252\156\060\062\064\350\200\244\247\247\364\322"
	"\145\014\357\105\014\147\234\240\041\074\011\375\123\337\022\331"
	"\373\363\370\112\227\142\100\261\247\134\171\146\115\016\343\030"
	"\165\032\355\102\234\217\167\056\315\007\112\177\010\220\014\015"
	"\035\344\126\220\151\134\057\250\256\241\053\123\125\344\265\227"
	"\011\206\035\227\371\264\343\003\013\312\002\122\032\342\153\333"
	"\363\223\045\175\232\263\067\055\375\042\141\330\335\375\066\100"
	"\117\117\157\046\251\064\313\125\214\371\226\336\217\150\254\173"
	"\316\024\123\171\042\117\303\071\105\250\305\033\255\116\177\313"
	"\063\266\275\150\256\013\347\044\207\223\252\262\357\222\146\007"
	"\276\025\046\374\233\107\012\304\153\302\333\103\271\237\154\212"
	"\010\017\045\305\125\364\252\105\031\363\123\360\256\064\117\165"
	"\261\152\271\142\073\060\011\220\263\367\371\011\153\040\326\134"
	"\232\332\375\043\331\320\122\063\351\071\137\016\006\071\062\125"
	"\355\135\124\143\315\331\015\121\326\174\251\327\350\224\020\271"
	"\337\026\121\204\272\357\077\256\134\134\152\026\130\075\215\146"
	"\073\207\154\241\133\277\233\364\003\100\346\116\167\332\304\313"
	"\066\067\061\325\311\030\200\174\170\127\356\141\033\147\225\213"
	"\140\356\017\257\212\227\127\243\116\076\073\370\062\220\211\322"
	"\024\031\352\330\123\016\331\131\110\123\354\032\042\325\240\242"
	"\253\232\330\265\340\305\171\325\320\222\040\031\272\374\200\152"
	"\211\365\360\247\206\157\004\274\103\212\207\247\376\005\212\013"
	"\241\263\044\132\205\362\275\242\273\052\154\127\030\073\054\301"
	"\112\255\110\161\114\134\200\367\222\175\120\045\154\172\072\004"
	"\324\300\257\275\170\022\121\371\233\135\263\056\271\361\354\173"
	"\220\371\230\161\017\047\257\002\057\113\010\043\027\237\150\365"
	"\252\051\147\030\152\143\144\242\232\246\043\050\215\277\350\313"
	"\313\176\375\374\047\062\146\002\106\117\161\176\330\304\327\174"
	"\151\257\347\116\277\036\114\141\141\112\175\262\217\261\252\161"
	"\105\054\142\020\066\113\162\130\113\032\373\151\304\164\046\006"
	"\056\001\324\133\117\137\262\134\316\065\104\073\114\126\132\116"
	"\351\055\127\216\053\247\172\205\160\227\204\065\272\122\074\054"
	"\166\033\230\201\176\177\001\210\244\164\304\061\270\311\276\002"
	"\047\270\342\220\355\266\010\045\107\264\225\233\265\114\323\205"
	"\310\212\202\167\165\157\366\250\206\106\361\061\364\006\371\123"
	"\264\250\126\222\102\234\012\072\025\001\332\244\140\005\011\142"
	"\346\134\232\001\364\161\264\252\330\214\015\272\146\077\023\214"
	"\377\322\033\014\255\066\313\262\073\117\366\275\146\312\324\157"
	"\113\245\321\211\126\346\153\015\177\126\257\221\164\245\113\112"
	"\160\036\144\027\376\361\320\174\220\357\205\104\056\306\145\334"
	"\035\054\043\102\012\112\156\052\234\312\326\043\254\326\110\356"
	"\236\171\006\274\333\026\322\050\256\312\331\176\334\330\134\127"
	"\207\304\335\211\160\044\101\145\025\237\323\126\323\270\075\341"
	"\146\252\153\175\225\020\330\027\014\211\154\213\351\330\374\160"
	"\345\306\004\314\235\017\226\273\156\201\167\254\046\212\364\107"
	"\366\335\120\337\266\272\250\053\060\043\352\271\133\277\271\335"
	"\372\122\144\167\340\130\033\100\020\355\140\343\232\376\206\112"
	"\034\371\063\202\007\260\162\126\366\237\214\054\364\331\334\021"
	"\117\131\244\146\057\364\102\134\004\326\334\361\025\166\026\104"
	"\174\313\203\233\237\013\266\303\371\365\013\322\262\331\113\271"
	"\140\325\015\354\366\200\240\105\227\331\127\270\371\077\110\074"
	"\300\357\114\106\266\224\142\201\367\363\166\031\104\037\241\070"
	"\132\026\055\174\314\217\164\021\334\371\336\341\175\153\044\340"
	"\267\120\361\335\334\256\241\275\226\255\251\063\254\252\352\025"
	"\051\051\327\064\153\126\311\141\322\176\055\347\176\230\071\032"
	"\360\323\135\067\361\035\377\301\217\125\350\054\336\157\246\172"
	"\306\035\122\163\005\324\162\013\076\352\230\114\241\163\000\066"
	"\210\127\320\347\317\103\240\146\025\054\340\277\030\022\036\020"
	"\032\143\024\310\074\146\136\307\025\037\324\214\303\055\040\335"
	"\215\177\141\257\003\213\073\314\153\070\273\221\314\257\077\012"
	"\112\331\363\156\236\011\126\270\027\172\203\232\304\217\171\340"
	"\071\253\040\246\330\072\203\221\101\056\230\145\163\004\103\377"
	"\160\231\254\150\067\356\111\325\271\040\071\275\207\010\123\262"
	"\234\011\044\153\340\332\254\246\375\137\320\075\233\273\240\322"
	"\363\306\250\130\302\245\166\154\154\040\164\017\130\350\323\356"
	"\122\270\361\046\323\322\120\157\113\221\332\045\150\164\041\032"
	"\312\316\054\052\246\220\377\202\244\326\056\207\162\115\136\132"
	"\042\363\341\134\250\224\167\213\173\163\110\104\127\150\132\061"
	"\312\224\225\233\167\345\366\335\145\201\221\046\326\122\170\325"
	"\076\116\253\133\256\356\020\134\321\022\366\264\366\262\371\044"
	"\132\365\074\242\306\062\226\240\163\310\023\174\053\264\125\173"
	"\006\052\121\006\177\135\361\261\367\045\252\240\374\354\331\063"
	"\044\144\135\254\150\103\361\247\370\313\063\164\270\365\304\147"
	"\103\170\370\064\141\354\325\302\114\357\151\365\146\360\164\221"
	"\344\123\017\233\335\003\150\163\114\322\365\160\361\031\175\352"
	"\046\367\300\376\345\353\103\252\060\076\124\275\150\377\273\252"
	"\266\072\314\303\224\316\152\301\062\272\325\115\357\330\211\123"
	"\237\325\307\124\151\024\066\136\347\064\274\161\173\031\241\377"
	"\234\061\216\161\320\207\363\173\074\140\261\145\174\201\047\127"
	"\077\211\155\113\042\263\242\125\026\061\015\007\301\022\053\277"
	"\314\226\127\021\237\036\311\035\053\020\212\040\055\230\166\064"
	"\256\073\223\153\310\326\165\227\350\317\346\017\253\020\360\263"
	"\121\266\246\135\364\115\152\245\227\046\244\330\244\221\157\051"
	"\317\222\341\343\320\250\322\022\163\202\220\200\062\204\332\006"
	"\156\230\173\200\117\341\225\162\021\247\244\241\260\163\375\336"
	"\200\367\137\200\211\112\046\351\303\140\311\244\272\017\140\207"
	"\210\241\224\215\230\267\016\136\234\005\146\260\214\030\320\137"
	"\356\111\122\225\040\254\332\314\066\175\160\363\055\353\134\316"
	"\023\222\372\275\104\327\241\001\176\245\005\065\247\125\042\053"
	"\313\246\231\175\243\217\167\075\246\173\120\274\350\050\021\265"
	"\145\025\160\275\224\173\343\125\171\302\027\322\046\104\312\237"
	"\111\264\102\124\166\236\362\076\327\047\317\111\204\374\202\325"
	"\266\146\051\077\311\154\226\161\357\272\236\274\104\137\374\377"
	"\002\274\143\071\142\330\143\063\120\073\230\252\317\133\111\170"
	"\120\031\025\353\277\237\023\063\165\330\337\346\167\266\250\345"
	"\253\062\276\226\144\354\343\237\057\252\225\057\163\017\377\113"
	"\251\045\067\121\172\205\303\376\077\104\146\062\060\126\267\057"
	"\145\246\164\356\036\001\244\363\316\354\006\025\036\362\062\174"
	"\371\263\276\356\145\243\154\320\364\206\035\011\156\020\275\115"
	"\070\302\256\015\214\001\202\226\364\027\026\166\365\214\112\351"
	"\222\315\261\054\361\242\070\024\073\262\244\231\043\142\003\110"
	"\121\135\321\001\066\327\125\322\351\342\243\205\351\014\243\002"
	"\376\034\004\327\233\261\222\163\207\021\225\214\011\007\007\015"
	"\161\356\136\215\140\310\204\233\123\343\110\216\271\303\277\004"
	"\356\306\371\246\320\155\026\173\034\321\366\067\264\350\011\115"
	"\317\177\323\306\035\014\103\156\372\041\122\010\203\213\134\013"
	"\000\033\100\251\026\067\163\334\251\360\010\315\346\312\343\063"
	"\163\012\154\314\134\240\350\344\365\255\263\354\174\102\314\011"
	"\315\014\005\116\005\331\043\154\062\215\324\021\004\271\232\354"
	"\155\067\333\324\207\225\343\224\034\272\162\224\121\333\250\032"
	"\052\035\035\155\055\264\332\257\137\154\112\204\137\010\250\023"
	"\133\041\264\007\357\230\233\014\122\015\240\244\350\110\277\023"
	"\146\334\201\223\221\133\102\360\310\215\165\050\226\036\073\361"
	"\077\360\370\057\210\224\074\332\241\335\177\212\045\076\236\214"
	"\033\037\037\254\173\142\234\104\360\022\154\206\060\247\170\160"
	"\227\160\240\037\004\334\372\246\271\172\061\337\270\317\153\323"
	"\357\212\200\153\355\035\257\335\057\033\143\140\303\333\321\133"
	"\114\161\173\121\115\165\370\007\360\051\347\251\371\122\175\350"
	"\335\375\124\312\032\003\250\112\037\013\253\342\347\174\076\063"
	"\355\271\205\073\057\175\103\037\246\052\310\240\174\105\211\132"
	"\103\335\045\135\341\315\250\000\330\123\343\300\317\041\364\275"
	"\332\171\370\011\366\073\051\235\145\361\075\342\067\306\074\172"
	"\244\141"
#define      chk2_z	19
#define      chk2	((&data[6036]))
	"\201\205\103\346\143\041\107\246\217\052\170\333\266\115\245\017"
	"\263\214\301\304\224"
#define      date_z	1
#define      date	((&data[6055]))
	"\311"
#define      opts_z	1
#define      opts	((&data[6056]))
	"\270"
#define      shll_z	10
#define      shll	((&data[6058]))
	"\065\265\212\023\240\267\044\116\064\166\365\132"
#define      tst1_z	22
#define      tst1	((&data[6070]))
	"\231\104\207\262\376\023\062\136\132\120\073\021\017\350\122\020"
	"\123\014\371\251\126\105\206\312\373\213"
#define      inlo_z	3
#define      inlo	((&data[6095]))
	"\150\066\304"
#define      xecc_z	15
#define      xecc	((&data[6098]))
	"\355\023\026\314\230\113\144\222\063\375\347\112\306\103\143"
#define      chk1_z	22
#define      chk1	((&data[6115]))
	"\371\253\126\014\273\200\166\001\067\254\025\206\227\271\127\352"
	"\003\226\331\066\174\265\046\106"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
