#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f lock_arena/data/pretest.sh 
#endif

static  char data [] = 
#define      tst2_z	19
#define      tst2	((&data[2]))
	"\327\022\227\377\047\345\050\026\315\136\017\017\061\370\316\322"
	"\153\034\340\273\263\320\151"
#define      lsto_z	1
#define      lsto	((&data[23]))
	"\221"
#define      msg2_z	19
#define      msg2	((&data[26]))
	"\065\015\112\201\241\317\221\024\260\217\171\124\135\021\066\010"
	"\210\141\025\032\003"
#define      opts_z	1
#define      opts	((&data[45]))
	"\113"
#define      tst1_z	22
#define      tst1	((&data[47]))
	"\246\310\362\126\353\207\145\326\237\153\004\265\224\243\202\002"
	"\156\242\177\050\362\312\200\226"
#define      chk2_z	19
#define      chk2	((&data[73]))
	"\323\305\037\174\021\173\132\017\362\355\127\221\116\327\257\121"
	"\021\171\237\274\107\345\113\201\376\302"
#define      pswd_z	256
#define      pswd	((&data[150]))
	"\300\100\113\030\107\345\202\137\032\217\047\225\203\237\343\303"
	"\106\171\275\345\117\221\252\156\334\054\155\237\033\103\165\334"
	"\204\300\365\313\245\167\053\300\007\123\126\212\363\071\116\071"
	"\263\014\036\002\235\311\252\262\100\151\306\345\246\306\004\352"
	"\315\312\202\151\020\021\305\030\373\064\366\340\011\352\355\110"
	"\247\345\271\372\021\144\254\122\316\162\070\164\071\074\137\006"
	"\006\342\160\026\364\066\057\357\152\046\317\164\020\275\274\267"
	"\243\166\262\265\332\137\007\250\321\077\035\013\174\174\022\203"
	"\137\202\232\123\270\311\102\043\357\022\227\000\320\123\267\163"
	"\312\152\050\244\311\060\115\233\160\152\246\355\347\271\160\106"
	"\074\012\231\365\323\334\030\302\356\257\303\277\003\172\062\315"
	"\345\133\162\256\213\277\111\374\052\360\351\021\251\131\130\346"
	"\144\361\333\067\316\363\372\274\243\275\173\246\070\256\164\035"
	"\011\346\314\225\245\026\221\320\007\172\341\261\324\071\227\070"
	"\053\162\160\371\145\153\266\010\050\062\257\141\341\043\177\352"
	"\011\113\200\257\142\022\177\151\215\141\032\141\233\261\232\307"
	"\044\012\301\212\165\167\222\236\252\102\377\213\145\176\166\157"
	"\312\367\036\055\011\236\226\226\377\261\370\233\143\222\142\207"
	"\234\043\021\021\233\244\257\106\346\257\321\113\056\110\272\371"
	"\077\331\046\111\167\274\160\172\365\335\031\021\041\216\355\246"
	"\117\342\162\365\131\235\265\140\361\014\353\344\105\072\036\370"
	"\106\074\372\343\005\153\135\372\111\167\013\153\005\371\021\125"
	"\333\204\112\065\041\000\226\023\014\202\370\122"
#define      text_z	4857
#define      text	((&data[564]))
	"\002\122\105\346\130\261\104\123\372\273\137\145\301\130\167\026"
	"\064\373\141\152\035\142\000\060\156\203\050\300\077\076\013\102"
	"\221\120\051\351\002\155\074\374\051\233\142\352\364\332\001\050"
	"\325\143\223\363\305\223\044\063\027\115\364\127\214\377\231\035"
	"\120\303\007\122\060\104\117\132\340\262\105\324\214\106\375\142"
	"\252\220\126\157\044\172\243\074\307\230\223\124\230\054\161\350"
	"\357\171\073\040\276\213\172\236\317\327\122\117\210\154\047\071"
	"\342\244\124\264\025\076\021\060\124\010\052\076\143\334\167\040"
	"\252\123\135\241\263\244\045\027\156\163\263\365\317\220\077\172"
	"\015\172\127\126\065\047\222\361\327\046\147\325\021\357\254\350"
	"\377\313\214\302\224\045\034\347\006\106\336\173\013\046\153\137"
	"\221\207\150\205\164\350\321\065\244\226\243\134\320\127\033\245"
	"\114\234\074\210\272\113\167\310\145\175\307\144\271\200\117\145"
	"\331\317\072\351\147\274\252\231\331\106\052\201\233\156\033\157"
	"\326\034\224\214\336\052\247\363\043\327\065\067\341\306\310\312"
	"\150\003\157\126\377\345\326\114\244\351\256\204\067\372\022\341"
	"\256\107\100\354\227\315\100\323\355\315\071\202\311\051\374\227"
	"\277\130\160\105\374\003\214\177\126\131\173\071\272\305\175\130"
	"\042\250\046\343\005\226\172\036\105\362\362\073\167\247\321\305"
	"\251\321\257\131\337\026\021\314\030\331\165\025\226\363\137\241"
	"\244\372\210\246\112\162\060\360\263\151\126\377\240\035\223\126"
	"\357\151\152\166\071\333\236\306\060\033\056\370\232\056\306\145"
	"\062\017\156\127\133\063\247\026\310\023\313\017\346\213\144\217"
	"\016\003\363\316\210\251\047\000\224\333\233\260\114\055\016\052"
	"\264\235\005\206\375\213\004\232\302\032\234\136\274\344\021\332"
	"\112\267\275\206\002\320\242\016\344\335\252\314\272\327\330\304"
	"\253\375\126\130\012\100\300\370\105\262\245\155\064\271\212\151"
	"\322\361\235\212\123\306\363\136\345\200\165\227\277\327\170\245"
	"\006\021\361\213\015\065\363\152\356\225\354\311\133\122\002\302"
	"\065\055\260\367\370\123\226\110\310\331\357\014\360\363\106\223"
	"\025\157\277\361\105\227\224\026\045\376\226\244\315\023\235\117"
	"\217\157\340\166\065\301\255\061\144\231\145\350\141\264\255\174"
	"\355\164\065\370\175\171\201\332\007\201\246\076\224\222\043\104"
	"\260\377\103\252\300\304\024\316\374\117\013\252\367\166\376\175"
	"\103\270\302\271\260\224\124\056\076\024\323\063\064\212\137\013"
	"\071\202\266\321\126\213\236\301\146\317\166\313\353\325\154\377"
	"\125\066\034\163\166\213\364\343\341\166\011\264\015\335\150\340"
	"\052\336\065\071\176\151\064\303\355\015\246\152\203\005\375\107"
	"\236\143\203\205\313\162\164\113\122\204\026\035\367\012\011\172"
	"\333\320\011\145\357\342\247\022\250\063\365\060\121\250\227\261"
	"\323\137\014\357\111\163\117\052\134\377\031\025\030\276\204\312"
	"\063\151\337\014\062\320\120\355\102\010\031\036\243\031\217\017"
	"\341\302\221\177\215\066\135\023\126\334\163\174\020\216\071\353"
	"\106\147\035\257\304\365\335\262\264\176\151\300\055\053\100\051"
	"\215\272\127\232\107\325\301\044\264\262\375\255\221\320\270\113"
	"\204\203\156\140\374\002\030\057\372\173\361\144\016\227\063\305"
	"\171\072\104\202\316\026\200\037\224\152\000\107\246\160\070\004"
	"\306\170\063\156\167\202\203\342\041\204\150\237\220\352\212\107"
	"\114\323\027\073\052\104\123\032\377\023\267\337\030\313\134\300"
	"\355\113\044\261\225\135\272\037\005\070\105\146\075\070\152\157"
	"\132\127\205\252\332\140\033\235\160\050\031\067\111\136\065\323"
	"\075\032\266\373\036\037\374\133\134\002\325\256\165\147\273\146"
	"\327\356\071\252\063\232\351\177\343\207\257\276\214\271\172\114"
	"\053\171\304\220\215\160\305\176\221\312\347\343\370\306\265\306"
	"\264\264\366\014\365\327\303\322\040\121\002\125\063\144\264\026"
	"\170\351\142\100\270\144\134\336\321\217\124\351\326\203\214\101"
	"\261\104\245\131\021\217\323\010\027\321\276\316\133\075\143\262"
	"\073\067\011\101\013\204\041\246\311\147\172\234\221\251\172\343"
	"\066\244\247\121\021\307\352\356\346\311\121\236\324\272\332\265"
	"\105\042\337\206\011\247\316\151\306\175\340\137\305\255\273\041"
	"\252\023\003\044\347\051\205\160\370\216\354\224\234\325\374\366"
	"\106\255\131\357\107\141\037\226\142\230\332\131\011\267\207\252"
	"\341\120\237\131\320\037\105\174\155\377\101\053\271\232\177\146"
	"\060\161\157\002\162\024\156\267\310\044\304\004\214\366\377\050"
	"\225\011\063\022\136\062\247\240\101\337\261\016\235\061\243\114"
	"\034\026\064\110\344\114\302\151\077\062\251\246\111\273\357\376"
	"\371\071\320\302\175\114\004\053\177\353\102\006\255\354\330\057"
	"\327\241\270\323\044\170\005\106\056\030\226\065\225\223\170\274"
	"\011\154\312\250\023\377\145\311\043\363\265\322\231\007\316\207"
	"\243\122\022\243\073\270\121\034\266\256\177\350\321\301\342\015"
	"\300\150\376\107\341\175\047\140\246\022\374\203\231\361\152\207"
	"\254\223\120\237\305\213\026\344\356\303\347\074\211\061\261\132"
	"\325\137\017\242\277\005\360\325\373\341\264\161\270\342\022\345"
	"\154\127\143\362\067\264\006\052\070\260\026\012\233\055\121\015"
	"\363\022\024\277\073\176\302\014\207\135\377\315\063\352\245\222"
	"\357\007\124\263\261\000\366\045\233\376\373\075\312\025\234\043"
	"\036\315\032\315\205\350\367\207\005\135\347\326\267\001\334\073"
	"\160\050\120\363\007\007\131\356\020\053\231\331\371\151\220\174"
	"\354\054\175\374\337\106\244\107\342\222\304\213\214\327\065\034"
	"\050\144\073\251\306\104\302\334\065\277\262\320\047\005\237\001"
	"\323\356\232\165\044\133\062\150\332\122\233\162\323\113\242\304"
	"\261\075\253\175\152\227\242\376\110\264\331\370\222\263\342\175"
	"\134\123\101\207\247\025\357\337\126\111\042\152\064\344\012\325"
	"\066\302\373\226\301\012\201\262\073\223\015\152\064\251\256\310"
	"\064\114\011\072\076\035\023\364\034\263\023\315\363\062\133\214"
	"\272\073\100\337\250\053\156\077\050\332\055\275\156\260\125\113"
	"\011\341\100\333\104\235\131\131\376\071\371\200\304\157\042\041"
	"\075\147\015\377\274\305\210\336\325\320\263\114\303\174\221\010"
	"\075\256\255\000\062\013\036\026\053\222\031\171\006\146\257\210"
	"\224\112\170\350\055\006\110\106\144\253\074\031\072\372\064\367"
	"\146\022\163\024\032\021\104\372\002\106\216\125\175\033\132\146"
	"\272\276\027\372\146\320\347\147\030\273\340\057\162\136\303\021"
	"\166\214\252\165\327\247\172\333\005\266\272\271\034\022\044\271"
	"\005\336\323\353\064\275\230\251\165\224\123\366\152\221\352\024"
	"\176\242\342\273\011\310\072\213\047\044\136\243\235\173\200\264"
	"\321\261\074\312\156\017\154\373\024\167\332\312\327\304\111\102"
	"\106\342\050\147\216\103\320\045\013\267\102\316\211\321\165\124"
	"\124\147\353\377\324\122\002\333\170\071\031\371\032\304\056\326"
	"\242\333\152\315\371\024\254\161\235\146\331\343\106\322\066\355"
	"\264\126\164\174\072\125\170\263\151\146\215\356\136\020\113\222"
	"\165\336\247\166\375\156\321\247\224\252\364\020\247\267\172\102"
	"\055\257\026\114\165\041\275\334\354\041\013\254\027\066\164\161"
	"\231\114\272\060\265\001\063\134\342\262\237\206\334\106\170\325"
	"\346\004\365\117\134\173\011\201\324\161\236\362\110\016\252\375"
	"\214\303\116\213\075\347\345\351\172\376\367\223\312\020\327\105"
	"\235\154\152\230\170\270\232\003\243\167\235\116\313\172\164\275"
	"\175\227\242\043\150\115\114\060\054\260\106\377\107\112\217\026"
	"\323\005\123\212\320\130\054\314\112\221\037\114\337\351\367\247"
	"\033\022\232\150\051\366\164\152\220\361\344\162\340\037\137\014"
	"\105\114\052\034\214\202\274\356\235\167\273\102\177\274\223\136"
	"\361\247\302\100\332\040\017\327\220\042\133\160\127\306\261\236"
	"\377\166\333\154\377\112\211\342\366\046\226\177\165\357\043\063"
	"\017\001\314\122\334\127\316\221\014\216\025\142\315\322\237\171"
	"\175\232\242\063\363\015\315\257\211\320\374\141\353\174\126\244"
	"\010\114\330\367\254\306\355\302\212\066\240\136\000\312\077\141"
	"\051\104\162\024\355\345\243\033\264\101\316\015\340\126\214\351"
	"\173\176\336\301\035\271\322\127\271\306\273\231\354\301\074\025"
	"\121\247\234\111\321\124\032\207\343\035\263\175\062\302\224\274"
	"\064\263\203\153\310\306\327\145\254\114\316\010\217\161\014\214"
	"\043\342\152\146\144\077\161\352\316\262\043\062\361\002\367\062"
	"\214\050\231\370\365\027\235\337\063\145\057\067\007\112\205\044"
	"\050\356\102\346\322\337\300\114\223\303\261\233\126\346\144\146"
	"\034\223\053\214\354\311\267\263\311\067\156\016\107\232\335\261"
	"\210\040\133\010\242\103\103\065\113\267\053\261\004\131\257\356"
	"\010\024\077\225\240\001\357\103\231\342\376\037\165\215\020\336"
	"\237\044\056\112\024\045\165\306\113\004\150\347\360\010\036\226"
	"\066\327\375\104\245\231\315\274\062\060\362\164\246\304\262\321"
	"\217\342\123\072\163\000\322\043\072\002\003\324\117\146\266\214"
	"\231\336\203\004\135\135\203\041\051\261\056\000\124\377\337\014"
	"\322\141\156\176\113\300\337\317\131\225\124\101\322\303\112\271"
	"\067\174\251\117\173\230\010\167\174\347\167\243\143\266\164\263"
	"\043\133\202\316\136\006\313\077\033\275\235\235\333\343\015\064"
	"\102\233\216\345\230\001\043\364\164\075\076\232\205\044\267\160"
	"\123\332\270\066\016\151\340\012\151\305\306\154\330\030\014\341"
	"\105\341\060\240\025\023\270\263\217\060\132\347\317\002\377\333"
	"\270\363\063\262\133\122\113\325\020\125\213\045\054\074\004\240"
	"\200\147\065\236\101\034\371\035\000\257\163\376\066\027\141\103"
	"\073\170\121\323\320\114\062\020\332\175\104\011\060\306\270\031"
	"\172\277\346\214\225\023\036\032\073\105\163\361\374\371\204\066"
	"\103\303\305\304\206\233\260\063\154\262\272\066\324\375\016\113"
	"\301\140\170\335\330\153\114\032\130\245\330\356\147\004\342\060"
	"\277\343\022\053\225\216\233\260\024\062\227\062\124\170\311\030"
	"\061\154\355\111\171\322\123\137\304\015\104\333\031\024\156\332"
	"\154\206\127\221\117\305\364\044\121\173\277\017\340\217\056\130"
	"\317\162\302\242\363\177\072\261\012\203\165\021\304\161\127\307"
	"\036\067\246\160\327\014\037\103\176\106\123\075\335\150\010\141"
	"\210\177\306\316\311\227\270\044\311\036\320\325\035\205\304\277"
	"\172\104\032\212\122\034\246\126\211\363\057\173\173\021\243\230"
	"\251\210\103\347\224\231\033\047\043\042\134\031\267\037\177\027"
	"\141\172\340\363\355\344\002\024\021\167\302\305\105\233\211\326"
	"\307\204\011\261\164\010\344\165\144\333\106\312\235\310\175\140"
	"\122\062\111\036\012\060\151\263\200\350\102\142\062\161\161\014"
	"\033\004\016\356\215\254\356\121\034\263\347\261\041\154\302\126"
	"\303\035\237\214\224\062\316\362\301\312\051\076\375\260\240\235"
	"\275\303\175\032\200\350\126\206\310\007\160\377\322\102\160\245"
	"\141\043\273\270\110\060\110\242\151\202\042\235\245\061\120\060"
	"\057\310\052\107\240\262\326\354\352\237\022\227\221\270\354\033"
	"\274\171\030\360\066\060\135\361\047\036\062\336\143\211\277\163"
	"\236\043\052\156\320\137\367\065\215\033\035\364\342\041\142\152"
	"\237\175\220\360\046\245\232\022\352\251\272\021\306\151\021\012"
	"\377\011\062\105\020\344\012\355\247\256\202\150\312\256\245\033"
	"\145\263\306\176\244\316\337\160\002\160\120\171\262\301\204\314"
	"\055\060\324\337\230\252\134\357\374\141\116\132\126\251\222\314"
	"\252\120\035\270\241\327\325\247\342\115\155\273\330\013\356\154"
	"\163\267\157\230\226\216\023\132\371\174\266\061\263\036\144\014"
	"\221\171\017\134\077\335\052\254\143\040\245\240\225\141\353\115"
	"\355\256\150\145\150\330\150\254\342\356\172\056\262\341\270\064"
	"\116\326\141\327\060\044\071\053\204\021\073\255\142\342\214\034"
	"\130\233\045\144\343\051\005\036\247\143\340\331\133\226\314\153"
	"\231\045\306\027\161\364\175\215\031\336\375\341\074\215\075\021"
	"\253\177\004\277\057\061\134\144\221\045\036\343\257\165\124\133"
	"\127\311\056\063\162\311\013\201\237\160\252\226\321\233\351\056"
	"\055\172\274\243\071\215\111\234\303\367\021\255\042\247\057\374"
	"\307\362\223\323\111\175\317\203\251\023\312\345\372\135\312\303"
	"\023\325\070\006\372\037\047\007\023\263\322\002\115\027\163\240"
	"\313\202\132\261\264\262\236\254\104\320\314\371\144\017\055\335"
	"\165\266\017\051\166\025\344\111\375\315\377\027\177\222\026\035"
	"\076\325\172\334\174\336\133\321\055\306\110\263\001\167\373\157"
	"\337\142\176\203\026\220\304\341\161\363\066\127\300\051\311\031"
	"\205\176\164\050\220\305\326\141\072\006\047\340\170\175\300\223"
	"\224\377\204\036\371\304\270\034\163\236\360\121\123\232\047\015"
	"\217\177\261\162\373\015\020\107\150\255\175\147\236\177\131\146"
	"\251\060\151\047\255\303\337\300\242\320\010\046\056\340\012\006"
	"\367\376\104\130\171\311\246\135\050\054\151\116\262\255\323\251"
	"\023\232\114\335\260\072\337\007\313\276\270\076\354\015\250\136"
	"\352\026\303\300\357\364\214\213\350\034\162\254\117\107\323\101"
	"\330\331\364\154\060\125\116\051\256\165\035\237\250\203\072\162"
	"\057\277\265\162\000\260\024\221\352\154\044\277\370\157\026\202"
	"\051\153\025\142\302\272\370\022\327\342\360\114\374\354\264\024"
	"\163\213\011\156\112\007\334\064\312\160\007\272\361\266\010\064"
	"\024\334\375\326\256\303\261\323\201\127\246\302\157\054\350\340"
	"\211\062\227\316\331\355\265\167\332\316\332\357\372\014\166\337"
	"\362\201\164\262\266\103\345\234\307\142\343\020\156\352\047\012"
	"\002\122\243\366\353\151\201\005\356\145\357\317\177\362\165\145"
	"\053\310\243\174\060\205\124\035\111\334\337\326\207\075\173\366"
	"\353\334\320\035\000\144\204\305\166\212\114\201\364\375\045\243"
	"\112\102\105\122\353\370\274\271\212\245\301\332\305\240\101\050"
	"\267\017\256\116\166\050\200\214\144\255\304\001\051\360\202\253"
	"\047\004\312\166\317\360\030\025\006\032\130\151\177\002\273\046"
	"\241\341\265\044\356\044\330\132\145\367\357\001\066\220\027\051"
	"\056\307\204\245\004\241\367\154\270\311\025\360\166\103\217\364"
	"\112\123\161\125\364\264\013\370\233\252\011\031\144\141\155\033"
	"\102\312\104\134\004\065\142\327\106\175\164\303\334\054\336\173"
	"\253\313\114\007\051\256\106\163\337\130\043\156\072\325\063\143"
	"\113\217\217\315\156\077\205\135\361\035\060\055\337\334\212\265"
	"\010\357\340\165\166\335\067\055\113\170\310\251\330\047\333\042"
	"\007\053\144\302\320\173\044\300\331\277\373\127\057\023\075\266"
	"\215\012\164\063\012\355\035\357\101\136\206\341\361\215\023\036"
	"\053\175\256\147\062\216\133\335\243\167\067\323\226\071\335\044"
	"\207\221\031\121\247\207\154\256\247\264\211\152\116\032\104\266"
	"\047\106\043\025\215\257\306\063\043\220\355\101\154\333\221\140"
	"\237\116\273\135\021\122\262\225\050\051\354\277\122\230\114\164"
	"\075\053\327\132\251\130\017\214\240\053\311\343\062\346\041\310"
	"\170\173\143\077\300\035\251\147\015\005\107\201\373\224\277\053"
	"\044\165\121\175\222\115\041\255\104\345\376\303\355\147\177\102"
	"\164\245\217\364\005\366\067\245\164\345\315\346\056\207\251\262"
	"\011\034\045\126\064\174\044\051\354\052\065\303\274\206\303\355"
	"\322\102\051\075\036\135\052\221\214\342\135\227\117\067\254\176"
	"\135\022\116\373\213\263\051\063\253\375\053\356\015\234\070\145"
	"\334\244\376\276\166\102\001\053\224\134\016\240\330\231\161\316"
	"\042\023\307\015\114\042\000\200\262\347\355\167\257\133\345\206"
	"\227\006\322\154\236\336\272\214\314\055\250\070\264\366\124\366"
	"\270\117\136\106\200\017\006\031\007\041\154\246\216\201\066\017"
	"\210\020\105\337\057\165\227\124\036\171\060\251\265\106\050\202"
	"\126\046\243\145\116\054\227\372\150\025\031\157\266\221\151\311"
	"\174\025\336\075\174\143\363\222\253\013\370\261\155\105\056\024"
	"\243\351\140\071\110\064\031\125\341\037\357\251\123\000\167\205"
	"\117\321\003\140\061\234\045\235\160\366\307\342\062\001\317\260"
	"\230\002\106\300\313\332\232\127\034\207\110\001\213\014\261\072"
	"\347\260\330\375\144\200\151\306\046\237\236\116\370\242\033\034"
	"\211\340\155\256\247\336\143\034\355\162\153\044\150\016\357\150"
	"\345\322\311\041\014\033\047\376\036\352\246\245\337\140\261\065"
	"\056\265\031\050\233\104\060\367\032\122\027\353\140\032\112\203"
	"\360\046\147\255\246\163\314\307\010\162\322\334\375\241\137\330"
	"\173\211\023\204\173\061\025\103\257\300\174\153\064\014\136\364"
	"\375\111\234\153\017\270\260\000\221\104\235\342\126\350\160\360"
	"\042\170\313\047\107\022\262\036\365\103\035\142\340\001\163\356"
	"\114\077\017\045\335\347\214\275\032\166\001\264\260\222\122\163"
	"\151\062\032\051\110\125\077\373\074\204\253\272\232\216\203\050"
	"\103\272\037\204\142\255\305\230\133\351\370\201\061\115\123\343"
	"\171\007\324\173\030\143\276\302\252\077\204\132\252\062\025\026"
	"\033\315\166\173\344\320\351\376\213\177\205\250\357\165\056\321"
	"\242\275\022\132\215\112\005\051\212\223\163\252\123\344\361\061"
	"\156\251\275\037\213\300\204\132\142\260\260\077\250\146\203\063"
	"\117\212\374\122\311\135\322\211\036\151\135\360\267\362\122\342"
	"\353\353\007\116\015\025\023\301\147\251\013\110\024\171\122\142"
	"\200\341\033\255\326\374\037\252\160\266\010\376\311\137\360\226"
	"\302\225\050\243\150\246\054\166\035\172\054\376\074\024\374\075"
	"\250\001\364\270\244\030\206\017\263\143\147\363\073\300\351\271"
	"\006\037\106\273\161\346\223\037\026\343\256\066\102\101\037\121"
	"\302\004\323\371\330\262\032\330\272\072\156\361\060\214\050\300"
	"\156\031\357\146\001\131\155\157\215\012\240\347\025\057\200\167"
	"\265\275\140\247\353\335\132\353\372\225\002\014\173\042\221\017"
	"\126\353\304\271\015\324\255\310\140\266\017\176\325\070\004\301"
	"\213\021\234\137\020\164\315\215\321\305\355\045\050\137\232\175"
	"\047\306\277\136\322\117\362\051\171\277\003\240\011\017\075\270"
	"\127\270\255\235\066\171\231\005\246\002\063\244\277\353\217\204"
	"\157\176\370\246\262\256\241\356\032\116\117\207\115\044\340\317"
	"\043\261\274\210\173\014\262\341\237\222\335\012\106\236\211\144"
	"\176\026\242\170\230\211\166\021\247\130\365\247\273\061\060\021"
	"\005\157\377\253\211\163\342\074\174\235\265\275\115\257\377\137"
	"\355\035\011\304\353\273\337\147\116\070\237\215\356\160\131\311"
	"\363\015\201\341\023\355\045\015\145\150\215\322\241\016\116\002"
	"\337\036\347\335\271\247\321\166\372\134\325\165\102\350\114\313"
	"\077\146\262\377\142\124\253\046\243\145\140\041\167\274\324\351"
	"\271\014\211\324\370\343\357\314\276\156\103\000\240\261\140\224"
	"\043\201\022\314\273\075\155\213\275\255\137\002\217\172\246\364"
	"\332\303\352\277\257\337\231\372\165\372\075\222\170\323\232\121"
	"\144\273\217\151\161\005\270\060\217\307\111\103\216\037\065\316"
	"\023\161\034\240\374\325\171\210\041\014\102\353\224\074\274\216"
	"\300\274\227\230\213\367\310\245\113\202\276\021\211\125\074\210"
	"\255\250\120\000\224\331\322\115\024\135\324\114\213\307\235\073"
	"\107\343\177\342\270\346\200\110\307\037\345\347\357\133\221\014"
	"\375\056\136\265\335\211\253\233\300\355\300\076\340\016\121\051"
	"\343\154\130\115\112\335\301\071\074\325\023\110\120\154\100\013"
	"\104\220\242\017\251\126\245\275\070\127\353\223\007\106\146\053"
	"\146\345\244\261\156\042\272\352\007\235\373\254\204\102\165\131"
	"\253\321\105\242\217\026\025\257\237\033\140\066\341\225\150\110"
	"\312\027\126\371\331\317\352\315\110\065\252\254\052\332\333\023"
	"\354\043\256\157\334\071\373\320\330\111\246\034\240\030\344\220"
	"\173\331\055\307\205\175\147\240\344\167\277\365\007\035\353\054"
	"\116\366\215\363\072\334\102\331\212\236\063\363\021\242\252\324"
	"\162\223\161\376\352\033\270\072\343\154\137\312\043\177\235\213"
	"\017\144\162\137\163\366\117\272\007\123\135\000\332\154\150\320"
	"\233\303\220\045\210\302\305\305\217\337\040\206\042\015\075\251"
	"\131\252\230\271\170\033\352\167\053\043\362\044\311\065\022\114"
	"\174\117\371\270\001\270\343\220\174\266\353\170\170\014\273\114"
	"\237\172\206\375\265\252\151\135\240\313\160\202\236\342\123\063"
	"\233\205\103\224\351\262\316\036\122\002\003\151\244\215\327\007"
	"\142\263\031\064\112\207\103\004\050\122\070\244\110\325\353\251"
	"\025\133\330\054\263\163\030\115\043\114\341\350\332\160\221\150"
	"\033\246\326\335\156\044\217\310\152\210\015\333\122\257\353\043"
	"\211\346\163\325\274\370\336\240\335\027\052\067\345\245\023\047"
	"\215\223\061\225\015\242\224\116\140\274\001\326\020\235\201\067"
	"\165\154\306\211\333\044\352\124\054\156\276\174\251\210\140\210"
	"\372\012\276\140\302\022\100\306\166\343\101\114\204\337\331\206"
	"\046\243\016\047\161\135\310\142\351\027\150\332\266\133\161\347"
	"\042\236\312\301\312\306\345\154\261\211\212\251\377\147\226\310"
	"\235\207\345\207\006\275\041\253\222\277\046\153\363\372\224\263"
	"\150\257\212\023\112\037\235\350\117\265\014\120\030\165\003\170"
	"\147\077\214\246\220\265\331\304\324\350\077\266\324\341\147\076"
	"\375\272\262\367\171\234\341\103\377\066\327\267\161\316\057\165"
	"\124\207\163\077\203\240\165\037\122\231\127\024\203\162\267\057"
	"\337\041\011\037\350\346\112\335\110\032\142\355\362\101\325\140"
	"\226\213\070\074\104\216\104\103\254\056\246\076\001\237\203\044"
	"\165\055\257\156\347\056\254\033\323\201\206\036\021\035\020\216"
	"\232\257\110\333\263\004\034\040\163\130\111\164\321\256\004\017"
	"\130\226\024\050\141\053\072\124\330\145\146\163\207\144\216\116"
	"\063\026\053\163\264\371\112\133\010\072\071\332\002\230\347\070"
	"\076\002\265\066\072\027\340\325\217\271\237\041\112\104\114\110"
	"\166\076\277\163\312\006\161\055\260\002\203\040\046\375\304\142"
	"\305\134\365\031\364\042\213\335\022\005\031\062\303\245\255\141"
	"\343\155\325\256\163\106\334\044\110\137\105\157\135\011\321\043"
	"\146\307\075\133\352\310\071\374\315\123\057\221\371\335\362\335"
	"\112\307\213\276\016\150\343\126\310\050\305\045\062\227\111\230"
	"\137\206\364\111\117\055\106\035\201\166\256\172\123\241\127\235"
	"\151\343\134\167\113\077\315\023\147\223\071\232\052\202\062\211"
	"\011\047\322\130\125\031\165\326\217\043\120\342\304\250\200\055"
	"\213\334\244\326\034\162\352\204\005\044\036\057\246\121\271\257"
	"\170\214\007\315\245\175\244\064\240\364\027\144\234\227\222\050"
	"\164\067\377\221\251\351\025\257\015\064\337\264\205\230\144\376"
	"\044\154\314\312\351\160\376\211\145\025\356\002\255\201\052\041"
	"\270\052\263\142\024\310\021\041\374\360\326\202\211\072\201\256"
	"\246\115\170\220\276\166\031\043\214\010\046\071\211\121\133\102"
	"\173\016\244\217\327\266\261\324\247\207\127\060\302\330\336\151"
	"\045\126\371\344\315\023\010\132\034\056\223\245\200\357\350\374"
	"\376\214\213\325\102\075\252\351\305\001\032\210\331\371\361\377"
	"\117\353\343\035\376\354\167\033\033\013\300\233\372\250\227\371"
	"\065\043\317\170\141\171\141\046\173\174\256\124\165\240\124\305"
	"\213\070\342\212\044\132\245\077\145\146\333\140\017\163\132\104"
	"\226\051\274\370\243\036\036\036\233\315\162\020\156\307\325\371"
	"\377\270\204\044\023\051\144\170\220\077\331\237\262\064\344\111"
	"\135\241\101"
#define      msg1_z	65
#define      msg1	((&data[5787]))
	"\036\133\056\221\154\234\131\101\226\130\372\032\275\137\235\305"
	"\216\144\205\350\164\103\154\067\353\355\261\334\111\046\164\077"
	"\235\077\021\071\250\120\230\212\212\362\340\035\311\345\336\304"
	"\057\336\064\053\011\251\364\023\035\250\116\104\124\224\375\311"
	"\211\207\312\060\354\273\344\355\073\014\324\372\116\175\015\104"
	"\341\206\324"
#define      date_z	1
#define      date	((&data[5858]))
	"\144"
#define      shll_z	10
#define      shll	((&data[5860]))
	"\035\127\043\221\323\074\324\111\013\302\054\362"
#define      inlo_z	3
#define      inlo	((&data[5871]))
	"\172\336\276"
#define      rlax_z	1
#define      rlax	((&data[5874]))
	"\057"
#define      xecc_z	15
#define      xecc	((&data[5878]))
	"\201\212\374\050\205\056\042\142\376\100\033\341\213\072\125\042"
	"\014\214\303\040"
#define      chk1_z	22
#define      chk1	((&data[5899]))
	"\322\314\177\264\151\036\342\213\344\131\371\262\244\205\160\174"
	"\346\237\046\351\354\302\011\317\036\324\123"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
