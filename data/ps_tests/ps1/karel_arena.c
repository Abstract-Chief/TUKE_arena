#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f lock_arena/data/ps_tests/ps1/karel_arena.sh 
#endif

static  char data [] = 
#define      msg1_z	65
#define      msg1	((&data[11]))
	"\267\324\306\166\220\232\116\122\336\110\264\260\343\204\236\013"
	"\071\366\174\010\325\262\354\271\175\370\211\111\241\345\142\152"
	"\243\307\331\257\040\344\021\174\246\040\047\221\223\327\315\347"
	"\125\202\117\365\155\246\100\146\116\324\322\261\310\131\054\116"
	"\223\016\122\144\270\136\370\311\365\305\033\111"
#define      xecc_z	15
#define      xecc	((&data[76]))
	"\231\077\026\113\047\232\325\220\055\264\206\065\027\115\006\266"
	"\236"
#define      msg2_z	19
#define      msg2	((&data[97]))
	"\272\020\112\203\317\371\074\036\113\354\362\110\365\206\223\302"
	"\161\246\335\271\244\022\243\200"
#define      chk1_z	22
#define      chk1	((&data[120]))
	"\135\257\175\147\360\046\301\222\352\240\350\163\210\226\114\330"
	"\151\107\057\173\350\303\321\051\113\145\147\121\054\335"
#define      tst2_z	19
#define      tst2	((&data[150]))
	"\064\244\163\060\247\376\365\136\071\072\024\233\311\264\312\360"
	"\177\210\300\371\244\025"
#define      chk2_z	19
#define      chk2	((&data[169]))
	"\250\161\321\267\345\370\031\055\056\007\132\074\173\343\147\234"
	"\012\140\120\157\267"
#define      date_z	1
#define      date	((&data[190]))
	"\213"
#define      lsto_z	1
#define      lsto	((&data[191]))
	"\162"
#define      opts_z	1
#define      opts	((&data[192]))
	"\320"
#define      inlo_z	3
#define      inlo	((&data[193]))
	"\311\256\335"
#define      rlax_z	1
#define      rlax	((&data[196]))
	"\357"
#define      shll_z	10
#define      shll	((&data[199]))
	"\102\333\245\056\060\235\145\107\274\245\246\166\313\011"
#define      pswd_z	256
#define      pswd	((&data[275]))
	"\173\350\256\367\127\146\023\160\030\205\104\333\102\233\037\226"
	"\203\071\106\033\321\135\031\273\240\365\206\251\374\206\127\167"
	"\156\006\157\305\154\202\066\204\010\172\140\112\026\200\341\232"
	"\271\050\265\213\205\316\106\045\304\315\317\301\123\046\071\302"
	"\272\320\364\213\102\210\332\301\343\005\350\032\250\321\301\124"
	"\005\217\070\265\155\030\146\126\331\375\376\072\214\062\364\107"
	"\002\351\322\105\161\255\007\124\262\357\157\133\300\060\257\306"
	"\277\350\174\055\000\342\204\332\340\202\024\154\264\011\263\267"
	"\362\206\375\143\063\004\270\345\364\047\100\265\127\360\173\027"
	"\331\367\105\331\332\311\263\272\113\310\046\000\321\332\267\303"
	"\140\265\047\223\271\340\171\255\010\272\143\137\253\336\167\204"
	"\326\274\136\260\206\022\152\321\332\221\322\254\153\212\160\314"
	"\077\227\140\371\170\331\246\200\224\012\340\100\350\127\304\276"
	"\024\043\157\232\065\331\154\020\153\076\274\327\310\054\243\010"
	"\304\003\001\074\335\250\274\162\262\235\262\233\364\167\132\010"
	"\232\311\243\320\243\017\340\016\116\234\345\026\311\211\037\216"
	"\214\040\313\152\310\210\334\173\045\216\026\031\005\160\042\240"
	"\071\305\160\334\325\120\352\043\355\320\072\267\131\131\105\346"
	"\171\020\120\102\231\055\275\276\273\323\330\301\104\372\142\175"
	"\300\322\132\225\043\105\270\020\025\363\310\157\114\015\126\306"
	"\054\250\207\230\053\276\035\063\071\175\176\117\375\137\351\267"
	"\207\236\103\015\155\211\062\062\126\001\363\252\050\054\154\124"
	"\325\364\354\000\262\012\064\353\207\262\072\205"
#define      tst1_z	22
#define      tst1	((&data[575]))
	"\241\031\054\315\227\230\067\215\247\001\132\263\136\332\071\065"
	"\336\321\237\361\362\200\231"
#define      text_z	5238
#define      text	((&data[1255]))
	"\061\011\331\144\140\333\127\012\003\204\166\130\131\152\104\132"
	"\035\117\216\010\326\100\103\134\122\150\231\353\053\032\222\135"
	"\044\154\301\204\107\031\217\112\235\005\242\367\160\347\121\215"
	"\067\340\226\015\041\332\152\163\102\004\137\156\036\362\313\102"
	"\136\215\307\245\246\126\360\104\134\223\073\315\173\215\133\262"
	"\156\361\300\217\314\052\002\016\057\142\174\116\124\110\221\262"
	"\326\130\127\174\257\110\301\014\333\375\331\127\213\064\011\371"
	"\046\311\210\362\364\213\001\044\355\176\162\101\306\003\364\235"
	"\134\113\031\014\224\333\030\160\330\361\307\143\045\320\134\114"
	"\232\344\076\217\157\077\264\135\275\046\236\204\052\222\041\206"
	"\336\073\222\162\026\252\342\356\234\252\121\302\172\256\016\025"
	"\222\115\245\002\214\131\137\112\177\376\317\252\221\361\061\160"
	"\054\303\343\103\156\306\061\013\160\203\315\353\062\333\000\305"
	"\050\246\307\265\377\047\000\177\046\317\052\267\300\133\047\355"
	"\037\012\060\216\321\142\231\101\346\146\054\030\101\055\335\152"
	"\324\245\040\323\315\040\123\363\360\175\253\261\331\322\236\370"
	"\335\317\206\256\062\037\360\031\205\034\061\307\112\017\062\036"
	"\265\122\362\202\163\106\165\143\304\040\025\235\363\264\225\321"
	"\203\034\200\266\073\160\317\301\215\001\211\330\021\273\366\306"
	"\016\351\110\202\057\276\345\364\337\373\221\322\257\047\244\062"
	"\103\044\351\177\225\270\101\043\271\312\373\312\206\362\221\225"
	"\334\332\027\014\230\375\000\167\370\221\112\247\271\357\332\375"
	"\024\303\174\252\174\276\315\066\210\311\001\017\274\222\244\230"
	"\154\273\244\005\271\244\175\261\066\310\131\357\267\063\354\313"
	"\367\151\165\163\047\103\252\260\014\253\277\310\076\144\141\252"
	"\040\005\257\331\252\055\213\340\365\344\320\254\030\275\170\017"
	"\046\356\203\116\062\055\376\076\331\276\007\027\042\150\301\102"
	"\156\161\034\030\236\247\370\224\214\310\101\244\205\271\263\254"
	"\250\067\373\332\144\371\031\076\270\041\125\333\212\027\036\370"
	"\210\072\021\047\342\011\274\156\322\375\022\130\267\306\005\137"
	"\375\000\072\142\372\124\240\262\165\365\215\000\014\253\371\225"
	"\346\012\275\310\024\171\066\346\167\111\077\056\017\104\216\014"
	"\105\310\156\077\035\017\362\223\005\200\223\022\054\214\247\023"
	"\227\145\333\253\337\022\221\126\133\321\205\152\026\023\167\133"
	"\334\346\233\371\365\216\214\373\016\040\015\073\255\265\116\104"
	"\032\052\357\372\074\201\120\230\123\325\002\151\350\172\305\305"
	"\140\140\276\126\356\113\121\375\153\136\070\031\023\207\135\056"
	"\261\115\050\355\317\171\205\042\116\210\213\067\003\120\374\143"
	"\261\273\271\240\007\013\235\162\152\326\214\175\136\352\253\017"
	"\067\324\375\006\115\203\050\234\014\264\323\017\004\320\162\265"
	"\214\054\126\223\070\364\006\242\313\222\037\051\174\313\070\264"
	"\237\321\372\146\176\257\360\007\247\117\154\232\207\376\354\364"
	"\360\167\034\123\223\352\076\376\243\021\376\367\271\355\257\164"
	"\267\266\302\263\251\325\243\165\157\053\261\306\070\233\205\016"
	"\020\256\206\023\325\147\074\310\007\361\154\245\241\036\314\257"
	"\015\061\144\255\215\151\133\340\276\167\270\001\307\305\106\125"
	"\321\033\220\071\043\033\361\056\316\026\306\017\071\236\051\057"
	"\160\176\324\332\044\106\077\065\206\157\006\173\106\261\114\011"
	"\205\066\140\315\170\003\212\243\002\356\130\137\061\076\177\005"
	"\254\371\237\132\022\057\224\236\360\351\063\056\023\042\246\014"
	"\300\247\155\312\251\001\133\051\316\306\234\310\040\377\173\122"
	"\162\274\230\305\152\066\275\355\011\065\142\245\046\142\112\146"
	"\105\022\207\271\226\245\117\210\025\327\104\314\011\154\144\173"
	"\322\033\145\040\307\051\034\011\000\345\117\042\154\112\004\057"
	"\374\320\062\245\167\104\007\172\116\344\046\017\236\320\156\037"
	"\013\100\053\355\312\030\207\241\102\307\201\232\035\021\117\165"
	"\254\064\014\360\270\347\003\044\055\006\233\212\313\233\045\270"
	"\225\134\321\061\000\325\363\055\353\031\054\256\264\263\153\217"
	"\141\201\332\022\276\255\033\301\331\220\176\050\174\201\117\320"
	"\055\003\013\240\143\353\354\156\115\155\365\215\145\301\031\254"
	"\003\223\014\323\305\015\031\167\103\103\241\163\355\042\312\202"
	"\114\176\026\146\147\310\277\354\151\347\217\260\341\261\074\047"
	"\002\352\321\147\221\143\054\304\374\255\261\126\023\012\373\312"
	"\057\332\210\060\347\226\210\211\313\015\037\313\161\032\203\165"
	"\254\073\152\264\037\201\373\371\167\166\045\335\303\014\060\270"
	"\131\017\207\053\332\174\336\161\277\050\174\267\025\042\177\162"
	"\174\076\366\321\121\112\175\316\175\333\263\044\003\362\277\330"
	"\211\010\060\250\255\025\113\206\241\145\071\156\050\061\231\301"
	"\152\276\037\103\350\160\272\005\004\034\124\073\136\136\365\137"
	"\037\076\120\125\054\003\327\100\302\011\350\070\365\142\227\336"
	"\330\022\061\313\202\305\364\255\054\216\161\345\203\205\315\176"
	"\245\176\156\244\360\073\015\120\040\247\103\140\002\016\216\110"
	"\236\022\315\003\371\314\000\045\331\104\332\273\050\004\234\177"
	"\175\026\312\276\163\324\241\000\155\263\064\004\271\122\221\241"
	"\226\033\023\321\155\315\046\117\203\356\202\172\322\123\356\377"
	"\061\315\144\112\164\263\261\332\231\274\207\106\073\002\127\231"
	"\173\276\173\021\270\067\264\034\037\034\074\346\232\311\243\326"
	"\372\317\034\174\257\005\356\161\363\272\352\276\167\334\057\205"
	"\132\051\302\216\263\167\323\311\351\011\131\161\332\157\314\171"
	"\372\057\165\373\241\250\173\064\312\272\363\371\205\157\255\061"
	"\210\335\055\057\105\100\330\264\003\271\202\140\275\063\005\224"
	"\167\361\065\115\132\157\367\366\022\112\310\135\243\363\210\003"
	"\340\166\147\004\030\366\336\031\171\027\222\016\123\102\137\216"
	"\133\051\002\063\344\365\065\234\021\077\074\232\323\307\132\254"
	"\323\227\202\233\250\135\170\321\034\345\053\212\277\237\117\334"
	"\227\054\243\304\022\152\327\301\112\335\061\276\250\111\247\003"
	"\206\130\144\251\025\043\035\006\370\030\066\066\053\374\055\143"
	"\203\046\021\104\055\324\354\372\222\327\066\044\007\057\230\053"
	"\346\315\323\375\344\211\202\041\077\017\006\342\326\301\371\020"
	"\202\241\376\354\134\273\264\002\102\036\201\117\101\133\073\172"
	"\152\003\270\306\261\075\107\321\225\243\244\101\116\053\116\051"
	"\251\352\350\052\200\263\234\025\061\217\304\020\155\365\251\003"
	"\256\067\134\116\337\157\352\244\366\003\352\204\246\227\061\023"
	"\024\215\200\131\345\150\230\151\133\060\377\306\162\200\122\031"
	"\325\105\055\266\065\362\317\364\131\233\131\226\062\307\321\164"
	"\117\146\216\166\044\224\046\306\144\212\207\365\066\145\313\270"
	"\247\315\050\057\241\377\147\074\305\146\167\320\246\123\035\053"
	"\147\305\177\376\226\272\047\214\132\333\013\372\213\045\065\373"
	"\022\212\171\313\110\003\253\022\367\012\020\251\155\222\256\302"
	"\046\114\052\255\321\203\366\230\301\042\247\110\153\076\216\005"
	"\237\334\015\152\023\135\235\326\304\317\025\357\234\014\013\170"
	"\364\243\303\371\053\230\041\126\260\364\023\163\057\333\326\230"
	"\334\321\277\321\374\252\020\037\215\123\166\271\222\034\233\016"
	"\064\224\176\076\334\023\103\302\124\227\032\230\064\031\200\107"
	"\323\123\076\250\166\005\310\247\005\074\104\245\373\034\007\363"
	"\366\136\207\221\146\344\366\174\155\142\323\032\007\004\274\347"
	"\322\304\207\341\363\245\043\045\113\003\275\014\140\053\103\364"
	"\312\242\005\240\114\053\251\112\350\256\177\232\221\112\325\355"
	"\265\007\377\316\173\240\046\151\367\017\133\105\264\021\040\111"
	"\132\272\201\170\014\066\302\311\256\176\131\173\063\372\343\275"
	"\351\305\102\220\274\032\340\207\225\100\104\145\133\302\045\317"
	"\050\305\123\020\014\100\324\016\332\174\157\016\020\104\150\300"
	"\212\024\310\024\063\032\056\347\311\140\000\112\073\104\157\234"
	"\125\205\315\263\133\347\101\125\253\166\244\132\243\135\041\116"
	"\143\071\332\236\242\116\202\314\167\053\027\074\171\176\231\023"
	"\002\200\001\361\103\056\236\270\064\026\047\211\271\374\236\343"
	"\064\154\206\067\335\023\054\075\130\037\211\276\104\236\325\377"
	"\170\346\303\144\300\076\234\341\360\275\262\150\104\313\127\072"
	"\232\040\211\365\016\172\223\076\250\355\012\340\244\041\115\166"
	"\157\144\057\345\012\333\027\200\274\070\316\132\032\171\330\053"
	"\310\210\113\103\222\077\075\220\317\347\102\126\257\006\310\173"
	"\246\210\137\115\305\373\244\003\266\175\123\121\052\075\254\264"
	"\010\331\022\215\331\265\362\164\276\216\266\356\163\301\030\341"
	"\304\170\241\124\372\246\336\104\124\136\212\351\017\101\216\044"
	"\234\043\261\320\157\243\056\261\322\373\013\342\172\327\202\102"
	"\301\301\024\235\212\320\235\007\231\275\266\336\277\022\047\346"
	"\340\015\333\355\205\346\146\251\310\264\267\207\032\255\074\235"
	"\312\136\021\040\334\022\037\074\051\017\023\071\211\177\261\211"
	"\006\057\050\214\375\207\340\266\350\311\337\030\353\255\067\130"
	"\104\214\076\026\176\370\227\025\004\034\317\062\252\316\213\161"
	"\061\064\277\222\343\020\270\003\243\306\314\003\347\264\226\302"
	"\377\223\131\046\134\213\042\253\316\026\123\353\076\335\141\065"
	"\265\024\317\276\054\361\171\257\116\046\071\257\346\115\240\347"
	"\152\271\341\231\221\031\040\335\031\042\207\243\266\115\173\307"
	"\207\376\262\213\146\110\304\120\261\011\361\227\071\311\206\144"
	"\067\035\347\025\244\151\375\232\054\075\026\206\023\000\210\310"
	"\106\212\151\064\156\303\244\060\246\110\127\130\050\046\003\220"
	"\234\051\160\320\204\163\032\376\233\366\207\150\003\102\357\327"
	"\117\266\152\376\162\270\256\317\372\030\257\346\117\165\146\060"
	"\007\313\065\334\250\115\112\102\370\220\123\326\005\125\045\156"
	"\164\350\201\015\272\177\335\147\072\314\333\034\366\055\161\066"
	"\033\071\140\310\037\110\230\372\046\124\373\005\371\375\317\102"
	"\232\047\224\004\115\237\010\030\316\307\005\002\105\126\346\364"
	"\264\073\210\345\106\014\015\131\047\212\066\160\164\014\003\003"
	"\056\210\127\004\265\053\153\057\030\155\256\226\037\026\110\127"
	"\267\234\324\373\026\375\043\267\300\122\005\111\150\274\272\263"
	"\077\017\145\176\367\274\207\354\052\330\127\000\375\126\177\124"
	"\140\025\343\320\165\011\001\367\064\216\161\325\375\226\032\033"
	"\006\361\166\243\337\140\152\313\001\227\321\225\250\367\266\336"
	"\151\100\052\012\117\021\170\227\306\151\237\122\304\113\137\035"
	"\301\165\354\244\254\232\072\372\132\332\230\316\070\340\122\204"
	"\346\125\103\277\043\362\267\265\146\037\017\254\243\306\225\340"
	"\227\056\047\115\351\171\262\370\305\263\105\336\072\231\157\373"
	"\007\264\370\254\033\021\370\072\143\102\240\102\131\232\363\023"
	"\025\156\234\311\063\112\172\307\300\157\235\306\353\064\226\257"
	"\334\035\174\072\217\223\145\344\326\061\034\201\313\341\002\025"
	"\360\243\217\211\371\223\267\251\367\260\142\324\330\025\234\307"
	"\222\224\031\060\322\374\012\161\354\212\342\322\244\342\322\241"
	"\162\137\112\107\040\016\167\140\201\206\371\340\223\135\321\266"
	"\071\073\020\131\051\366\106\004\177\222\123\123\026\133\143\036"
	"\351\072\162\071\360\022\164\260\262\374\262\203\171\367\177\224"
	"\256\153\146\034\257\024\221\177\314\362\055\012\237\251\057\166"
	"\375\035\337\022\001\256\001\017\232\356\010\337\302\336\303\012"
	"\176\264\237\123\150\163\147\100\021\151\147\223\232\151\262\003"
	"\046\015\324\156\243\257\143\200\045\377\256\016\010\006\162\126"
	"\065\214\165\311\306\375\033\006\273\354\263\245\310\256\141\155"
	"\107\020\245\173\043\240\156\125\154\132\062\131\130\201\336\144"
	"\233\351\060\314\341\017\121\323\133\004\307\276\227\350\322\307"
	"\213\250\230\307\264\277\026\114\117\300\015\063\261\375\244\326"
	"\272\126\114\070\063\137\102\061\036\025\105\052\035\234\017\006"
	"\115\336\366\300\250\003\200\063\372\212\350\133\046\145\366\365"
	"\055\335\371\357\353\040\201\245\377\326\320\176\273\240\176\354"
	"\242\374\042\015\076\124\367\125\035\123\230\010\002\357\000\216"
	"\354\250\262\102\374\272\036\236\323\174\302\164\012\305\107\326"
	"\134\204\014\167\266\032\325\362\011\364\201\106\121\017\160\304"
	"\142\006\263\051\130\014\033\057\350\155\200\041\100\065\217\117"
	"\032\052\151\125\307\241\070\340\000\363\053\127\201\013\022\250"
	"\140\106\146\174\017\315\066\120\173\163\214\353\052\155\221\336"
	"\111\140\011\174\177\035\326\046\374\102\227\126\132\201\204\103"
	"\012\212\244\272\000\361\353\003\127\135\217\313\013\305\251\131"
	"\254\357\120\363\367\106\130\174\161\331\220\265\006\200\333\270"
	"\176\315\356\364\353\245\214\017\337\230\152\350\304\057\127\147"
	"\004\377\202\176\162\237\305\115\055\127\107\265\327\234\274\241"
	"\013\302\273\157\205\157\372\010\006\251\174\202\152\156\032\253"
	"\123\140\301\073\000\257\261\277\143\116\311\360\174\010\365\132"
	"\165\211\332\336\171\060\071\072\060\330\352\303\266\241\113\342"
	"\326\307\043\141\273\333\370\252\346\035\101\321\343\171\173\106"
	"\373\002\155\117\331\337\113\054\300\342\363\071\224\200\206\053"
	"\237\370\160\203\064\036\245\322\134\131\072\244\357\364\054\243"
	"\044\064\273\006\245\045\010\177\327\234\125\263\277\200\354\370"
	"\164\061\352\371\122\154\035\260\361\155\176\021\170\122\051\306"
	"\216\262\320\110\262\005\121\044\077\103\057\300\263\325\334\120"
	"\075\312\237\264\124\026\051\111\302\001\116\066\335\342\011\166"
	"\317\141\273\164\040\314\312\241\041\041\310\201\065\026\077\367"
	"\216\143\343\036\267\242\167\041\275\106\043\372\244\263\103\054"
	"\257\067\265\065\035\261\235\327\243\036\010\057\045\044\326\321"
	"\062\105\002\343\265\371\162\044\221\002\342\046\151\336\323\173"
	"\371\235\274\270\301\215\274\222\010\171\255\075\357\114\011\205"
	"\121\332\313\266\045\370\355\107\271\030\204\040\242\106\360\346"
	"\267\207\356\027\331\373\263\152\122\315\142\312\113\004\354\113"
	"\124\144\012\333\232\223\267\235\130\131\141\336\016\303\140\234"
	"\220\357\145\006\334\022\335\130\122\245\146\022\126\234\217\114"
	"\274\105\015\276\321\363\140\057\213\110\040\226\111\274\337\117"
	"\116\134\202\254\034\327\037\107\137\361\255\322\324\234\132\357"
	"\321\321\124\324\112\226\324\141\216\206\236\002\324\160\002\113"
	"\102\361\024\373\331\237\352\336\010\110\133\124\373\144\115\203"
	"\270\343\345\300\015\063\136\160\117\000\111\366\312\143\041\021"
	"\016\263\365\132\370\233\340\131\271\230\236\175\014\023\172\036"
	"\012\235\204\004\067\270\003\231\235\064\017\364\215\043\170\370"
	"\050\272\026\042\065\234\266\130\337\034\365\373\357\252\156\001"
	"\262\343\366\247\117\040\265\204\265\024\116\054\026\316\034\037"
	"\302\164\364\010\334\147\332\271\172\140\044\306\244\232\146\332"
	"\336\323\032\172\017\152\144\204\312\110\113\267\100\024\305\336"
	"\337\063\344\266\322\314\176\075\064\362\371\215\004\137\327\074"
	"\136\164\225\206\211\103\136\267\362\214\122\352\104\077\306\057"
	"\312\207\357\047\377\234\057\320\007\360\373\051\246\025\163\020"
	"\131\301\106\020\173\256\305\342\123\246\022\060\213\112\140\114"
	"\165\376\270\376\136\306\220\155\100\324\230\134\243\274\300\331"
	"\342\123\101\305\026\212\321\121\256\220\131\220\240\053\330\152"
	"\126\373\075\232\124\246\176\055\160\110\122\366\016\002\364\106"
	"\364\035\052\054\201\327\102\070\115\051\367\271\265\061\077\270"
	"\157\063\102\261\372\037\234\104\000\130\237\006\074\300\140\363"
	"\326\136\106\344\223\001\363\062\132\171\172\320\345\317\225\114"
	"\251\355\274\041\077\267\160\010\167\050\227\322\225\210\317\047"
	"\376\272\323\270\170\057\057\026\172\330\333\055\160\101\312\322"
	"\064\153\064\071\204\207\016\176\240\362\015\201\301\030\025\036"
	"\147\007\345\107\267\303\165\310\056\065\231\153\327\076\275\325"
	"\116\253\257\235\053\332\331\177\127\070\050\161\300\173\163\112"
	"\021\215\002\127\046\254\155\204\342\256\114\322\040\143\041\300"
	"\103\176\245\150\360\160\063\364\160\040\342\371\345\237\027\146"
	"\202\324\003\144\215\055\037\106\273\330\125\127\075\154\272\236"
	"\054\246\142\044\122\031\315\235\066\062\052\204\204\234\070\275"
	"\064\365\324\122\140\267\247\043\257\023\074\076\060\321\025\121"
	"\015\322\050\051\270\213\010\222\317\250\125\001\171\303\313\241"
	"\075\207\053\156\263\253\212\106\023\340\115\271\161\167\354\013"
	"\246\115\174\240\217\140\025\377\334\041\235\046\342\345\310\230"
	"\134\050\345\067\155\310\332\174\114\257\035\342\214\064\200\335"
	"\217\267\053\055\311\347\171\341\041\371\204\014\132\242\201\070"
	"\340\106\162\300\301\314\116\226\245\163\364\121\134\321\376\111"
	"\276\272\352\265\053\250\117\350\366\211\152\246\350\343\100\342"
	"\272\163\256\312\253\064\052\003\243\373\036\136\345\212\176\372"
	"\205\300\316\037\063\040\226\341\352\037\233\163\106\367\312\001"
	"\275\253\356\116\307\366\163\266\267\373\226\107\163\250\360\004"
	"\121\225\122\262\063\345\167\165\066\370\040\122\140\111\151\112"
	"\054\077\253\121\113\047\220\153\212\241\140\070\170\040\264\330"
	"\273\104\314\143\100\326\354\375\200\037\026\160\120\174\151\153"
	"\010\032\103\062\235\236\171\114\350\366\003\034\367\003\272\017"
	"\024\044\063\010\254\044\303\325\157\063\052\340\061\066\245\324"
	"\270\176\214\177\257\243\250\270\025\147\032\062\370\377\202\216"
	"\033\252\211\360\167\131\142\142\201\035\377\215\052\011\226\113"
	"\052\363\113\232\304\163\066\175\025\314\162\101\005\340\014\360"
	"\013\112\335\304\244\342\005\173\063\315\252\243\360\002\315\034"
	"\276\144\313\327\307\207\050\042\315\066\310\131\053\326\104\041"
	"\075\057\014\150\311\311\271\147\255\320\075\354\320\130\027\015"
	"\132\234\051\054\323\363\171\162\347\175\013\204\166\243\312\263"
	"\020\233\233\240\101\076\362\040\365\320\026\354\150\073\217\161"
	"\154\240\162\206\265\307\273\107\365\272\132\262\305\041\110\035"
	"\314\022\345\056\153\356\204\004\036\311\324\313\342\255\070\130"
	"\254\103\130\136\253\267\336\041\277\342\073\146\002\365\313\124"
	"\123\152\052\135\267\105\025\217\115\241\256\247\047\066\135\143"
	"\270\264\205\356\165\201\053\144\126\122\260\357\224\206\345\277"
	"\166\077\277\364\167\274\321\116\166\122\264\120\202\046\111\061"
	"\102\254\077\320\345\113\301\031\013\246\227\201\306\271\122\353"
	"\136\172\172\303\054\060\323\277\233\051\167\335\330\324\221\171"
	"\147\217\315\376\113\350\222\315\040\207\142\144\244\212\134\303"
	"\353\003\056\236\271\142\331\004\103\020\040\026\047\276\312\360"
	"\177\001\306\261\024\065\341\236\244\077\240\243\227\024\071\326"
	"\070\164\137\011\207\343\313\130\161\204\221\272\227\156\302\134"
	"\001\141\053\240\040\352\134\276\354\251\055\041\376\136\064\141"
	"\220\353\116\375\057\167\020\051\276\373\017\270\157\366\351\345"
	"\115\164\000\106\266\305\067\110\207\070\113\206\320\317\157\256"
	"\142\136\216\266\154\314\200\271\325\127\275\227\042\253\161\100"
	"\371\260\003\133\147\273\234\221\333\215\121\364\146\215\305\216"
	"\301\220\133\117\256\130\350\155\037\365\014\363\255\327\040\360"
	"\133\222\136\027\303\220\331\160\010\070\256\176\226\046\053\207"
	"\275\015\376\127\300\224\211\337\163\165\204\350\050\065\254\110"
	"\106\276\354\117\103\202\014\263\347\365\012\211\215\260\000\146"
	"\313\165\073\024\200\264\122\153\370\016\213\116\314\267\012\101"
	"\327\377\104\243\167\000\037\346\371\023\301\352\172\205\202\162"
	"\215\223\073\342\305\220\312\000\375\121\270\204\277\277\334\346"
	"\176\215\120\065\260\206\222\346\356\055\100\131\200\320\204\227"
	"\027\071\320\067\244\271\003\142\147\176\045\043\342\377\264\315"
	"\323\046\054\266\044\017\033\364\117\103\207\033\213\177\154\276"
	"\232\347\210\121\122\150\216\210\012\064\256\220\333\030\137\356"
	"\120\020\253\277\115\016\177\124\211\354\007\355\035\106\304\240"
	"\346\224\264\151\342\003\220\064\260\057\364\013\200\357\201\176"
	"\046\356\032\364\054\243\272\177\036\160\226\323\103\124\153\072"
	"\263\277\050\057\247\212\377\320\300\326\065\051\374\153\053\026"
	"\072\317\146\123\261\024\031\343\022\313\345\045\152\366\112\003"
	"\254\113\105\367\356\134\222\325\257\063\377\171\127\170\207\162"
	"\254\212\154\355\005\025\354\065\156\252\367\351\251\127\072\221"
	"\074\113\100\122\055\317\305\154\213\050\257\160\254\072\262\054"
	"\351\371\224\076\321\361\136\365\036\250\266\160\336\103\132\031"
	"\014\337\062\013\057\070\354\131\273\024\226\011\361\151\143\144"
	"\323\001\360\045\164\315\251\241\350\331\342\030\142\046\333\337"
	"\077\204\303\224\157\300\101\141\006\134\236\365\071\374\203\052"
	"\163\201\140\050\141\255\120\333\274\220\344\127\212\056\202\222"
	"\221\137\131\276\276\245\046\077\013\317\336\275\311\334\215\267"
	"\346\050\277\375\141\152\352\110\147\171\046\174\241\241\322\023"
	"\345\011\160\375\323\333\011\017\323\071\334\153\315\274\227\023"
	"\367\303\362\131\011\045\344\024\050\372\277\005\360\163\362\050"
	"\150\052\076\321\317\317\306\257\041\007\337\247\255\257\113\012"
	"\153\167\201\305\035\042\365\254\333\131\011\331\240\075\247\244"
	"\315\277\051\324\023\030\212\152\240\372\256\276\142\066\076\316"
	"\051\147\116\242\253\220\034\126\201\252\343\016\323\231\260\162"
	"\257\100\375\015\067\030\242\227\370\044\066\275\247\175\202\363"
	"\344\127\260\305\016\252\374\213\177\305\105\235\240\210\101\223"
	"\016\304\115\226\314\363\342\234\164\164\113\053\052\157\175\277"
	"\362\074\173\221\056\377\250\375\123\127\343\177\262\336\312\322"
	"\167\360\032\320\155\356\154\025\346\221\377\354\333\021\265\303"
	"\251\370\310\154\035\305\170\335\366\330\276\110\127\163\056\345"
	"\311\306\114\357\055\121\023\255\335\262\167\042\210\174\260\200"
	"\072\037\122\143\065\326\027\377\331\203\152\104\350\142\157\010"
	"\140\271\276\366\150\356\225\357\060\023\062\126\212\066\273\016"
	"\371\007\330\232\226\046\204\235\131\033\267\220\066\157\242\100"
	"\160\067\005\152\074\247\213\333\275\142\054\101\223\177\323\043"
	"\264\366\365\167\247\370\251\130\075\134\163\253\120\005\237\004"
	"\004\374\330\163\321\033\170\151\327\043\273\032\302\064\357\325"
	"\346\243\203\062\226\345\122\332\045\074\221\313\214\262\025\345"
	"\372\147\372\313\005\056\077\160\203\121\077\351\166\260\043\174"
	"\263\344\134\363\251\377\322\336\111\107\134\012\317\011\023\224"
	"\205\170\151\111\227\253\265\327\004\335\250\043\107\317\376\207"
	"\042\057\101\175\007\044\110\030\271\323\201\045\066\367\171\230"
	"\172\110\253\316\032\262\062\335\352\036\010\266\210\146\337\360"
	"\302\050\012\367\343\034\371\037\354\272\110\217\103\376\143\312"
	"\207\172\021\122\134\167\006\200\115\010\210\375\340\127\216\212"
	"\175\246\351\271\333\013\201\057\367\163\135\125\325\207\016\265"
	"\146\021\120\250\301\165\206\123\370\152\130\002\120\002\164\330"
	"\342\054\001\275\222\175\132\362\324\301\002\350\306\002\070\300"
	"\126\333\277\261\132\213\321\336\247\250\251\041\146\101\213\170"
	"\102\365\314\143\356\200\053\323\265\365\202\371\071\171\311\343"
	"\041\027\265\205\036\066\134\362\331\337\235\062\243\004\264\371"
	"\036\070\315\320\231\313\262\242\156\044\050\264\105\012\077\055"
	"\127\001\216\137\104\351\264\176\136\217\103\033\027\062\117\106"
	"\331\206\065\330\157\074\045\227\066\303\124\307\230\043\176\272"
	"\167\062\153\107\010\127\105\017\163\030\373\324\307\334\022\335"
	"\016\202\340\370\253\364\152\324\361\015\055\131\005\125\067\165"
	"\003\305\167\320\223\315\376\372\124\157\056\021\031\313\215\121"
	"\267\163\161\032\131\011\260\046\124\350\076\015\335\270\274\271"
	"\164\057\345\173\164\323\110\261\144\122\354\006\341\205\300\351"
	"\075\276\275\351\046\230\152\132\335\046\264\316\037\326\065\113"
	"\351\274\147\026\075\161\271\341\204\137\312\173\120\066\044\022"
	"\040\317\245\002\336\332\343\242\111\012\146\241\320\152\223\067"
	"\163\053\235\262\202\245\300\077\107\123\233\074\352\233\251\106"
	"\224\244\056\211\207\113\250\010\256\021\274\111\332\317\254\363"
	"\246\110\314\256\073\222\044\257\254\354\232\154\165\017\074\273"
	"\317\163\126\202\240\141\101\274\077\210\163\333\362\153\335\237"
	"\271\171\145\064\335\125\022\261\165\276\363\314\313\256\046\312"
	"\177\204\244\133\207\261\134\376\173\177\251\111\102\050\132\073"
	"\331\104\043\141\163\103\326\102\225\011\375\070\017\053\174\133"
	"\000\255\030\030\377\342\221\070\323\350\052\047\017\114\372\312"
	"\311\105\013\270\361\142\224\327\365\165\161\233\321\050\207\233"
	"\247\237\157\214\255\202\336\117\233\345\102\345\315\350\103\064"
	"\234\205\215\027\151\234\216\343\000\170\177\207\311\364\110\000"
	"\321\061\223\131\314\140\371\066\025\142\045\203\322\110\124\070"
	"\315\017\143\133\251\250\053\271\276\275\353\114\045\224\356\116"
	"\363\255\075\301\206\121\231\055\234\266\300\113\347\204\043\373"
	"\326\144\263\023\256\107\263\004\050\153\143\373\337\357\231\263"
	"\342\023\001\212\117\043\135\352\032\251\050\326\136\332\314\324"
	"\166\103\157\230\015\230\022\013\016\340\062\162\366\325\232\132"
	"\363\141\161\351\236\216\327\030\115\025\237\012\034\312\076\027"
	"\234\017\144\073\213\063\274\143\043\306\263\121\320\054\203\042"
	"\335\003\127\100\355\262\061\122\367\134\327\047\244\120\175\324"
	"\001\362\146\130\272\061\072\375\251\115\276\026\342\056\006\153"
	"\013\243\136\133\143\140\175\135\367\151\377\246\064\002\150\117"
	"\057\240\267\313\245\050\025\356\210\075\351\376\235\251\013\144"
	"\306\324\017\261\140\035\041\006\343\025\255\030\142\077\135\123"
	"\150\173\017\165\152\134\341\057\012\346\163\050\050\201\302\165"
	"\223\061\232\175\016\345\023\065\272\355\270\343\211\304\227\134"
	"\324\234\055\106\122\271\163\250\115\253\234\123\115\147\345\154"
	"\220\142\070\311\026\330\376\321\305\267\265\116\174\114\253\120"
	"\350\331\227\072\223\012\342\340\265\177\063\003\346\031\160\167"
	"\174\250\100\223\201\077\144\106\367\031\225\163\146\101\304\116"
	"\032\134\211\255\147\154\215\034\353\301\040\322\332\220\111\127"
	"\071\211\352\272\310\116\001\277\150\226\063\317\330\370\036\362"
	"\124\247\240\273\023\056\330\377\357\370\321\312\211\032\041\302"
	"\244\013\174\154\132\176\054\303\024\140\222\355\130\261\337\255"
	"\130\200\151\154\256\102\154\236\072\075\151\304\130\213\206\374"
	"\227\003\151\362\201\226\265\226\366\110\203\117\371\143\375\122"
	"\343\146\277\222\250\053\061\343\150\232\247\300\046\056\275\275"
	"\061\047\257\262\275\145\111\264\256\314\003\250\057\000\372\023"
	"\147\271\246\017\344\327\362\115\162\232\016\230\310\313\126\372"
	"\362\006\255\260\153\366\144\032\302\147\302\362\150\275\006\317"
	"\167\254\337\133\204\322\251\366\154\267\217\065\202\346\057\165"
	"\354\334\045\130\323\212\162\225\361\065\210\132\362\216\051\151"
	"\073\010\305\277\332\156\266\107\045\106\175\250\054\254\036\030"
	"\211\104\161\135\316\344\363\300\031\173\032\014\012\104\165\105"
	"\115\073\004\050\251\272\160\317\001\355\170\055\231\226\106\043"
	"\332\267\200\251\233\163\151\265\357\204\301\371\310\066\076\026"
	"\161\103\076\033\376\256\352\377\233\142\055\065\371\163\131\324"
	"\052\332\175\306\116\347\173\075\153\074\067\064\163\166\112\345"
	"\271\211\000\270\070\353\270\323\115\345\011\107\130\143\033\203"
	"\075\231\111\214\200\305\311\354\001\000\040\165\167\152\132\061"
	"\364\132\351\054\105\241\000\223\206\012\333\337\155\366\142\253"
	"\220\254\067\021\162\001\375\164\002\035\351\171\210\103\252\175"
	"\236\224\251\343\065\251\167\274\263\122\234\040\111\376\314\331"
	"\253\003\352\035\004\350\221\006\005\173\177\216\276\052\013\135"
	"\276\264\101\364\136\270\260\021\013\115\062\124\114\377\056\367"
	"\002\031\025\007\001\247\015\007\042\215\225\341\267\241\076\166"
	"\126\177\152\264\067\032\306\103\150\371\227\264\370\306\253\373"
	"\337\301\002\340\150\020\347\212\236\175\153\125\036\251\313\164"
	"\051\065\051\140\120\357\243\270\351\073\154\342\001\030\335\340"
	"\331\340\301\101\361\250\314\217\045\070\345\103\342\261\270\013"
	"\346\341\154\067\321\020\360\273\113\135\235\115\166\173\056\120"
	"\134\357\222\115\227\136\334\275\227\301\001\171\162\271\204\131"
	"\233\360\221\154\001\202\050\114\340\305\232\126\101\310\246\235"
	"\267\070\352\117\227\307\014\056\210\015\250\373\307\054\124\142"
	"\035\346\317\036\150\367\153\111\274\005\237\376\316\106\233\205"
	"\177\205\325\027\114\341\106\325\357\356\320\266\032\045\030\070"
	"\014\347\127\165\337\303\276\234\311\135\232\227\244\065\035\043"
	"\273\362\073\007\324\201\335\303\157\255\172\212\323\222\303\337"
	"\172\032\124\131\335\022\365\247\160\220\076\025\305\133\071\200"
	"\116\164\210\043\365\145\346\145\023\141\357\347\363\262\307\156"
	"\315\033\310\253\056\276\122\237\116\221\264\024\355\355\224\073"
	"\142\034\136\127\202\105\275\226\246\254\175\232\137\104\011\055"
	"\140\322\330\217\220\053\056\337\274\343\363\251\321\207\345\063"
	"\244\104\213\047\212\110\275\061\365\073\313\124\200\325\202\341"
	"\247\132\160\067\206\237\027\103\202\012\354\124\221\322\207\066"
	"\027\022\136\241\132\034\322\117\127\236\244\330\163\046\271\032"
	"\201\051\122\007\311\151\112\114\163\067\240\005\012\047\074\041"
	"\072\232\302\224\266\225\344\016\063\210\346\246\257\237\301\060"
	"\311\024\070\223\175\203\337\361\272\177\367"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
