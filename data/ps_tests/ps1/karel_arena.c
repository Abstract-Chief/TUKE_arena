#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f lock_arena/data/ps_tests/ps1/karel_arena.sh 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\223\376\370"
#define      lsto_z	1
#define      lsto	((&data[3]))
	"\340"
#define      rlax_z	1
#define      rlax	((&data[4]))
	"\031"
#define      tst1_z	22
#define      tst1	((&data[10]))
	"\141\104\133\157\305\115\147\221\227\233\350\026\146\050\175\234"
	"\350\372\001\125\363\142\234\051\057\077\225\222"
#define      xecc_z	15
#define      xecc	((&data[35]))
	"\115\035\204\023\260\031\143\004\061\245\226\037\041\151\223\023"
	"\365\026\026"
#define      opts_z	1
#define      opts	((&data[52]))
	"\317"
#define      chk1_z	22
#define      chk1	((&data[54]))
	"\252\327\370\055\105\124\066\373\261\216\350\321\264\013\250\227"
	"\300\363\306\317\345\112\150\240"
#define      date_z	1
#define      date	((&data[77]))
	"\354"
#define      text_z	5238
#define      text	((&data[1123]))
	"\362\102\162\104\244\267\237\024\174\062\166\025\362\304\063\010"
	"\332\345\363\171\100\053\254\352\314\326\004\062\214\320\265\177"
	"\023\050\303\267\337\143\313\134\226\102\162\210\006\245\220\341"
	"\213\204\133\313\260\007\265\174\335\271\257\152\212\144\351\235"
	"\214\255\125\154\021\041\310\247\143\073\060\152\340\301\113\153"
	"\105\246\067\366\256\354\162\214\246\041\366\061\206\340\316\023"
	"\215\044\177\236\105\110\106\250\203\166\023\144\067\136\320\175"
	"\005\007\163\263\364\346\077\233\010\066\314\216\026\233\241\244"
	"\277\041\103\004\151\211\255\354\000\300\121\067\037\041\265\044"
	"\050\051\330\035\017\030\270\027\116\205\246\144\040\110\011\340"
	"\151\114\344\322\326\222\277\326\122\020\016\162\062\303\226\132"
	"\354\157\170\374\207\060\023\325\265\272\072\326\002\103\266\153"
	"\220\233\076\146\055\376\074\200\017\112\362\101\016\211\234\372"
	"\371\024\366\200\104\012\126\372\304\220\321\307\324\207\063\145"
	"\043\162\313\121\160\010\322\177\122\305\300\140\116\134\133\107"
	"\160\121\310\265\134\036\260\041\257\201\350\204\011\034\351\054"
	"\216\265\175\376\275\117\176\020\024\076\161\143\233\314\253\014"
	"\036\164\302\172\222\163\234\102\364\204\306\375\241\260\052\057"
	"\145\250\056\043\370\254\063\015\353\244\161\207\160\034\224\217"
	"\220\126\011\043\311\245\145\276\052\054\274\313\334\347\373\102"
	"\217\051\145\207\326\230\225\302\075\006\111\256\042\335\075\263"
	"\064\106\327\376\354\075\275\027\151\171\342\106\140\336\210\360"
	"\010\356\170\336\206\015\241\304\023\352\162\065\310\257\351\375"
	"\366\301\374\342\376\271\371\147\062\334\256\223\272\066\203\303"
	"\044\373\241\253\010\103\160\033\055\342\121\366\221\073\364\207"
	"\374\360\152\372\251\144\142\334\100\020\157\373\107\363\277\154"
	"\357\140\030\370\243\210\023\321\153\145\310\374\241\274\204\236"
	"\254\357\230\125\123\373\061\224\014\241\220\124\225\117\301\204"
	"\260\331\174\124\142\220\045\315\366\356\312\227\252\117\065\127"
	"\076\316\254\222\312\336\046\327\200\266\053\025\005\355\231\266"
	"\307\026\012\051\246\060\367\234\036\302\063\311\021\151\040\120"
	"\067\315\342\002\253\010\331\054\277\004\101\305\362\333\173\271"
	"\361\205\342\227\265\332\064\324\234\150\235\255\321\275\375\011"
	"\212\337\013\066\350\344\142\247\351\244\155\333\177\350\224\160"
	"\156\167\010\044\121\074\370\355\244\225\233\166\123\230\177\335"
	"\170\212\024\141\157\167\010\130\033\166\064\233\136\311\013\315"
	"\100\024\361\222\121\352\177\365\200\032\154\323\263\353\261\054"
	"\166\305\215\345\075\226\076\130\014\162\363\153\074\377\070\174"
	"\024\052\016\145\024\216\133\224\251\307\147\134\262\031\211\051"
	"\337\026\016\034\254\115\164\270\300\150\043\374\150\133\171\174"
	"\206\207\342\232\026\075\056\277\005\226\034\270\260\245\341\217"
	"\273\360\253\150\075\040\040\375\210\103\371\361\237\162\156\045"
	"\372\120\300\021\215\357\320\222\206\355\112\066\223\054\305\117"
	"\034\160\267\131\221\327\126\032\033\120\013\273\303\171\341\275"
	"\311\241\317\127\220\237\352\026\215\065\115\040\141\022\160\175"
	"\203\047\326\024\377\055\056\032\176\072\325\101\264\266\377\175"
	"\127\316\325\350\156\277\377\373\364\114\034\125\137\215\322\343"
	"\264\251\367\263\327\046\316\125\141\243\226\025\132\226\223\262"
	"\144\150\232\323\047\232\317\033\347\354\161\107\171\103\052\055"
	"\355\042\341\304\111\257\031\252\122\260\277\255\106\122\137\253"
	"\273\372\176\342\224\115\376\174\071\157\303\262\263\355\340\240"
	"\017\301\144\131\161\175\003\304\056\303\161\164\026\320\037\321"
	"\312\235\264\137\353\262\333\044\041\236\327\324\214\270\165\234"
	"\172\331\365\353\127\371\257\205\274\040\372\323\360\031\244\273"
	"\267\131\032\242\013\365\307\055\224\237\001\040\127\166\275\321"
	"\120\262\275\250\253\154\056\150\215\050\073\175\101\340\071\371"
	"\071\123\233\105\111\143\162\335\002\163\375\132\352\272\053\073"
	"\155\350\343\031\125\022\201\342\072\275\140\174\236\231\165\327"
	"\354\020\034\065\164\216\023\166\002\021\320\355\314\374\051\071"
	"\345\015\122\072\037\324\034\131\222\175\325\060\026\113\010\003"
	"\133\044\071\320\263\114\106\266\135\027\244\052\023\316\143\370"
	"\333\266\063\372\213\120\124\035\315\052\116\344\165\126\350\321"
	"\173\041\241\057\156\350\345\314\377\212\366\023\130\132\013\064"
	"\021\077\057\234\217\203\272\135\256\010\102\044\136\052\365\332"
	"\114\227\011\272\177\357\207\176\171\175\221\322\330\235\006\351"
	"\335\065\206\155\271\241\021\234\312\315\315\106\245\214\075\217"
	"\100\314\036\303\205\133\004\207\120\016\036\337\117\177\317\070"
	"\336\077\365\231\221\106\326\063\355\055\144\253\165\161\336\314"
	"\233\267\026\122\236\076\120\300\225\237\321\164\357\102\271\360"
	"\072\365\112\123\172\104\065\033\057\043\277\111\320\272\044\261"
	"\311\315\110\107\324\024\060\335\176\064\011\024\060\062\134\167"
	"\025\117\270\226\373\351\113\077\173\017\047\111\063\066\224\060"
	"\051\305\167\255\271\301\172\316\117\110\274\030\244\375\002\330"
	"\011\165\035\077\375\231\157\115\366\347\277\112\033\362\355\045"
	"\115\031\046\212\306\314\124\037\335\272\264\054\303\225\201\074"
	"\216\270\140\057\227\266\172\115\354\265\205\020\102\106\361\006"
	"\031\053\014\023\330\344\140\261\032\363\071\106\272\152\012\137"
	"\122\165\316\067\153\257\302\355\132\173\176\101\301\001\166\011"
	"\243\273\156\140\070\176\250\272\033\336\122\160\276\244\202\263"
	"\042\016\352\000\220\244\225\270\255\045\021\051\234\000\156\155"
	"\233\006\123\314\046\360\307\157\212\115\011\242\352\357\071\343"
	"\153\306\340\116\125\264\225\350\024\260\222\342\324\250\176\340"
	"\377\056\331\115\100\126\077\370\036\312\210\347\232\330\322\342"
	"\342\116\363\142\353\141\314\365\113\123\067\372\021\242\214\003"
	"\075\065\353\265\056\033\161\124\360\256\010\373\014\276\174\243"
	"\330\146\362\265\021\271\170\370\145\271\216\233\032\216\015\055"
	"\130\133\260\220\033\313\267\100\127\377\150\153\002\001\105\162"
	"\156\176\136\150\271\022\365\315\026\352\010\257\066\055\201\207"
	"\030\137\201\363\343\204\341\302\155\133\071\142\356\253\025\307"
	"\206\046\331\035\132\265\133\045\200\075\312\043\100\202\170\157"
	"\065\072\203\174\347\204\024\203\346\304\366\271\105\262\111\150"
	"\250\044\361\110\131\302\345\165\166\004\110\001\223\123\075\176"
	"\147\350\136\370\155\215\016\356\156\006\257\213\033\326\172\070"
	"\310\052\355\006\211\176\102\232\104\134\365\361\210\311\170\155"
	"\062\373\037\326\213\221\356\226\165\021\047\302\054\052\313\054"
	"\374\043\242\270\261\347\244\340\337\353\241\271\262\352\261\246"
	"\300\323\040\104\007\030\226\022\037\233\206\202\020\151\220\054"
	"\175\212\016\261\074\325\223\222\320\216\031\141\340\275\225\103"
	"\174\125\124\322\056\074\207\010\256\225\334\304\105\045\063\062"
	"\361\214\213\100\352\015\223\137\147\343\366\327\331\142\354\115"
	"\320\054\141\311\356\346\216\250\345\070\257\365\010\151\147\263"
	"\064\154\160\034\254\105\102\366\173\077\030\373\313\050\067\142"
	"\251\327\171\023\114\143\101\050\352\053\051\116\024\250\304\222"
	"\333\103\344\243\077\252\016\236\270\273\155\352\014\117\116\075"
	"\137\237\025\274\256\256\144\132\006\325\246\102\043\362\232\044"
	"\163\346\343\110\145\145\032\231\136\357\303\017\063\222\046\015"
	"\051\270\311\316\215\147\105\014\322\271\052\117\102\325\260\301"
	"\206\375\132\205\074\027\270\033\137\113\371\154\120\207\342\334"
	"\056\137\261\127\103\070\236\272\247\362\022\134\214\362\030\311"
	"\232\302\174\121\276\151\300\202\312\076\156\010\345\322\272\133"
	"\163\264\143\032\261\323\361\251\121\203\115\172\317\045\330\304"
	"\203\202\204\322\204\152\267\302\155\357\136\311\132\176\066\206"
	"\111\007\364\352\345\263\340\046\246\055\034\216\106\047\251\341"
	"\221\016\270\043\371\103\203\216\131\367\136\347\160\061\135\150"
	"\122\222\165\210\004\363\352\122\026\016\351\325\077\156\276\350"
	"\071\347\165\315\140\325\340\167\230\377\066\066\337\130\105\161"
	"\003\230\371\165\217\266\076\163\202\224\050\022\330\076\067\320"
	"\323\335\245\124\306\014\040\226\020\326\006\174\156\230\070\012"
	"\171\315\200\121\314\366\310\376\204\001\260\266\206\200\177\330"
	"\105\043\202\105\314\364\217\277\050\375\161\150\370\250\224\233"
	"\026\271\037\151\066\277\352\247\110\372\105\125\051\221\251\125"
	"\115\301\255\177\250\266\026\172\307\052\260\302\022\106\160\327"
	"\237\166\364\173\264\317\143\355\054\306\137\322\172\043\115\066"
	"\026\036\304\064\337\006\047\270\061\167\202\055\370\035\146\106"
	"\240\164\144\102\251\361\317\112\107\045\363\063\210\107\166\317"
	"\223\261\270\342\307\325\110\360\345\223\230\124\304\246\262\013"
	"\250\054\177\123\145\220\177\202\216\075\156\075\210\306\356\322"
	"\320\077\126\272\371\136\304\365\344\323\117\222\074\110\215\215"
	"\206\352\241\223\033\115\335\040\225\160\164\055\121\016\355\302"
	"\003\236\362\117\267\366\121\076\043\165\350\314\071\215\222\201"
	"\142\014\251\375\173\053\370\315\327\375\063\220\163\113\146\247"
	"\063\031\334\350\321\010\244\024\212\133\132\245\252\365\003\131"
	"\126\151\005\236\055\220\327\373\042\256\327\016\247\310\115\110"
	"\262\365\002\133\363\047\240\345\027\370\114\241\201\156\166\352"
	"\341\032\273\155\350\034\036\331\237\065\150\076\071\163\041\267"
	"\076\171\265\251\142\161\215\252\174\235\174\375\273\362\025\341"
	"\022\134\254\233\166\352\110\032\223\000\342\007\303\211\042\210"
	"\152\126\033\124\374\126\041\131\123\170\273\156\224\242\215\215"
	"\235\030\354\210\117\334\006\344\075\272\124\224\272\252\044\030"
	"\102\204\033\256\140\125\337\141\147\374\254\334\071\337\221\336"
	"\162\300\006\326\356\136\002\043\227\331\120\207\203\270\105\100"
	"\164\001\241\160\240\255\170\177\036\021\055\020\274\066\251\072"
	"\064\172\240\174\120\264\244\124\131\004\340\257\222\141\061\076"
	"\321\364\113\354\066\250\171\161\323\167\352\320\057\236\172\355"
	"\331\301\206\143\141\207\066\124\144\340\314\302\063\242\175\210"
	"\227\050\024\006\175\066\361\271\363\320\046\013\033\044\143\005"
	"\137\274\061\230\241\073\103\233\014\135\366\234\305\062\232\066"
	"\357\124\211\373\354\371\140\344\113\137\273\150\327\162\161\074"
	"\234\337\177\365\113\117\203\132\123\171\135\164\243\015\151\262"
	"\060\151\121\124\003\236\312\217\026\034\101\132\210\012\110\203"
	"\216\177\224\106\054\323\145\102\370\326\360\013\166\030\042\027"
	"\325\373\323\135\075\033\256\136\054\065\273\224\072\235\204\262"
	"\023\326\321\005\064\107\215\105\064\361\316\256\134\235\045\201"
	"\243\233\337\024\341\147\303\057\213\263\061\130\116\177\127\130"
	"\260\335\123\004\173\273\322\313\127\130\240\053\260\354\043\110"
	"\156\022\025\341\373\306\166\172\047\344\064\347\042\371\263\304"
	"\306\055\265\356\214\113\303\262\110\006\040\210\301\310\113\000"
	"\213\203\240\166\355\246\023\052\212\235\000\234\035\114\171\372"
	"\260\072\025\130\330\112\015\340\303\321\111\156\070\231\003\234"
	"\302\057\254\344\235\342\227\242\023\336\033\325\161\170\152\121"
	"\151\246\027\241\236\145\377\341\352\206\237\061\005\354\011\205"
	"\141\067\166\333\361\033\372\223\315\016\326\173\367\326\274\305"
	"\337\314\313\356\253\074\002\337\370\004\172\137\110\335\025\261"
	"\331\307\224\255\141\062\023\044\026\256\127\154\304\310\155\257"
	"\316\134\151\150\157\005\320\327\372\074\304\207\171\334\106\164"
	"\243\121\202\362\265\073\364\040\022\054\233\277\221\346\277\153"
	"\021\112\341\336\047\002\213\336\355\356\042\110\077\066\307\377"
	"\304\303\235\045\120\361\243\205\070\162\153\111\062\305\347\266"
	"\264\216\354\204\204\125\142\172\024\361\013\355\162\220\005\230"
	"\001\007\122\021\203\043\333\074\023\026\002\103\073\372\021\323"
	"\000\000\325\365\206\304\105\240\154\320\331\054\101\336\175\253"
	"\067\321\337\233\152\351\164\245\353\123\332\120\354\176\005\171"
	"\233\175\353\326\064\171\234\222\021\157\314\177\166\174\216\177"
	"\001\317\036\103\117\154\001\301\311\014\133\057\204\014\267\375"
	"\237\033\355\202\363\041\151\151\363\010\341\062\236\266\201\032"
	"\352\343\242\321\344\043\175\361\324\205\272\355\035\070\336\144"
	"\257\225\003\260\125\203\271\021\154\033\072\014\342\341\127\025"
	"\327\067\362\101\271\223\236\322\345\031\165\052\153\133\072\163"
	"\071\205\364\151\305\073\074\117\106\010\263\111\074\323\357\030"
	"\032\152\060\142\160\265\265\105\373\330\347\232\171\032\272\002"
	"\360\205\113\324\106\233\113\156\357\261\347\153\337\127\202\174"
	"\042\304\356\151\007\340\266\204\102\337\004\355\063\335\275\161"
	"\004\272\230\363\215\014\236\016\220\222\331\236\023\142\133\224"
	"\160\225\220\375\306\160\304\322\042\357\072\220\166\210\107\312"
	"\151\343\120\223\334\253\342\123\324\353\001\146\073\263\252\307"
	"\166\364\340\137\056\110\370\071\260\164\264\030\034\053\171\111"
	"\231\107\350\054\374\152\304\224\335\365\102\023\256\242\324\176"
	"\263\157\155\026\235\375\100\356\202\263\050\116\173\100\214\366"
	"\323\136\216\250\142\220\140\213\325\075\176\057\101\204\150\314"
	"\163\077\006\106\375\236\131\021\306\045\216\362\165\322\002\263"
	"\121\321\300\111\151\266\010\253\143\354\130\226\314\071\360\374"
	"\144\031\134\251\163\345\376\236\107\064\104\121\042\030\341\134"
	"\053\270\266\253\300\256\242\263\230\367\221\225\007\071\032\310"
	"\017\075\046\244\034\074\025\302\255\000\271\365\027\361\017\242"
	"\063\336\044\072\044\343\214\374\247\212\370\154\234\237\104\232"
	"\320\327\041\224\114\331\134\136\020\004\000\027\036\113\003\334"
	"\240\027\125\074\271\320\247\336\173\351\007\004\340\014\302\322"
	"\170\256\375\350\155\000\333\153\340\154\152\064\315\253\216\365"
	"\355\234\052\176\021\246\210\360\144\347\061\101\050\073\362\345"
	"\373\057\332\273\201\356\132\036\006\260\245\363\144\006\105\246"
	"\066\211\232\243\004\305\101\103\030\247\163\215\267\150\373\335"
	"\212\075\135\023\233\247\172\143\072\320\115\116\307\170\041\237"
	"\350\303\245\244\377\137\055\101\346\271\111\056\033\174\167\164"
	"\155\167\214\153\153\064\065\307\337\034\253\335\210\367\014\173"
	"\314\215\031\072\067\355\156\202\037\276\133\365\203\364\311\215"
	"\023\265\137\057\346\261\043\072\054\226\125\107\121\312\112\324"
	"\311\277\324\122\007\151\372\105\216\127\032\016\237\353\065\150"
	"\316\256\356\351\134\124\000\174\173\061\131\012\055\324\033\006"
	"\363\017\071\110\060\332\040\036\041\041\202\313\041\010\217\241"
	"\232\271\200\053\243\162\057\100\161\073\217\160\372\136\010\125"
	"\374\206\167\050\301\213\103\122\024\246\137\064\004\302\233\227"
	"\162\316\151\261\175\320\127\023\100\067\213\117\356\015\045\220"
	"\375\170\310\115\074\275\245\343\345\105\275\123\115\332\014\100"
	"\266\307\067\000\310\152\051\060\230\210\302\003\125\031\264\067"
	"\066\033\062\072\030\177\311\257\165\106\377\241\352\300\263\010"
	"\113\346\146\266\006\003\343\117\101\017\126\352\076\337\032\356"
	"\156\357\222\057\137\221\020\167\201\106\162\142\155\227\201\136"
	"\344\061\254\106\330\016\327\377\252\166\037\062\135\316\302\150"
	"\132\237\041\276\324\370\323\220\223\265\106\253\070\061\034\015"
	"\020\375\364\023\150\127\044\225\126\355\115\301\315\335\344\030"
	"\044\342\053\031\100\026\001\123\131\056\177\122\375\247\224\345"
	"\327\143\021\207\312\163\330\076\321\124\360\331\065\106\212\026"
	"\236\107\164\251\014\025\031\002\045\012\364\167\064\050\213\351"
	"\076\232\264\012\051\361\055\332\246\220\051\167\171\374\163\052"
	"\275\303\323\271\010\026\207\060\243\102\132\050\165\147\274\070"
	"\373\214\261\125\210\115\250\305\116\170\275\221\100\253\017\344"
	"\357\360\144\354\330\170\251\046\371\071\355\271\272\026\203\325"
	"\122\057\200\366\146\000\040\161\171\274\150\300\246\212\070\262"
	"\063\261\243\131\060\242\206\064\240\054\047\235\276\222\177\006"
	"\236\113\116\047\252\374\121\170\151\323\236\047\001\233\350\002"
	"\357\132\307\200\166\223\202\030\254\360\117\022\311\176\236\213"
	"\013\126\357\351\027\264\166\273\332\043\230\234\336\040\135\315"
	"\301\326\307\017\150\177\267\371\351\263\154\063\031\350\341\014"
	"\301\334\275\341\275\132\151\250\053\110\211\111\042\063\116\231"
	"\244\203\115\003\103\270\073\364\160\051\315\310\145\215\210\250"
	"\261\044\307\235\220\234\367\267\333\270\117\130\335\113\127\054"
	"\144\127\164\116\212\304\110\167\015\351\130\171\060\355\044\131"
	"\005\263\137\130\127\362\362\004\140\107\370\315\314\310\033\026"
	"\366\144\347\325\166\131\073\336\264\174\245\252\332\037\267\121"
	"\035\317\220\115\354\036\214\305\350\322\142\033\121\140\213\047"
	"\346\346\324\234\306\027\070\124\101\150\377\140\113\177\171\346"
	"\154\224\376\026\304\355\161\237\172\120\044\136\157\237\034\317"
	"\033\171\176\176\226\250\252\055\353\042\147\231\006\053\136\010"
	"\317\271\001\254\117\344\055\032\040\122\140\066\126\070\313\115"
	"\315\214\257\324\332\361\115\156\113\150\266\167\162\206\104\330"
	"\146\014\111\030\264\306\362\101\005\115\207\324\064\150\001\016"
	"\373\275\042\311\336\214\177\034\252\345\260\040\015\201\160\324"
	"\017\027\335\121\261\007\273\001\056\376\222\344\231\146\120\043"
	"\242\125\313\062\256\044\273\114\236\056\023\176\224\153\021\000"
	"\375\200\055\104\254\035\267\330\174\311\061\315\065\013\354\202"
	"\266\276\261\213\105\376\073\123\256\200\131\357\343\012\062\357"
	"\164\175\046\112\326\321\234\164\335\251\373\355\323\004\127\344"
	"\353\347\371\160\340\334\350\225\222\162\072\222\142\135\276\304"
	"\205\263\063\347\375\132\042\360\063\170\377\172\174\353\100\351"
	"\316\270\236\232\373\231\217\371\130\157\343\246\303\055\162\262"
	"\171\053\113\005\300\312\323\173\161\357\003\157\336\006\374\115"
	"\001\120\046\330\113\364\326\214\201\235\335\021\022\113\142\016"
	"\243\245\345\164\270\302\347\102\204\040\276\262\016\257\007\210"
	"\171\137\123\357\040\155\351\151\060\155\052\115\125\153\305\024"
	"\266\125\107\143\220\037\222\301\340\117\226\176\036\056\177\273"
	"\350\125\174\277\172\314\060\212\245\302\017\023\322\267\154\261"
	"\026\251\253\054\203\317\247\025\235\230\377\241\257\170\056\002"
	"\307\112\241\243\304\010\370\112\122\266\031\226\000\115\154\216"
	"\207\207\123\257\001\107\125\272\110\020\011\112\315\175\017\147"
	"\375\170\171\165\113\106\363\027\015\173\030\240\110\267\150\146"
	"\244\321\042\336\127\021\362\340\365\044\114\206\221\067\024\177"
	"\357\332\043\015\155\210\251\032\343\257\072\222\303\272\221\163"
	"\022\014\204\061\110\260\324\117\161\131\051\027\230\214\335\226"
	"\043\350\051\166\342\171\335\304\051\243\370\357\166\140\254\132"
	"\064\026\330\141\312\270\232\146\243\224\142\370\237\213\341\040"
	"\365\156\005\074\265\105\110\233\025\130\121\271\366\271\304\273"
	"\060\005\337\137\115\067\245\053\205\004\006\315\216\136\001\242"
	"\222\077\000\065\134\143\273\310\067\011\215\174\315\205\004\271"
	"\350\054\132\052\237\074\223\202\303\112\177\233\062\253\011\102"
	"\062\146\076\302\052\335\131\177\252\273\101\310\230\325\064\051"
	"\127\004\267\371\251\075\101\167\353\240\354\340\322\311\354\367"
	"\017\272\042\232\120\065\371\306\235\247\273\206\263\035\273\371"
	"\264\065\205\153\036\053\226\270\241\141\321\020\051\302\014\076"
	"\362\040\341\113\122\266\354\021\056\135\067\144\040\320\373\134"
	"\204\102\165\262\117\264\365\173\014\310\256\164\001\343\064\245"
	"\023\265\160\300\313\216\013\100\362\333\236\061\260\220\216\077"
	"\154\345\051\211\226\136\060\122\066\173\066\344\362\175\035\302"
	"\306\256\030\004\065\016\164\237\305\221\165\366\124\034\053\355"
	"\100\125\205\201\360\017\357\051\075\225\266\232\331\143\216\141"
	"\165\067\367\236\267\032\373\071\205\130\225\001\026\377\375\254"
	"\152\350\256\154\322\212\166\226\302\310\166\102\375\210\123\001"
	"\263\004\204\061\204\204\266\164\341\044\230\011\112\253\367\041"
	"\253\053\247\133\242\140\123\111\174\263\325\204\261\261\206\006"
	"\113\054\234\162\136\114\107\074\143\326\226\376\257\366\270\203"
	"\060\057\000\220\000\206\203\023\332\373\315\331\162\262\324\145"
	"\340\353\333\306\066\130\363\255\127\357\207\224\032\116\056\017"
	"\116\232\303\333\352\222\141\266\216\224\214\154\041\000\076\125"
	"\024\266\137\352\320\131\064\206\260\260\234\361\010\057\133\064"
	"\351\021\212\135\262\026\356\146\311\207\005\013\121\034\176\237"
	"\052\220\027\372\334\266\320\113\264\354\105\262\337\300\277\012"
	"\364\100\251\063\055\142\357\365\003\300\324\063\020\001\022\150"
	"\311\075\145\310\356\210\157\157\060\303\156\013\376\220\210\016"
	"\116\074\044\323\304\137\020\131\026\235\042\370\272\352\113\151"
	"\123\230\041\330\135\303\205\106\073\033\314\031\362\323\114\007"
	"\245\035\150\311\063\041\216\025\374\270\212\033\137\257\336\121"
	"\313\206\177\333\066\316\127\223\211\327\002\023\013\167\330\256"
	"\076\301\053\152\140\235\020\374\142\343\073\206\107\024\100\035"
	"\223\314\034\123\344\105\222\273\123\206\144\121\061\176\103\055"
	"\113\350\170\101\133\025\320\071\024\154\160\267\350\055\037\230"
	"\103\031\160\046\054\005\325\120\046\324\277\072\372\025\134\011"
	"\311\143\333\267\251\177\254\224\113\057\356\374\272\126\046\074"
	"\133\214\122\172\003\023\312\147\313\126\255\213\257\275\141\167"
	"\107\206\170\121\156\257\057\066\113\263\246\200\265\065\132\051"
	"\346\361\305\302\024\255\276\171\264\235\302\002\350\377\133\245"
	"\015\122\216\122\025\151\256\362\367\162\114\276\253\023\214\100"
	"\231\027\355\120\054\354\151\360\240\026\007\030\257\100\017\066"
	"\233\046\072\144\253\342\363\010\150\056\350\016\245\172\023\257"
	"\245\147\212\274\323\150\176\121\035\105\207\261\254\031\222\335"
	"\023\004\360\222\007\312\105\002\242\326\074\340\322\175\055\102"
	"\135\265\131\313\324\011\023\116\321\131\233\334\347\324\013\136"
	"\330\106\024\157\255\262\116\342\163\064\212\115\025\377\260\177"
	"\210\123\323\335\330\000\007\350\111\047\316\315\033\324\326\225"
	"\070\130\062\374\346\366\200\326\222\301\156\015\171\160\210\135"
	"\301\200\116\045\104\174\062\131\245\154\176\135\207\363\130\077"
	"\251\176\376\305\223\235\227\160\163\353\346\373\130\100\127\236"
	"\166\321\226\114\031\176\304\133\263\217\244\253\125\376\075\365"
	"\131\201\246\033\224\264\051\221\307\141\046\311\065\067\360\373"
	"\230\322\227\234\242\202\045\204\302\100\002\134\147\014\157\356"
	"\353\214\332\102\031\014\145\111\137\117\001\004\301\314\326\143"
	"\160\316\167\064\377\175\231\376\277\310\213\132\054\203\344\144"
	"\163\347\050\116\252\071\174\335\216\052\034\010\061\043\303\341"
	"\074\242\262\011\266\001\007\157\136\377\357\241\264\016\137\112"
	"\174\107\303\162\127\217\052\204\356\111\353\301\152\270\015\111"
	"\311\005\361\313\042\302\077\171\242\140\366\074\256\250\053\336"
	"\346\221\232\207\144\276\174\145\344\250\373\216\335\155\346\157"
	"\341\246\111\261\327\276\105\031\313\310\240\216\002\371\272\114"
	"\316\371\052\123\355\121\261\362\062\025\355\272\044\377\267\075"
	"\134\002\017\301\057\156\106\007\047\262\045\110\011\250\353\170"
	"\271\017\375\244\200\114\140\134\347\205\332\351\320\143\107\374"
	"\327\203\256\156\163\110\015\052\224\300\376\174\352\257\110\031"
	"\152\362\331\125\317\370\340\142\252\036\036\144\350\050\113\075"
	"\116\215\363\215\224\141\075\377\023\324\130\022\134\056\226\175"
	"\277\164\350\363\230\026\167\030\050\352\225\336\317\001\220\342"
	"\311\355\050\360\234\166\215\267\165\123\232\147\320\244\203\213"
	"\160\143\233\233\247\000\110\221\347\002\222\172\350\171\063\251"
	"\261\332\056\247\244\235\125\244\050\266\031\332\122\241\052\070"
	"\175\346\310\326\252\210\140\376\360\075\316\242\134\131\364\130"
	"\345\151\354\165\240\046\020\115\050\337\031\152\161\346\067\066"
	"\230\342\046\105\032\262\103\307\333\253\110\023\076\365\351\232"
	"\126\165\343\267\343\202\324\201\036\035\131\073\156\337\225\044"
	"\172\303\055\270\245\164\260\312\265\234\065\075\223\331\327\312"
	"\243\101\363\303\073\212\072\110\061\354\241\021\145\211\260\206"
	"\337\275\210\133\074\254\317\150\066\124\007\161\272\257\050\344"
	"\300\263\362\212\123\232\351\024\244\065\240\273\177\256\133\001"
	"\102\352\366\022\205\143\177\126\006\100\034\216\230\115\227\263"
	"\313\315\272\140\217\376\024\006\130\227\377\375\152\077\113\006"
	"\021\127\374\000\177\155\135\074\224\246\365\162\137\033\076\032"
	"\212\314\320\203\030\154\127\266\067\037\224\262\274\145\044\340"
	"\260\356\226\311\316\160\140\373\103\266\175\214\017\331\202\001"
	"\032\000\025\043\274\223\226\141\040\354\371\211\030\263\211\320"
	"\104\254\037\122\345\126\272\345\260\066\052\234\056\276\174\205"
	"\212\332\134\066\101\157\164\316\235\172\321\255\112\266\026\332"
	"\057\360\333\143\204\004\371\045\207\240\020\066\046\276\215\323"
	"\101\126\237\214\272\254\357\361\175\276\344\110\256\311\146\147"
	"\115\132\014\317\334\203\316\216\262\202\026\055\320\254\170\356"
	"\245\206\335\140\012\004\267\043\174\036\043\350\027\331\063\250"
	"\313\312\342\073\041\336\247\373\052\356\120\167\103\321\033\042"
	"\174\066\324\255\277\055\153\322\302\256\046\051\270\010\161\244"
	"\166\304\332\265\277\356\340\275\004\144\240\374\243\311\302\063"
	"\004\263\155\207\126\000\050\311\227\250\044\250\316\311\156\316"
	"\051\221\267\062\144\326\106\342\001\104\121\053\332\364\334\360"
	"\070\135\025\131\032\242\111\214\032\046\140\360\031\271\270\151"
	"\241\203\157\322\247\013\042\216\056\140\322\235\154\012\244\157"
	"\321\234\207\373\121\225\033\343\041\021\021\136\213\173\212\351"
	"\365\100\042\237\170\033\053\343\151\054\360\072\362\023\375\150"
	"\063\054\056\270\317\244\026\137\150\346\353\172\306\075\145\304"
	"\366\246\134\023\051\343\337\124\246\047\131\226\071\277\313\200"
	"\313\360\002\114\263\201\035\030\014\115\262\161\147\225\336\115"
	"\017\374\333\076\114\147\214\300\210\267\217\325\357\126\012\257"
	"\064\220\201\061\325\244\036\315\307\314\266\121\114\052\220\251"
	"\117\003\004\324\154\101\063\155\011\123\025\277\227\223\332\223"
	"\104\153\040\111\344\007\367\335\136\154\303\076\333\275\076\326"
	"\250\260\322\302\013\273\266\242\200\113\306\214\262\227\300\366"
	"\064\357\314\204\243\343\147\070\353\266\163\045\375\030\304\006"
	"\107\104\303\034\313\102\326\234\045\315\300\010\340\050\030\356"
	"\216\023\114\263\340\103\012\130\342\021\171\071\211\256\020\042"
	"\065\226\054\365\311\161\057\002\200\276\076\130\053\220\360\240"
	"\113\145\012\227\054\317\150\117\147\201\357\346\157\200\373\303"
	"\300\243\252\146\151\254\114\021\330\127\103\161\214\264\167\161"
	"\266\314\156\163\054\066\207\211\153\114\113\165\323\173\245\071"
	"\366\070\356\201\003\004\177\244\157\362\254\141\152\230\134\123"
	"\356\074\245\240\330\265\340\127\151\047\201\227\335\305\107\027"
	"\275\326\173\207\370\237\031\133\227\065\135\035\170\275\054\300"
	"\061\050\134\004\153\133\303\226\145\211\142\103\132\376\374\163"
	"\361\375\170\373\151\206\343\310\340\270\234\341\353\070\105\145"
	"\311\144\164\115\126\224\201\234\212\200\226\221\163\307\333\147"
	"\360\134\136\075\251\032\010\000\333\140\146\114\044\165\150\355"
	"\073\006\263\212\051\062\023\002\123\072\007\100\313\147\111\015"
	"\213\250\067\201\202\204\030\214\076\230\173\306\027\365\104\251"
	"\307\034\107\315\006\044\003\214\222\274\315\135\044\027\152\260"
	"\300\242\061\102\046\112\316\145\343\112\054\372\077\160\243\007"
	"\214\352\325\223\017\330\040\241\225\356\376\271\005\151\152\305"
	"\014\234\010\063\346\327\231\311\041\305\304\141\065\147\150\302"
	"\122\075\125\142\025\165\003\253\143\002\144\151\154\316\057\170"
	"\153\067\254\121\017\105\033\060\012\340\222\100\107\372\002\232"
	"\070\130\374\116\316\000\371\062\002\136\233\156\055\312\347\230"
	"\002\223\351\021\330\005\102\343\345\324\043\055\316\046\310\006"
	"\177\304\125\115\305\116\177\307\254\033\066\331\345\036\161\350"
	"\262\133\371\213\141\073\156\106\017\222\164\336\271\074\345\070"
	"\001\072\205\306\210\005\216\065\040\305\016\006\343\177\356\226"
	"\333\347\041\074\043\217\202\063\042\367\021\334\063\367\024\065"
	"\062\232\373\273\237\212\360\300\117\376\306\063\176\265\311\131"
	"\235\352\225\300\172\030\363\235\017\005\171\103\375\216\171\057"
	"\050\164\352\310\377\332\211\117\331\120\202\127\005\114\261\242"
	"\067\107\142\262\137\126\117\157\133\311\263\130\127\054\207\200"
	"\241\162\111\240\115\322\357\046\042\162\176\050\276\057\312\366"
	"\166\054\250\326\202\367\105\336\300\371\067\030\045\277\230\306"
	"\061\342\147\176\265\126\245\330\311\043\000\207\123\312\175\312"
	"\367\045\241\172\035\347\130\336\340\220\366\005\117\217\314\201"
	"\161\063\000\047\212\245\377\123\311\377\333\035\311\130\347\301"
	"\176\211\073\234\160\224\172\120\044\160\126\164\000\043\365\161"
	"\126\365\230\340\233\230\063\144\227\017\201\141\147\151\042\346"
	"\363\136\202\143\362\375\264\027\155\012\213\155\055\201\337\204"
	"\166\170\144\022\020\230\166\250\247\370\012\017\142\055\366\125"
	"\213\171\271\176\166\155\226\344\167\041\122\245\243\062\051\032"
	"\252\216\054\273\047\243\144\317\233\156\337\376\233\326\124\047"
	"\117\015\246\306\172\074\252\362\136\374\230\001\056\302\033\331"
	"\121\110\225\170\353\371\110\207\150\050\205\004\376\332\053\116"
	"\347\322\024\142\016\276\125\154\273\355\156\351\257\212\303\001"
	"\322\130\171\275\122\302\104\272\352\312\276\350\244\352\066\214"
	"\274\112\357\313\011\104\070\304\062\246\256\342\060\161\343\002"
	"\311\135\300\033\037\005\326\012\317\225\363\164\177\051\001\074"
	"\164\361\007\176\066\077\103\151\346\361\113\026\142\057\031\054"
	"\214\332\110\254\337\036\266\257\264\252\044\063\323\046\160\110"
	"\027\170\307\116\267\012\267\236\373\002\265\136\062\316\213\277"
	"\251\324\153\210\363\042\070\247\314\135\332\240\203\113\351\233"
	"\303\261\351\173\273\240\031\267\243\316\026\325\235\241\224\106"
	"\165\000\317\150\043\010\017\357\145\352\220\351\065\172\204\371"
	"\053\156\164\346\016\216\236\262\135\264\207\372\125\034\101\313"
	"\034\021\063\100\031\103\060\176\055"
#define      tst2_z	19
#define      tst2	((&data[7033]))
	"\073\354\322\356\037\020\273\037\366\267\245\045\364\177\263\230"
	"\131\346\274\114\072\135"
#define      msg2_z	19
#define      msg2	((&data[7054]))
	"\115\313\235\364\103\266\201\012\167\132\272\345\176\374\164\051"
	"\336\351\132\133\151\140\354\033"
#define      chk2_z	19
#define      chk2	((&data[7080]))
	"\270\366\277\171\376\203\200\017\156\231\143\306\155\133\354\215"
	"\244\214\224\343\113\230\371\301\334"
#define      pswd_z	256
#define      pswd	((&data[7164]))
	"\044\070\114\242\146\015\012\312\110\367\047\257\121\371\375\272"
	"\132\351\325\030\212\170\320\200\067\312\101\023\325\066\060\371"
	"\157\174\234\325\212\247\237\323\236\307\203\357\301\200\252\033"
	"\152\200\063\364\370\004\164\060\316\266\104\243\355\164\114\137"
	"\167\017\330\101\213\322\126\322\251\346\270\203\052\171\071\260"
	"\007\306\240\241\222\235\220\144\062\037\034\274\265\151\033\055"
	"\170\364\157\003\306\305\326\160\253\216\363\326\010\054\207\017"
	"\362\047\261\205\305\101\351\367\141\006\264\027\157\320\105\350"
	"\304\264\354\213\171\303\373\045\122\356\373\132\033\203\152\016"
	"\252\034\223\160\136\175\150\277\204\034\326\363\355\033\334\262"
	"\320\310\075\111\213\071\157\335\047\152\070\103\356\243\121\230"
	"\277\345\011\035\142\161\335\346\216\264\332\173\320\267\055\240"
	"\200\153\351\014\244\130\352\314\303\042\017\261\305\140\112\205"
	"\106\124\242\250\305\177\217\124\063\152\317\003\042\375\244\242"
	"\150\215\256\015\346\230\331\252\273\350\134\201\111\247\006\217"
	"\373\250\070\300\050\310\024\134\063\344\140\125\342\004\367\113"
	"\222\246\130\171\077\061\043\372\032\200\173\144\047\202\364\042"
	"\053\055\343\123\365\370\260\051\335\020\176\277\024\166\012\246"
	"\035\143\037\134\225\103\127\260\303\322\025\353\125\011\016\200"
	"\067\362\324\055\353\204\126\310\224\325\210\250\114\223\235\134"
	"\361\072\062\173\341"
#define      msg1_z	65
#define      msg1	((&data[7432]))
	"\231\322\157\132\122\102\263\240\072\324\100\063\066\344\255\277"
	"\071\202\255\234\364\215\232\051\123\063\065\315\055\043\261\015"
	"\376\145\107\106\130\135\106\015\036\211\112\247\303\047\337\345"
	"\051\107\371\262\204\106\111\101\253\067\322\173\216\342\372\307"
	"\131\316\240\036\030\050\032\166\275\232\251\261\223\255"
#define      shll_z	10
#define      shll	((&data[7507]))
	"\334\007\331\311\051\335\365\375\106\354\201\123\040"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
