#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f lock_arena/data/ps_tests/ps1/karel_arena.sh 
#endif

static  char data [] = 
#define      text_z	5238
#define      text	((&data[423]))
	"\024\026\146\036\052\036\344\243\243\146\155\116\223\241\125\310"
	"\077\242\173\115\164\136\317\116\361\265\175\066\207\320\337\233"
	"\347\105\271\022\143\236\265\007\004\042\125\230\304\253\140\004"
	"\115\334\121\302\073\040\021\054\326\216\142\135\137\102\370\106"
	"\210\262\130\354\120\016\363\125\061\111\355\365\364\116\371\102"
	"\052\112\005\145\153\026\222\101\245\364\236\004\067\227\113\277"
	"\112\244\253\232\262\237\360\343\350\336\331\335\054\322\040\127"
	"\035\045\274\210\073\117\312\340\103\151\345\173\000\061\072\112"
	"\325\346\345\210\205\325\154\156\264\105\113\341\027\153\070\065"
	"\220\365\276\314\104\210\255\210\361\223\003\362\304\076\074\232"
	"\044\042\042\252\370\217\031\254\324\145\215\354\320\306\041\141"
	"\273\337\056\000\150\333\210\132\156\214\114\063\312\211\315\357"
	"\253\360\232\243\177\263\117\124\030\335\100\351\243\141\113\137"
	"\101\171\137\252\124\347\004\303\164\120\366\076\331\304\056\204"
	"\264\310\050\064\174\167\210\224\124\310\176\370\052\311\127\154"
	"\102\266\026\227\236\032\133\023\153\121\122\105\025\200\311\312"
	"\111\361\376\305\151\207\132\276\117\330\266\172\242\016\346\345"
	"\305\374\175\144\027\330\167\202\051\311\307\077\111\221\012\223"
	"\203\011\130\354\220\263\253\337\213\141\132\056\160\100\023\065"
	"\075\220\232\124\150\021\326\222\333\235\322\045\057\335\270\262"
	"\346\020\236\166\303\111\126\117\253\260\176\034\361\221\121\056"
	"\042\354\202\213\375\131\036\330\366\360\376\045\315\266\330\264"
	"\307\167\052\213\300\201\333\154\062\131\210\043\353\332\121\015"
	"\306\324\230\304\055\266\235\044\247\233\112\165\122\042\051\031"
	"\231\124\244\132\326\200\306\010\331\117\053\304\052\175\322\361"
	"\121\153\266\176\042\123\243\311\357\355\077\101\017\151\133\250"
	"\276\000\002\224\200\311\234\230\135\231\057\210\070\145\162\372"
	"\207\102\014\151\217\234\073\376\151\212\325\161\102\111\003\037"
	"\121\260\121\034\301\262\160\345\356\077\210\076\223\276\351\051"
	"\061\236\026\021\121\372\360\370\010\215\337\107\130\233\254\257"
	"\367\332\242\215\334\056\306\113\366\130\034\237\374\340\154\262"
	"\021\273\313\012\326\116\253\324\201\237\012\125\047\321\072\315"
	"\067\110\302\155\011\365\365\153\152\363\224\275\226\102\304\060"
	"\063\223\017\325\041\155\107\116\260\010\257\344\060\137\131\375"
	"\100\273\260\031\132\065\272\361\215\171\345\305\241\013\004\204"
	"\156\314\261\313\161\040\200\323\157\145\263\002\163\252\241\144"
	"\070\340\173\023\271\371\301\223\224\023\252\347\077\136\352\102"
	"\277\221\314\277\277\335\023\337\275\317\177\306\051\102\317\333"
	"\276\127\010\042\005\014\345\350\054\305\217\161\365\114\116\034"
	"\315\064\226\027\146\104\301\337\106\052\173\175\253\260\270\074"
	"\040\052\141\201\307\164\334\276\071\150\311\174\153\261\236\224"
	"\012\102\022\344\214\054\274\035\240\376\174\163\211\156\342\153"
	"\142\371\111\122\106\142\044\126\260\006\015\156\220\174\202\142"
	"\033\003\133\007\372\127\330\245\330\114\065\054\120\053\100\215"
	"\203\212\215\130\343\371\067\357\131\020\303\151\317\164\201\227"
	"\140\030\070\170\367\000\365\002\066\322\145\133\270\207\073\245"
	"\245\044\274\265\327\314\032\303\212\362\210\164\122\142\343\310"
	"\067\032\070\037\137\063\334\115\351\120\234\055\374\161\137\217"
	"\222\127\325\210\104\051\312\220\320\176\251\041\336\347\354\277"
	"\070\001\362\231\216\303\177\145\056\151\052\222\240\163\325\277"
	"\365\013\134\206\220\046\354\001\277\245\301\145\072\054\276\227"
	"\324\225\242\112\074\316\042\337\222\027\107\010\314\053\267\135"
	"\136\161\366\376\114\041\046\214\122\071\251\033\060\172\364\252"
	"\153\115\007\303\043\004\173\046\000\273\246\302\024\032\007\017"
	"\140\317\216\001\332\033\306\134\265\142\077\232\104\324\334\117"
	"\332\350\302\055\254\351\015\136\257\175\170\156\326\240\056\347"
	"\130\234\020\364\315\104\137\137\224\360\251\043\322\073\001\354"
	"\317\360\350\070\211\210\052\037\017\352\174\200\240\254\116\206"
	"\370\176\367\015\356\100\325\033\314\200\175\136\007\343\160\163"
	"\107\034\162\075\050\262\232\174\021\030\152\020\000\022\333\220"
	"\070\107\075\122\351\062\311\357\006\302\231\053\171\372\017\223"
	"\226\076\327\056\145\024\100\257\166\374\156\377\262\202\373\071"
	"\140\013\233\014\357\043\315\364\310\372\016\341\177\046\070\237"
	"\057\302\267\107\066\235\044\166\141\221\217\112\126\321\062\225"
	"\050\276\143\230\035\351\102\077\066\226\000\372\355\150\163\165"
	"\256\063\161\050\252\154\210\050\364\301\364\341\011\302\256\036"
	"\374\322\272\016\362\350\336\016\100\215\357\061\312\214\046\206"
	"\255\253\076\264\211\322\372\336\051\246\210\140\247\257\141\245"
	"\021\240\143\375\056\103\202\226\051\214\204\321\210\314\025\041"
	"\376\107\040\040\055\211\121\225\146\306\025\372\225\047\201\121"
	"\353\267\365\045\231\205\333\124\230\015\163\216\222\207\373\242"
	"\234\003\157\317\026\204\024\124\233\216\133\267\230\260\037\141"
	"\241\255\231\215\332\023\205\211\355\134\201\104\153\000\243\104"
	"\233\026\263\314\256\322\067\230\122\226\250\246\052\102\031\253"
	"\161\334\226\274\252\037\123\015\001\274\206\033\212\077\237\276"
	"\014\354\262\107\165\272\335\352\307\077\032\002\315\127\027\324"
	"\304\157\327\162\366\333\075\224\276\206\204\225\122\276\130\151"
	"\204\044\212\365\137\377\014\164\227\331\205\103\244\101\066\334"
	"\206\300\261\100\235\046\024\032\144\024\211\302\266\173\064\232"
	"\072\132\300\247\177\135\232\052\035\050\336\256\254\370\242\373"
	"\266\005\372\357\047\056\000\223\162\160\063\261\071\363\321\157"
	"\261\335\301\236\254\270\363\206\310\363\167\235\103\251\042\156"
	"\235\000\361\106\242\372\025\343\115\332\155\312\137\131\377\013"
	"\224\253\346\236\157\340\334\120\246\363\376\145\064\176\157\331"
	"\374\374\023\272\030\261\131\125\110\213\032\372\350\326\333\356"
	"\233\342\227\361\340\071\376\177\277\063\175\215\204\355\263\233"
	"\370\132\352\276\347\214\046\362\352\137\104\276\014\000\231\106"
	"\223\245\136\315\113\306\141\140\160\026\367\306\211\250\312\042"
	"\207\152\012\133\052\150\150\320\333\013\127\163\337\377\265\107"
	"\356\255\374\154\373\372\335\177\142\163\145\107\276\023\152\365"
	"\027\363\216\315\343\254\225\335\051\145\316\357\003\366\213\212"
	"\010\146\241\177\313\271\324\171\350\233\340\042\017\023\271\363"
	"\033\114\010\312\335\067\301\035\360\077\141\373\030\226\025\027"
	"\114\130\040\374\066\370\211\115\101\346\161\153\253\322\150\353"
	"\327\033\126\260\242\342\364\047\112\112\337\160\000\075\140\325"
	"\314\043\356\234\165\112\174\362\327\113\044\313\273\311\304\052"
	"\044\272\163\246\325\060\206\025\202\110\035\177\054\323\044\151"
	"\201\031\040\342\063\215\142\377\167\031\324\063\121\063\255\065"
	"\175\203\111\227\321\026\060\076\343\345\227\072\137\166\060\360"
	"\163\047\015\000\235\141\343\351\037\022\135\247\212\221\354\023"
	"\310\166\054\275\212\241\044\075\244\214\040\326\327\042\246\107"
	"\163\171\212\163\337\026\022\155\347\107\020\162\164\332\211\371"
	"\264\267\202\227\133\257\177\060\147\032\143\047\372\352\044\155"
	"\021\246\314\044\001\362\127\162\105\335\334\011\335\305\313\205"
	"\042\052\051\061\101\170\275\130\375\046\023\277\077\151\312\233"
	"\130\064\372\353\043\207\007\050\145\120\366\066\065\201\054\221"
	"\335\216\365\176\372\147\003\015\173\343\071\037\303\112\354\151"
	"\163\075\014\324\162\347\177\324\122\272\035\060\046\305\176\126"
	"\335\176\134\314\221\336\037\173\353\064\253\342\123\155\105\167"
	"\012\365\034\077\206\350\222\251\303\176\106\174\137\301\120\240"
	"\121\140\234\075\300\275\141\146\223\120\334\313\340\370\247\046"
	"\223\141\146\332\364\133\257\274\125\135\366\040\224\046\370\131"
	"\054\014\016\322\266\306\000\125\026\313\341\215\010\374\131\043"
	"\367\366\024\007\047\246\072\215\305\121\154\304\330\055\064\036"
	"\241\257\036\376\361\152\034\270\306\045\057\157\070\214\020\057"
	"\360\011\357\021\231\070\005\105\237\272\275\177\240\345\264\377"
	"\107\327\131\260\117\065\154\300\151\212\261\074\304\070\143\301"
	"\106\220\220\053\355\116\365\301\307\320\210\304\240\177\067\054"
	"\263\077\100\015\310\243\062\004\017\137\305\043\043\247\111\351"
	"\051\246\132\274\152\035\014\330\203\140\056\021\020\321\170\034"
	"\156\125\202\345\175\034\204\057\052\271\124\322\240\123\327\136"
	"\145\261\201\266\206\372\145\245\202\067\354\054\305\046\055\000"
	"\010\136\200\012\023\233\363\170\041\060\374\045\030\073\150\204"
	"\304\170\302\346\335\024\026\130\061\362\250\150\046\272\002\072"
	"\306\063\202\034\374\004\362\206\011\162\075\327\204\021\026\143"
	"\202\241\032\352\263\060\312\130\104\126\162\172\374\130\014\042"
	"\004\014\247\103\333\037\013\157\143\366\223\266\023\116\342\255"
	"\052\162\304\327\201\046\241\366\315\074\272\006\073\014\044\162"
	"\365\334\327\347\157\226\120\252\002\371\057\264\057\316\336\276"
	"\127\035\367\175\304\374\176\207\147\311\062\136\375\324\107\113"
	"\176\345\320\002\011\320\376\301\044\336\127\153\206\017\011\123"
	"\033\264\310\315\235\074\332\263\225\237\241\136\351\001\061\233"
	"\017\352\164\044\253\251\302\035\122\275\051\370\204\256\337\134"
	"\035\155\262\120\225\322\026\243\206\377\264\126\370\164\322\317"
	"\333\365\046\007\354\102\275\042\136\303\163\136\156\133\300\154"
	"\037\213\367\263\135\150\215\117\342\125\006\352\060\323\365\325"
	"\045\267\035\370\175\371\250\143\300\237\035\063\333\232\116\255"
	"\246\377\275\374\266\127\236\000\373\001\332\364\153\327\165\361"
	"\021\021\362\356\334\157\025\204\050\037\314\252\055\303\313\034"
	"\212\351\205\141\344\334\332\104\112\317\245\170\333\146\317\373"
	"\045\221\060\353\312\220\214\036\316\260\363\255\120\301\232\064"
	"\007\252\231\056\300\012\307\037\354\373\232\355\175\254\150\175"
	"\007\154\153\343\203\345\324\370\016\274\151\257\241\370\323\216"
	"\241\243\115\204\210\214\303\036\210\046\324\265\212\151\021\376"
	"\371\261\211\334\330\133\266\177\007\047\101\231\045\121\306\000"
	"\123\042\070\366\060\043\360\242\313\227\215\376\131\300\172\260"
	"\120\216\246\113\267\067\043\067\202\255\116\066\165\261\133\342"
	"\231\376\071\256\166\322\005\242\343\004\217\314\125\302\060\325"
	"\037\012\212\221\055\245\334\022\121\324\371\016\214\216\375\220"
	"\021\144\163\200\152\320\246\225\265\346\134\024\267\152\042\276"
	"\100\362\370\151\344\256\263\342\370\375\256\024\100\202\230\157"
	"\334\340\002\343\266\071\200\322\233\247\174\033\073\120\362\003"
	"\261\152\052\327\267\235\163\171\040\321\112\062\357\333\163\031"
	"\310\240\146\015\172\176\173\175\050\133\213\307\302\030\237\314"
	"\326\363\274\371\224\225\301\153\136\264\063\252\372\025\237\264"
	"\173\331\166\264\255\103\153\266\043\220\016\121\116\142\102\004"
	"\103\301\201\110\306\175\254\201\202\047\007\304\062\334\121\067"
	"\272\350\101\045\104\123\227\224\105\334\311\267\240\000\337\104"
	"\012\305\224\053\260\370\264\164\221\314\052\000\344\052\371\174"
	"\330\330\220\262\051\133\236\244\351\162\331\165\127\370\364\032"
	"\377\356\265\217\033\174\004\007\224\103\123\037\347\330\101\330"
	"\017\135\300\301\042\171\046\033\355\242\375\217\111\261\241\110"
	"\240\032\014\265\163\165\116\011\177\312\321\030\262\221\240\174"
	"\171\130\146\172\240\031\006\346\120\011\365\372\272\232\174\271"
	"\177\026\126\021\361\254\055\207\273\322\052\340\056\135\324\153"
	"\305\243\060\162\113\003\016\376\354\333\203\231\133\270\254\244"
	"\234\370\166\324\065\047\376\276\144\321\153\027\305\302\072\263"
	"\107\107\073\301\010\351\010\031\326\201\070\302\111\171\130\364"
	"\047\034\003\115\202\303\052\063\172\215\055\216\202\262\267\165"
	"\044\124\247\053\154\035\021\145\003\014\367\042\301\376\336\205"
	"\227\324\367\353\102\032\352\370\127\137\335\072\123\311\030\121"
	"\304\215\040\007\351\230\071\042\023\231\251\003\006\217\044\120"
	"\303\006\361\016\255\150\347\045\237\034\010\073\210\156\066\313"
	"\012\117\117\231\003\333\102\352\215\221\246\052\102\216\054\255"
	"\007\140\134\341\175\332\047\362\273\347\353\033\076\145\114\104"
	"\111\141\372\322\074\166\174\277\234\352\156\370\017\237\337\115"
	"\117\221\074\336\355\157\042\046\123\212\065\030\243\370\340\241"
	"\070\334\056\342\005\154\137\126\207\171\227\141\347\261\047\173"
	"\204\225\171\125\031\271\301\141\212\233\137\250\362\100\002\310"
	"\266\320\102\374\156\325\026\132\167\206\357\372\366\317\076\353"
	"\136\247\205\206\357\052\072\303\054\014\077\253\154\105\327\304"
	"\323\301\357\075\322\110\356\357\333\161\171\276\115\363\335\201"
	"\310\317\017\371\021\136\244\265\252\316\047\331\261\103\031\036"
	"\211\233\372\214\171\012\271\174\262\051\354\172\353\303\072\240"
	"\053\122\147\035\214\010\266\246\361\140\132\141\316\262\125\303"
	"\153\302\221\365\255\324\220\255\264\166\065\105\327\052\337\364"
	"\121\314\146\014\027\010\266\351\114\254\306\274\136\264\170\156"
	"\277\241\144\232\005\121\234\250\212\200\102\226\170\065\332\324"
	"\036\013\376\361\061\222\347\147\345\337\064\305\333\014\266\105"
	"\120\376\125\224\336\322\047\257\103\017\133\305\307\133\266\106"
	"\104\353\225\302\204\377\210\253\002\072\255\166\123\057\044\244"
	"\325\006\375\237\134\235\347\061\225\161\243\016\366\334\233\155"
	"\007\302\300\262\347\230\345\264\350\321\377\004\111\225\366\043"
	"\272\210\032\032\332\054\203\126\307\337\316\056\167\076\344\060"
	"\143\272\032\156\031\163\126\344\005\114\047\035\210\236\120\260"
	"\067\220\234\141\300\025\126\077\244\337\046\377\317\221\372\243"
	"\121\011\145\041\017\112\233\052\325\204\151\171\114\042\322\030"
	"\235\077\051\264\067\133\325\056\226\375\024\152\276\077\251\252"
	"\252\332\060\211\255\144\332\206\010\106\167\204\010\044\264\166"
	"\351\321\126\004\341\117\155\135\157\010\031\061\113\345\212\065"
	"\130\044\172\324\213\153\071\047\127\263\340\161\156\321\165\017"
	"\215\072\106\266\012\026\360\322\140\123\134\207\054\215\266\366"
	"\057\131\215\335\207\047\345\315\242\043\213\332\220\134\203\372"
	"\311\145\216\005\157\276\336\260\022\343\274\210\244\320\336\065"
	"\065\234\006\152\047\037\235\233\047\240\110\015\300\252\257\336"
	"\251\270\114\146\056\116\136\257\165\306\050\003\245\241\156\224"
	"\306\205\210\243\134\303\136\212\136\127\106\261\151\160\347\374"
	"\223\360\146\341\210\027\116\362\335\024\131\377\360\046\034\253"
	"\007\161\313\156\307\030\050\211\071\071\311\140\371\114\332\056"
	"\364\374\051\034\262\266\137\304\270\013\250\020\211\224\163\314"
	"\163\357\375\127\124\144\142\144\236\246\167\376\125\363\257\174"
	"\355\253\126\006\117\340\106\325\247\223\315\222\254\350\131\137"
	"\310\227\352\331\100\251\151\235\366\037\214\077\266\277\045\330"
	"\033\102\317\307\010\311\013\343\312\252\250\351\167\325\035\272"
	"\007\342\335\123\352\156\277\004\254\132\201\233\027\123\175\263"
	"\362\025\347\235\026\226\151\220\153\320\163\021\260\254\134\320"
	"\046\372\200\035\204\327\347\142\050\203\010\034\327\153\074\335"
	"\043\046\224\372\117\110\353\054\320\177\267\154\301\127\246\172"
	"\125\162\041\026\011\010\311\067\163\152\003\345\135\276\311\324"
	"\230\002\166\075\253\273\337\155\115\215\215\071\177\113\105\164"
	"\376\341\325\364\306\325\162\230\110\377\173\217\160\007\141\022"
	"\177\215\342\053\261\177\276\124\377\124\312\316\262\045\116\222"
	"\220\031\132\166\041\266\036\273\130\001\233\241\122\357\061\101"
	"\201\160\066\243\005\376\251\242\117\043\207\104\263\055\014\274"
	"\123\174\100\122\126\151\134\366\254\140\325\365\244\314\343\211"
	"\206\264\210\214\252\032\347\150\054\151\011\065\106\263\367\357"
	"\300\020\173\072\227\016\203\373\062\364\362\332\176\360\246\207"
	"\353\262\252\361\113\237\200\037\363\070\347\334\054\317\010\177"
	"\214\177\122\026\314\357\031\356\306\334\026\262\207\160\121\325"
	"\022\353\310\067\324\215\213\331\246\333\073\057\034\007\224\074"
	"\232\356\210\020\241\107\207\354\340\231\166\333\032\230\336\141"
	"\254\264\223\156\063\377\105\023\017\074\034\074\235\272\136\174"
	"\337\042\030\042\025\276\204\026\117\113\137\131\133\132\051\100"
	"\322\247\003\263\226\345\213\275\303\200\251\360\070\351\221\275"
	"\213\013\276\075\026\175\045\004\024\071\336\173\206\102\173\351"
	"\244\377\313\206\126\071\055\332\027\250\362\230\342\162\371\035"
	"\032\135\074\062\007\313\350\124\124\233\323\137\106\003\072\127"
	"\101\307\070\176\344\075\131\353\120\375\102\341\105\227\230\055"
	"\031\264\236\143\332\037\311\043\251\075\227\032\102\140\050\121"
	"\366\161\271\230\224\172\217\251\251\257\016\015\116\312\035\030"
	"\212\077\217\310\263\360\141\043\347\346\113\360\047\313\174\071"
	"\232\000\005\374\213\030\106\122\367\377\372\155\133\277\006\300"
	"\002\243\066\252\232\346\144\113\326\067\105\344\047\023\352\151"
	"\333\234\360\324\376\052\106\025\242\116\045\217\105\136\177\156"
	"\033\317\074\142\214\320\371\310\313\305\065\237\104\065\260\352"
	"\013\072\333\226\210\170\217\126\117\072\050\150\044\331\001\034"
	"\301\325\207\327\175\037\077\065\275\330\147\065\146\010\361\170"
	"\216\350\025\364\234\075\200\176\012\211\141\137\101\365\307\062"
	"\363\144\037\361\271\347\351\272\303\340\110\111\135\002\224\305"
	"\225\031\000\302\105\262\032\223\176\260\301\244\254\263\250\116"
	"\253\063\330\374\111\117\061\052\042\047\112\246\307\060\151\301"
	"\227\076\014\154\052\132\331\321\251\110\230\244\102\132\355\105"
	"\143\323\031\371\053\266\336\304\354\161\215\164\125\025\007\217"
	"\322\233\204\205\357\216\303\037\316\007\057\056\354\203\010\103"
	"\066\211\120\070\004\065\120\374\062\351\357\213\162\132\011\146"
	"\070\107\377\363\001\352\013\264\252\135\175\307\035\337\237\377"
	"\346\134\066\343\240\025\347\055\266\351\161\371\214\151\312\342"
	"\336\241\164\117\144\327\154\344\017\336\037\252\067\224\023\244"
	"\144\311\314\110\264\201\264\124\175\027\023\077\126\076\211\262"
	"\215\021\332\161\345\024\372\075\055\077\247\225\061\231\270\240"
	"\243\216\172\334\276\333\231\352\061\216\210\312\372\373\120\247"
	"\127\361\220\254\336\053\315\352\017\244\004\000\173\207\066\011"
	"\015\246\164\202\301\310\034\040\254\361\051\006\247\114\231\200"
	"\272\237\364\154\077\221\171\360\047\012\034\363\215\061\214\147"
	"\240\272\250\021\132\035\157\113\071\052\002\105\124\014\214\344"
	"\157\024\151\113\231\335\174\117\373\210\044\016\031\051\310\035"
	"\230\206\334\101\243\325\151\067\220\106\067\172\010\025\234\307"
	"\357\301\254\344\075\317\327\334\032\066\374\346\363\143\217\026"
	"\242\373\275\262\163\205\347\002\027\310\142\310\014\252\210\004"
	"\067\042\164\345\236\006\350\117\337\073\265\042\211\123\011\355"
	"\025\200\337\143\272\363\375\203\310\064\174\045\345\144\307\341"
	"\374\204\164\056\077\114\352\356\174\317\123\277\056\076\115\002"
	"\212\040\362\327\133\346\100\262\255\071\147\063\076\305\142\234"
	"\125\044\066\101\066\350\027\323\105\112\047\331\376\110\362\154"
	"\176\016\275\240\103\145\257\320\336\002\042\021\270\022\003\243"
	"\376\102\110\143\340\276\267\373\055\236\171\123\100\216\144\352"
	"\330\247\347\371\244\113\340\064\300\207\307\346\264\202\126\121"
	"\221\234\307\211\205\074\226\121\173\337\041\310\177\033\020\135"
	"\373\356\315\064\375\110\103\213\310\031\264\306\141\073\232\014"
	"\024\337\354\123\345\355\350\003\217\366\110\377\103\127\352\240"
	"\376\004\217\146\120\053\376\152\114\303\241\223\304\076\316\057"
	"\371\076\152\230\054\226\331\114\062\035\055\241\204\254\200\075"
	"\172\355\146\076\106\043\077\356\075\317\167\201\223\324\016\033"
	"\371\121\145\156\271\251\057\111\313\072\340\353\225\355\367\200"
	"\140\257\312\267\326\004\145\276\147\047\271\256\300\277\045\136"
	"\022\235\353\027\035\130\373\067\232\131\272\162\072\220\356\345"
	"\237\104\067\255\041\222\026\020\233\130\337\007\357\010\247\113"
	"\116\355\260\142\072\055\221\146\316\227\351\302\333\254\050\014"
	"\075\073\274\251\126\325\252\305\004\130\067\230\325\142\003\360"
	"\053\323\275\354\026\127\312\014\064\316\263\316\214\216\310\174"
	"\131\120\161\204\306\045\371\205\312\376\015\271\141\355\165\216"
	"\145\263\300\371\306\030\146\261\161\201\012\272\245\346\242\021"
	"\201\075\305\013\104\316\103\012\267\224\036\200\131\012\023\302"
	"\217\123\025\147\307\310\136\124\142\252\317\230\223\332\165\363"
	"\055\003\330\236\330\010\205\114\142\151\030\323\137\366\050\160"
	"\304\362\277\166\150\355\154\265\145\370\157\064\330\165\335\334"
	"\264\126\022\141\133\015\032\070\125\311\015\166\271\356\134\321"
	"\256\152\143\027\033\316\021\360\367\303\023\042\207\355\014\035"
	"\137\321\334\030\030\334\126\365\060\164\376\205\372\261\164\236"
	"\172\005\263\150\304\347\156\343\012\361\053\321\262\245\233\240"
	"\355\353\352\277\142\046\176\174\207\251\160\042\105\327\017\074"
	"\002\371\204\353\217\312\340\017\174\035\172\155\042\363\331\310"
	"\264\260\063\211\253\347\223\237\354\331\310\103\135\045\213\327"
	"\035\043\045\020\333\012\077\244\357\257\150\243\062\245\303\006"
	"\031\070\012\237\171\026\044\244\020\316\336\247\332\174\310\132"
	"\340\056\201\023\105\255\376\304\216\221\330\323\253\141\270\005"
	"\174\247\055\210\334\113\071\252\257\026\330\300\146\030\171\342"
	"\073\113\315\017\266\037\044\230\371\012\253\342\062\333\024\214"
	"\261\300\206\314\172\176\171\272\122\370\166\064\302\361\366\066"
	"\200\374\013\233\166\152\150\302\323\267\102\024\341\222\012\153"
	"\027\131\047\063\315\031\135\312\123\147\271\242\022\145\071\150"
	"\377\334\261\302\135\043\122\271\343\175\145\333\066\030\117\066"
	"\304\053\214\205\367\073\334\130\023\312\332\204\302\272\357\037"
	"\331\030\236\312\122\333\237\166\036\233\236\202\034\270\263\077"
	"\172\016\210\046\310\336\332\320\377\336\133\210\152\260\236\036"
	"\216\147\063\367\173\130\205\062\027\303\043\051\312\270\346\256"
	"\227\135\325\123\070\141\342\121\100\253\110\175\347\134\260\354"
	"\265\273\206\310\147\162\040\303\355\115\343\015\177\252\257\351"
	"\235\010\167\110\210\136\056\125\176\251\172\264\364\123\357\204"
	"\220\161\365\236\222\177\332\314\157\031\277\173\025\342\176\122"
	"\144\154\306\155\341\052\002\145\341\040\074\161\105\204\313\073"
	"\041\171\024\046\344\272\341\006\205\171\174\157\253\002\255\032"
	"\046\373\123\110\301\032\355\273\062\073\161\040\377\251\303\377"
	"\334\152\316\156\222\043\064\236\063\054\066\025\324\121\247\343"
	"\231\234\344\306\345\323\327\267\234\025\366\246\063\314\250\034"
	"\067\122\271\325\075\255\146\045\013\316\261\146\037\047\056\053"
	"\140\214\176\321\257\157\123\246\255\350\204\167\266\205\341\215"
	"\336\176\276\353\000\321\274\270\274\272\112\076\351\104\311\102"
	"\215\106\373\174\331\371\275\023\056\320\031\200\131\014\226\127"
	"\172\264\124\002\003\356\377\267\240\024\031\037\062\212\127\011"
	"\357\071\062\141\311\271\223\303\204\301\364\321\106\332\015\161"
	"\131\276\126\334\117\211\143\333\150\210\334\061\342\101\204\314"
	"\345\156\270\057\001\207\055\032\277\204\070\351\375\016\076\213"
	"\014\004\167\215\136\332\075\227\125\007\070\376\002\072\352\074"
	"\352\060\272\103\272\377\243\330\217\112\361\033\350\171\174\260"
	"\226\055\253\005\072\136\345\364\333\212\374\214\120\135\313\042"
	"\106\270\001\014\023\177\256\363\240\006\126\001\324\122\364\153"
	"\165\121\023\205\114\032\254\374\327\365\302\006\364\022\064\063"
	"\174\234\054\126\137\131\370\352\302\205\011\166\060\272\146\301"
	"\205\034\112\371\366\203\270\210\072\143\023\176\312\311\335\003"
	"\242\214\055\354\072\042\044\020\152\134\216\372\372\225\071\172"
	"\315\236\143\034\373\026\154\106\107\050\364\273\243\242\202\245"
	"\012\226\057\042\042\024\133\113\302\123\135\032\245\271\356\226"
	"\164\206\364\036\070\102\073\105\223\300\064\117\217\125\004\051"
	"\111\202\200\216\354\067\105\353\332\251\167\307\217\355\070\305"
	"\331\046\024\141\010\056\172\127\063\077\206\073\060\046\340\036"
	"\126\133\134\266\207\363\157\252\136\012\133\140\312\033\332\335"
	"\340\302\367\063\064\102\130\271\002\170\017\157\246\327\100\002"
	"\370\040\201\024\027\071\263\036\247\377\346\055\163\165\126\156"
	"\107\107\130\035\363\154\267\275\330\372\155\026\265\017\233\014"
	"\202\272\220\043\361\113\043\246\304\046\065\061\054\035\071\355"
	"\164\234\155\234\343\036\306\127\136\220\065\337\112\072\007\176"
	"\255\123\212\145\102\345\032\060\167\157\065\012\141\125\325\254"
	"\224\133\221\216\345\002\150\371\164\311\325\067\353\131\031\310"
	"\036\104\105\361\065\227\134\354\026\176\100\271\110\057\246\210"
	"\161\266\361\314\136\257\315\141\104\115\053\340\247\105\251\306"
	"\211\356\267\277\206\023\254\234\222\354\126\332\033\375\143\215"
	"\263\124\131\022\004\047\164\111\164\237\052\033\345\323\342\157"
	"\302\231\057\110\254\333\345\077\307\073\031\343\070\174\160\354"
	"\321\312\376\326\361\162\037\145\022\111\201\367\034\143\147\336"
	"\375\226\047\252\161\014\351\071\110\002\034\201\177\214\155\121"
	"\127\154\047\110\336\107\256\360\220\060\350\255\223\117\214\221"
	"\346\263\073\127\300\044\221\011\047\255\213\246\072\371\370\221"
	"\145\040\332\104\147\210\065\370\270\035\245\114\155\062\335\123"
	"\346\030\253\247\075\074\261\144\352\074\013\044\066\003\266\233"
	"\043\220\337\213\031\024\203\321\062\051\036\237\134\373\363\102"
	"\024\236\351\121\333\232\266\305\327\301\352\015\305\240\251\351"
	"\061\210\164\112\235\370\034\320\042\072\160\176\066\143\300\113"
	"\002\252\235\335\105\123\242\034\025\215\052\332\056\323\303\137"
	"\134\070\252\372\060\306\312\122\000\072\320\067\235\221\202\237"
	"\073\040\175\200\164\037\235\211\255\307\143\333\233\047\072\367"
	"\137\344\361\220\253\274\343\254\366\264\343\224\105\146\064\201"
	"\207\261\002\373\321\237\204\176\147\350\131\002\017\224\372\157"
	"\171\353\000\044\250\343\320\236\227\264\063\334\033\147\136\242"
	"\030\140\236\351\000\042\150\147\012\302\152\032\126\144\212\317"
	"\120\212\364\370\155\305\227\005\172\312\341\225\061\100\070\112"
	"\240\326\064\240\370\234\010\003\137\163\036\265\327\251\205\050"
	"\063\172\041\241\077\270\246\271\203\210\117\264\310\207\377\150"
	"\135\063\011\126\320\022\132\057\205\171\345\135\042\153\205\125"
	"\345\246\366\045\137\235\336\342\045\055\227\355\265\226\126\023"
	"\312\140\151\233\162\304\313\367\075\260\124\137\034\332\265\001"
	"\201\254\046\340\111\005\303\156\063\132\133\351\361\262\374\274"
	"\022\146\127\204\052\043\174\147\324\320\307\360\253\174\362\054"
	"\050\030\014\162\036\317\340\122\052\074\073\034\356\067\330\001"
	"\235\060\206\307\123\002\057\047\323\367\030\176\164\012\252\234"
	"\042\267\017\101\207\357\223\261\054\316\316\033\006\246\034\243"
	"\327\242\153\052\245\233\122\170\222\152\367\006\164\241\243\227"
	"\131\263\331\340\242\155\222\317\073\140\352\102\006\007\345\336"
	"\252\121\011\117\355\133\307\200\306\277\207\073\140\053\323\272"
	"\336\254\232\201\031\054\120\125\214\073\227\223\102\175\162\355"
	"\317\173\074\274\326\004\075\235\303\304\330\044\357\253\336\315"
	"\130\170\117\162\245\237\307\062\333\137\306\036\335\070\013\254"
	"\263\107\151\212\114\246\047\017\152\000\064\132\254\022\050\004"
	"\213\167\166\060\027\076\142\362\235\050\020\173\141\034\047\024"
	"\143\220\236\260\067\305\277\242\305\363\374\161\006\044\166\221"
	"\233\355\302\263\054\045\246\312\116\267\105\257\323\154\303\067"
	"\375\141\347\065\047\247\327\355\233\323\137\241\367\325\063\223"
	"\303\365\107\357\032\355\271\150\244\376\030\170\153\333\257\150"
	"\074\227\235\144\076\165\121\331\110\260\173\100\206\256\324\111"
	"\244\033\070\277\011\361\050\255\360\100\046\133\033\325\304\130"
	"\155\142\274\253\327\015\205\040\276\000\140\104\257\064\215\124"
	"\120\305\023\131\267\073\007\250\173\055\003\226\003\310\357\160"
	"\052\253\034\002\271\241\042\167\242\202\274\122\267\111\246\007"
	"\017\271\140\307\364\147\157\160\225\163\006\230\073\365\011\146"
	"\241\045\150\133\307\212\322\151\015\216\273\304\330\142\313\347"
	"\033\054\257\020\224\036\200\051\221\207\302\314\174\313\062\036"
	"\361\233\171\270\045\114\041\063\333\335\367\263\077\303\233\133"
	"\360\112\153\204\150\354\256\372\163\160\307\360\074\371"
#define      pswd_z	256
#define      pswd	((&data[6537]))
	"\210\346\272\324\010\355\260\346\345\143\045\046\165\107\164\357"
	"\343\206\365\074\224\007\105\143\123\363\352\316\302\112\066\122"
	"\010\337\270\370\366\167\236\240\114\131\307\302\240\074\262\203"
	"\303\250\300\127\260\006\273\003\371\246\322\274\361\011\016\371"
	"\351\306\362\337\076\220\200\212\351\110\115\211\204\377\015\107"
	"\247\315\237\127\324\133\133\316\001\055\212\363\067\230\354\040"
	"\137\336\000\235\157\200\050\130\311\166\342\116\165\360\226\035"
	"\275\065\165\222\221\321\140\223\377\352\206\066\203\162\126\343"
	"\121\126\201\300\327\252\031\240\040\374\356\226\354\204\263\251"
	"\272\051\074\114\372\234\337\371\207\145\060\012\330\206\356\051"
	"\335\157\352\264\031\003\125\071\377\103\317\353\310\203\225\203"
	"\255\321\320\250\156\257\242\365\025\322\000\355\130\356\027\065"
	"\135\001\352\166\004\077\260\004\203\200\360\114\003\206\317\260"
	"\130\237\131\306\117\373\274\144\315\274\122\045\252\151\133\010"
	"\152\105\176\157\205\057\164\010\257\144\124\262\352\044\143\103"
	"\304\274\011\023\267\305\170\205\202\312\253\054\063\006\064\236"
	"\114\263\015\322\342\201\332\222\346\056\105\250\377\201\230\111"
	"\355\035\262\331\313\254\115\074\164\075\171\155\114\247\002\325"
	"\215\275\251\225\253\132\174\220\276\242\070\275\043\321\007\020"
#define      tst2_z	19
#define      tst2	((&data[6833]))
	"\272\146\067\270\344\330\316\211\100\247\105\101\104\015\274\103"
	"\064\317\272\120\026\000\366\332\164\157"
#define      inlo_z	3
#define      inlo	((&data[6856]))
	"\256\234\167"
#define      xecc_z	15
#define      xecc	((&data[6861]))
	"\010\100\036\027\271\240\323\270\325\361\056\001\045\323\121\065"
	"\021\072\263"
#define      msg2_z	19
#define      msg2	((&data[6881]))
	"\130\130\174\141\040\077\325\167\302\206\122\352\201\131\127\042"
	"\000\242\203\067\237\077\025"
#define      tst1_z	22
#define      tst1	((&data[6902]))
	"\214\133\106\170\316\116\347\265\100\230\040\043\176\073\223\070"
	"\027\300\235\137\077\174\262"
#define      shll_z	10
#define      shll	((&data[6926]))
	"\367\075\370\013\376\015\155\037\357\237\117\270\256"
#define      chk2_z	19
#define      chk2	((&data[6937]))
	"\360\250\150\347\134\202\167\027\313\175\360\324\204\345\214\124"
	"\322\303\217"
#define      lsto_z	1
#define      lsto	((&data[6956]))
	"\175"
#define      chk1_z	22
#define      chk1	((&data[6961]))
	"\030\264\273\123\172\171\000\170\337\163\104\215\043\005\264\274"
	"\102\057\076\125\355\324\235\352\133\163\147\126"
#define      msg1_z	65
#define      msg1	((&data[6996]))
	"\142\050\304\336\166\341\153\263\270\342\252\106\076\005\154\342"
	"\333\004\123\057\351\321\256\100\121\055\032\147\246\337\260\175"
	"\223\360\364\340\133\053\170\124\225\212\232\123\052\266\370\157"
	"\305\356\172\317\110\016\006\136\301\111\367\350\113\371\236\245"
	"\125\350\334\345\251\077\126\206\234\267\054\170\365\220\230\015"
	"\264\366\155\230\152\031\024"
#define      rlax_z	1
#define      rlax	((&data[7072]))
	"\040"
#define      date_z	1
#define      date	((&data[7073]))
	"\324"
#define      opts_z	1
#define      opts	((&data[7074]))
	"\065"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
